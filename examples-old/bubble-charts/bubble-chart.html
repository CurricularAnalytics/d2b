<!DOCTYPE html>
<html>

<script src="../../vendor/js/vendor.js"></script>
<script src="../../build/js/d2b.js"></script>
<link rel="stylesheet" type="text/css" href="../../build/css/d2b.css" />
<script>
	$(document).ready(function(){

		var chart = d2b.CHARTS.bubbleChart();

		chart
			// .color(
			// 	d3.scale.ordinal()
			// 	   .domain(["Academic Affairs","Administration","color-individual"])
			// 	   .range(["rgb(193,0,55)", "rgb(0,0,200)" , "rgb(0,200,0)"])
			// )
			// .tooltip(function(d){console.log(d);return '<u><b>'+d.label+'</b></u><br />'+d.value;})
			.xFormat({nice:true,siPrefixed:false,units:{before:'$'}, separateThousands:false,precision:1})
			// .controls({sortByChange:{visible:true},hideLegend:{visible:true},colorByChange:{visible:true}})

			var chartData = {
				categories: [
					{
						label: "University of New Mexico",
						children: [
							{label:"Academic Affairs Monitoring", value:120931.16, change:0.250661599},
							{label:"Anderson Schools of Management ASM", value:19000610.59, change:0.039270371},
							{label:"Assoc. VP Student Life (ACD)", value:15752360.68, change:0.026103648},
							// {label:"Associate VP for Facilities Mgmt", value:0, change:0},
							{label:"Associate VP Student Services", value:6469293.59, change:0.050543855},
							{label:"College of Arts Sciences A S", value:79072541.99, change:0.070373744},
							{label:"College of Education COE", value:18415682.66, change:0.023560741},
							{label:"College of Fine Arts CFA", value:17938522.67, change:0.034623405},
							{label:"College of Nursing", value:11108857.39, change:0.01422906},
							{label:"College of Pharmacy", value:15285566.28, change:0.041067319},
							{label:"Continuing Education Cont Ed", value:5645978.95, change:-0.340977176},
							{label:"Extended University Ext Univ", value:9644327.95, change:0.039058798},
							{label:"Gallup Branch", value:8750.23, change:1},
							{label:"Honors College", value:1701510.05, change:0.195262667},
							{label:"HS Library and  Informatics Center", value:6467440.1, change:0.060499183},
							{label:"HSC VP Research", value:7321761.65, change:0.113592858},
							// {label:"LosAlamos Branch", value:0, change:0},
							{label:"School of Architecture Planning", value:5110569.5, change:-0.005672154},
							{label:"School of Engineering", value:22057218.5, change:0.091426453},
							{label:"School of Law LAW", value:18157279.17, change:0.015847833},
							{label:"School of Public Administration", value:1688733.21, change:0.157827066},
							{label:"University College UC", value:2608527.67, change:-0.03829305},
							{label:"University Libraries", value:17750122.42, change:0.006416308},
							{label:"UNM West and Branch Initiatives", value:1171053.89, change:0.313825935},
							{label:"Valencia County Branch", value:5958.66, change:22.81178069},
							{label:"Vice President for Research", value:11622477.95, change:-0.098263861},
							{label:"VP Division of Enrollment Mgmt", value:98339826.12, change:0.072023531},
							{label:"VP for Equity & Inclusion", value:975314.95, change:0.009747428},
							{label:"VP Institutional Adv College", value:558322.02, change:-0.641718639},
							{label:"VP Student Affairs Indpndnt Dept ID", value:18967009.03, change:0.029386935},
							{label:"Controller", value:44207985.14, change:-0.013716292},
							{label:"EVP Administration", value:12542830.24, change:0.04336146},
							{label:"Government & Community Relations", value:732989.04, change:0.46271523},
							{label:"Human Resources HR", value:7889144.7, change:-0.125263302},
							{label:"Information Technologies", value:65168379.94, change:0.098960926},
							{label:"Information Technology Services", value:40697.39, change:126.1793438},
							{label:"Intercollegiate Athletics", value:63731165.48, change:0.024408295},
							{label:"Provost Administrative Units", value:26566947.78, change:0.05567771},
							{label:"VP Institutional Support Services", value:223854191.3, change:-0.031553167},
							{label:"VP Student Affairs Administration", value:2332243.11, change:0.113071499},
							{label:"President Admin Indpnt Office", value:6668943.43, change:-0.059668938,
							 children: [
								 {label: 'Child 1', children: [
									 {label: 'Child 1', value: 167235},
									 {label: 'Child 2', value: 5001707},
									 {label: 'Child 2', value: 3001707},
									 {label: 'Child 2', value: 2001707}
								 ]},
								 {label: 'Child 2', value: 3001707}
							 ]},
							{label:"School of Medicine", value:612832938.9, change:0.071376},
							// {label:"UNM Medical Group", value:0, change:-1},
							{label:"VP HSC Administration", value:86814998.24, change:0.081965395}
						]
					}
				]
			};
			var chartData2 = {
				categories: [
					{
						label: "Academic Affairs",
						children: [
							{label:"Academic Affairs Monitoring", value:120931.16, change:0.250661599},
							{label:"Anderson Schools of Management ASM", value:19000610.59, change:0.039270371},
							{label:"Assoc. VP Student Life (ACD)", value:15752360.68, change:0.026103648},
							// {label:"Associate VP for Facilities Mgmt", value:0, change:0},
							{label:"Associate VP Student Services", value:6469293.59, change:0.050543855},
							{label:"College of Arts Sciences A S", value:79072541.99, change:0.070373744},
							{label:"College of Education COE", value:18415682.66, change:0.023560741},
							{label:"College of Fine Arts CFA", value:17938522.67, change:0.034623405},
							{label:"College of Nursing", value:11108857.39, change:0.01422906},
							{label:"College of Pharmacy", value:15285566.28, change:0.041067319},
							{label:"Continuing Education Cont Ed", value:5645978.95, change:-0.340977176},
							{label:"Extended University Ext Univ", value:9644327.95, change:0.039058798},
							{label:"Gallup Branch", value:8750.23, change:1},
							{label:"Honors College", value:1701510.05, change:0.195262667},
							{label:"HS Library and  Informatics Center", value:6467440.1, change:0.060499183},
							{label:"HSC VP Research", value:7321761.65, change:0.113592858},
							// {label:"LosAlamos Branch", value:0, change:0},
							{label:"School of Architecture Planning", value:5110569.5, change:-0.005672154},
							{label:"School of Engineering", value:22057218.5, change:0.091426453},
							{label:"School of Law LAW", value:18157279.17, change:0.015847833},
							{label:"School of Public Administration", value:1688733.21, change:0.157827066},
							{label:"University College UC", value:2608527.67, change:-0.03829305},
							{label:"University Libraries", value:17750122.42, change:0.006416308},
							{label:"UNM West and Branch Initiatives", value:1171053.89, change:0.313825935},
							{label:"Valencia County Branch", value:5958.66, change:22.81178069},
							{label:"Vice President for Research", value:11622477.95, change:-0.098263861},
							{label:"VP Division of Enrollment Mgmt", value:98339826.12, change:0.072023531},
							{label:"VP for Equity & Inclusion", value:975314.95, change:0.009747428},
							{label:"VP Institutional Adv College", value:558322.02, change:-0.641718639},
							{label:"VP Student Affairs Indpndnt Dept ID", value:18967009.03, change:0.029386935}
						]
					},
					{
						label: "Administration",
						children: [
							{label:"Controller", value:44207985.14, change:-0.013716292},
							{label:"EVP Administration", value:12542830.24, change:0.04336146},
							{label:"Government & Community Relations", value:732989.04, change:0.46271523, children: [
								{label: 'Child 1-1', value: 167235},
								{label: 'Child 1-2', value: 501707},
								{label: 'Child 1-3', value: 301707},
								{label: 'Child 1-4', value: 201707} ] },
							{label:"Human Resources HR", value:7889144.7, change:-0.125263302},
							{label:"Information Technologies", value:65168379.94, change:0.098960926},
							{label:"Information Technology Services", value:40697.39, change:126.1793438},
							{label:"Intercollegiate Athletics", value:63731165.48, change:0.024408295},
							{label:"Provost Administrative Units", value:26566947.78, change:0.05567771},
							{label:"VP Institutional Support Services", value:223854191.3, change:-0.031553167},
							{label:"VP Student Affairs Administration", value:2332243.11, change:0.113071499}
						]
					},
					{
						label: "President",
						children: [
							{label:"President Admin Indpnt Office", /*value:6668943.43,*/ change:-0.059668938,
							 children: [
								 {label: 'Child 1', children: [
									 {label: 'Child 1-1', value: 167235},
									 {label: 'Child 1-2', value: 5001707},
									 {label: 'Child 1-3', value: 3001707},
									 {label: 'Child 1-4', value: 2001707}
								 ]},
								 {label: 'Child 2', value: 3001707}
							 ]}
						]
					},
					{
						label: "HSC",
						children: [
							{label:"School of Medicine", value:612832938.9, change:0.071376},
							// {label:"UNM Medical Group", value:0, change:-1},
							{label:"VP HSC Administration", value:86814998.24, change:0.081965395}
						]
					}
				]
			};
			var chartData3 = {
				categories: [
					{
						label: "Academic Affairs",
						children: [
							{label:"Academic Affairs Monitoring", value:120931.16, change:0.250661599},
							{label:"Anderson Schools of Management ASM", value:19000610.59, change:0.039270371},
							{label:"Assoc. VP Student Life (ACD)", value:15752360.68, change:0.026103648},
							// {label:"Associate VP for Facilities Mgmt", value:0, change:0},
							{label:"Associate VP Student Services", value:6469293.59, change:0.050543855},
							{label:"College of Arts Sciences A S", value:79072541.99, change:0.070373744},
							{label:"College of Education COE", value:18415682.66, change:0.023560741},
							{label:"College of Fine Arts CFA", value:17938522.67, change:0.034623405},
							{label:"College of Fine Arts CFA2", value:170938522.67, change:0.034623405},
							{label:"College of Nursing", value:11108857.39, change:0.01422906},
							{label:"College of Pharmacy", value:15285566.28, change:0.041067319},
							{label:"Continuing Education Cont Ed", value:5645978.95, change:-0.340977176},
							{label:"Extended University Ext Univ", value:9644327.95, change:0.039058798},
							{label:"Gallup Branch", value:8750.23, change:1},
							{label:"Honors College", value:1701510.05, change:0.195262667},
							{label:"HS Library and  Informatics Center", value:6467440.1, change:0.060499183},
							{label:"HSC VP Research", value:7321761.65, change:0.113592858},
							// {label:"LosAlamos Branch", value:0, change:0},
							{label:"School of Architecture Planning", value:5110569.5, change:-0.005672154},
							{label:"School of Engineering", value:22057218.5, change:0.091426453},
							{label:"School of Law LAW", value:18157279.17, change:0.015847833},
							{label:"School of Public Administration", value:1688733.21, change:0.157827066},
							{label:"University College UC", value:2608527.67, change:-0.03829305},
							{label:"University Libraries", value:17750122.42, change:0.006416308},
							{label:"UNM West and Branch Initiatives", value:1171053.89, change:0.313825935},
							{label:"Valencia County Branch", value:5958.66, change:22.81178069},
							{label:"Vice President for Research", value:11622477.95, change:-0.098263861},
							{label:"VP Division of Enrollment Mgmt", value:98339826.12, change:0.072023531},
							{label:"VP for Equity & Inclusion", value:975314.95, change:0.009747428},
							{label:"VP Institutional Adv College", value:558322.02, change:-0.641718639},
							{label:"VP Student Affairs Indpndnt Dept ID", value:18967009.03, change:0.029386935}
						]
					},
					{
						label: "Administration",
						children: [
							{label:"Controller", value:44207985.14, change:-0.013716292},
							{label:"EVP Administration", value:12542830.24, change:0.04336146},
							{label:"Government & Community Relations", value:732989.04, change:0.46271523, children: [
								{label: 'Child 1-1', value: 167235},
								{label: 'Child 1-2', value: 501707},
								{label: 'Child 1-3', value: 301707},
								{label: 'Child 1-4', value: 201707} ] },
							{label:"Human Resources HR", value:7889144.7, change:-0.125263302},
							{label:"Information Technologies", value:65168379.94, change:0.098960926},
							{label:"Information Technology Services", value:40697.39, change:126.1793438},
							{label:"Intercollegiate Athletics", value:63731165.48, change:0.024408295},
							{label:"Provost Administrative Units", value:26566947.78, change:0.05567771},
							{label:"VP Institutional Support Services", value:223854191.3, change:-0.031553167},
							{label:"VP Student Affairs Administration", value:2332243.11, change:0.113071499}
						]
					},
					{
						label: "President",
						children: [
							{label:"President Admin Indpnt Office", /*value:6668943.43,*/ change:-0.059668938,
							 children: [
								 {label: 'Child 1', children: [
									 {label: 'Child 1-1', value: 167235},
									 {label: 'Child 1-2', value: 5001707},
									 {label: 'Child 1-3', value: 3001707},
									 {label: 'Child 1-4', value: 2001707}
								 ]},
								 {label: 'Child 2', value: 3001707}
							 ]}
						]
					},
					{
						label: "HSC",
						children: [
							{label:"School of Medicine", value:612832938.9, change:0.071376},
							// {label:"UNM Medical Group", value:0, change:-1},
							{label:"VP HSC Administration", value:86814998.24, change:0.081965395}
						]
					}
				]
			};

		var axis = d2b.SVG.axis().y({orientation: 'right-inside'}).x({orientation: 'top-inside', scale: d3.scale.linear().domain([-0.25, 0.25])});
		chart
			.select('.bubble-chart')
			.width($(window).width())
			.height($(window).height() - 40)
			.data({data:chartData})
			.axis(axis)
			// .zoomCoefficient(0.5)
			.on('zoomIn', function(){console.log('updated!');})
			.update();

		$(window).resize(function(){
			chart
				.animationDuration(0)
				.height($(window).height() - 40)
				.width($(window).width())
				.update()
				.animationDuration(500);
		});

		$('.toggle-view').click(function(){
			var elem = $(this);
			var text = elem.text();

			if(text === 'By Change'){
				chart.view('change');
				elem.text('By Category');
			}else{
				chart.view('packs');
				elem.text('By Change');
			}
			chart.update();
		});


		setTimeout(function(){
			chart.data({data:chartData2}).update();
		}, 1000);


		setTimeout(function(){
			chart.data({data:chartData3}).update();
		}, 2000);


		// setTimeout(function(){
		// 	chart.data({data:chartData3}).update();
		// }, 1000);
		// //
		// // setTimeout(function(){
		// // 	chart.view('change').update();
		// // }, 2000);
		//
		// // setTimeout(function(){
		// // 	chart.data({data:chartData}).update();
		// // }, 3000);
		//
		// setTimeout(function(){
		// 	// var d = chartData.categories[0].children.filter(function(d){
		// 	// 	return d.children && d.children.length;
		// 	// })[0];
		// 	// var d = d3.selectAll('.d2b-bubble').filter(function(d){
		// 	// 	return d.children && d.children.length;
		// 	// }).datum();
		// 	chart.zoomIn("President Admin Indpnt Office");
		// }, 4000);
		// //
		// // setTimeout(function(){
		// // 	chart.zoomIn(null);
		// // }, 5000);

	})
</script>

<body style='margin:0px;'>
<button style = 'font-size: 15pt;' class = 'toggle-view'>By Change</button>
<!-- <div class='randomize-button'style = 'position:absolute;top:0;left:0;padding:10px;border:2px solid black;'>Randomize!</div> -->
<div class = 'bubble-chart'></div>

</body>
</html>
