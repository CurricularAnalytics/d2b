describe("Symbol", function() {
  var symbol;

  beforeEach(function() {
    symbol = d2b.SVG.symbol();
  });

  describe("when type is configured", function(){
    var d3Symbols = d3.svg.symbolTypes;
    var d2bSymbols = d2b.SVG.symbolTypes;
    var d2bSpecificSymbols = [
      {type:"star", value:"M0,-10.683013711281028L2.0402740677140985,-2.8081963396078633 10.160149803784293,-3.3012327879264154 3.301232787926415,1.072635554647161 6.279317909529269,8.64273964356693 0,3.4711215699214044 -6.279317909529269,8.64273964356693 -3.301232787926415,1.072635554647161 -10.160149803784293,-3.3012327879264154 -2.0402740677140985,-2.8081963396078633 0,-10.683013711281028Z"},
      {type:"close", value:"M0,-3.872983346207417L3.872983346207417,-7.745966692414834 7.745966692414834,-3.872983346207417 3.872983346207417,0 7.745966692414834,3.872983346207417 3.872983346207417,7.745966692414834 0,3.872983346207417 -3.872983346207417,7.745966692414834 -7.745966692414834,3.872983346207417 -3.872983346207417,0 -7.745966692414834,-3.872983346207417 -3.872983346207417,-7.745966692414834 0,-3.872983346207417Z"},
      {type:"rect-horizontal", value:"M-10.606601717798213,-3.5355339059327378L10.606601717798213,-3.5355339059327378 10.606601717798213,3.5355339059327378 -10.606601717798213,3.5355339059327378Z"},
      {type:"rect-vertical", value:"M-3.5355339059327378,-10.606601717798213L3.5355339059327378,-10.606601717798213 3.5355339059327378,10.606601717798213 -3.5355339059327378,10.606601717798213Z"},
      {type:"arrow-right", value:"M-10.954451150103322,-2.7386127875258306L0,-2.7386127875258306 0,-8.215838362577491 10.954451150103322,0 0,8.215838362577491 0,2.7386127875258306 -10.954451150103322,2.7386127875258306Z"},
      {type:"arrow-left", value:"M10.954451150103322,-2.7386127875258306L0,-2.7386127875258306 0,-8.215838362577491 -10.954451150103322,0 0,8.215838362577491 0,2.7386127875258306 10.954451150103322,2.7386127875258306Z"},
      {type:"arrow-up", value:"M-2.7386127875258306,10.954451150103322L-2.7386127875258306,0 -8.215838362577491,0 0,-10.954451150103322 8.215838362577491,0 2.7386127875258306,0 2.7386127875258306,10.954451150103322Z"},
      {type:"arrow-down", value:"M-2.7386127875258306,-10.954451150103322L-2.7386127875258306,0 -8.215838362577491,0 0,10.954451150103322 8.215838362577491,0 2.7386127875258306,0 2.7386127875258306,-10.954451150103322Z"},
      {type:"venus", value:"M-1.4610820767377175,1.4610820767377175A5.84432830695087,5.84432830695087 0 1,1 1.4610820767377175,1.4610820767377175L1.4610820767377175,4.383246230213152 4.383246230213152,4.383246230213152 4.383246230213152,7.305410383688588 1.4610820767377175,7.305410383688588 1.4610820767377175,10.227574537164022 -1.4610820767377175,10.227574537164022 -1.4610820767377175,7.305410383688588 -4.383246230213152,7.305410383688588 -4.383246230213152,4.383246230213152 -1.4610820767377175,4.383246230213152Z"},
      {type:"mars", value:"M2.066282088662727,0A5.84432830695087,5.84432830695087 0 1,1 0,-2.066282088662727L3.172846206363133,-5.239128295025861 1.3464936104409861,-5.239128295025861 1.3464936104409861,-8.161292448501296 8.161292448501296,-8.161292448501296 8.161292448501296,-1.3464936104409861 5.239128295025861,-1.3464936104409861 5.239128295025861,-3.172846206363133Z"}
    ];

    it("should support d3 symbol types (e.g. circle).", function() {
      symbol.type('circle');
      expect(symbol.type()()).toBe('circle');
      expect(symbol()).toBe("M0,6.90988298942671A6.90988298942671,6.90988298942671 0 1,1 0,-6.90988298942671A6.90988298942671,6.90988298942671 0 1,1 0,6.90988298942671Z")
    });

    d2bSpecificSymbols.forEach(function(symbolInfo){
      it("should support type "+symbolInfo.type+".", function() {
        symbol.type(symbolInfo.type);
        expect(symbol.type()()).toBe(symbolInfo.type);
        expect(symbol()).toBe(symbolInfo.value);
      });
    });
  });

  describe("when size is configured", function(){
    it("should support size for d3 symbol.", function() {
      symbol.type('circle').size(6000);
      expect(symbol.size()()).toBe(6000);
      expect(symbol()).toBe("M0,43.70193722368317A43.70193722368317,43.70193722368317 0 1,1 0,-43.70193722368317A43.70193722368317,43.70193722368317 0 1,1 0,43.70193722368317Z")
    });
    it("should support size.", function() {
      symbol.type('star').size(6000);
      expect(symbol.size()()).toBe(6000);
      expect(symbol()).toBe("M0,-67.56531120491297L12.903826209906322,-17.760593100217122 64.25842949694244,-20.878829392550163 20.87882939255016,6.783942903926073 39.71389349279924,54.66148499500665 0,21.9533003925821 -39.71389349279924,54.66148499500665 -20.87882939255016,6.783942903926073 -64.25842949694244,-20.878829392550163 -12.903826209906322,-17.760593100217122 0,-67.56531120491297Z")
    });
  });

  describe("when passing accessor to type", function(){
    it("should support data argument.", function() {
      var type = ['star']
      symbol.type(function(d,i){return d;})
      expect(symbol(type[0])).toBe("M0,-10.683013711281028L2.0402740677140985,-2.8081963396078633 10.160149803784293,-3.3012327879264154 3.301232787926415,1.072635554647161 6.279317909529269,8.64273964356693 0,3.4711215699214044 -6.279317909529269,8.64273964356693 -3.301232787926415,1.072635554647161 -10.160149803784293,-3.3012327879264154 -2.0402740677140985,-2.8081963396078633 0,-10.683013711281028Z")
    });
    it("should support index argument.", function() {
      var type = ['star']
      symbol.type(function(d,i){return d[i];})
      expect(symbol(type, 0)).toBe("M0,-10.683013711281028L2.0402740677140985,-2.8081963396078633 10.160149803784293,-3.3012327879264154 3.301232787926415,1.072635554647161 6.279317909529269,8.64273964356693 0,3.4711215699214044 -6.279317909529269,8.64273964356693 -3.301232787926415,1.072635554647161 -10.160149803784293,-3.3012327879264154 -2.0402740677140985,-2.8081963396078633 0,-10.683013711281028Z")
    });
  });

  describe("when passing accessor to size", function(){
    it("should support data argument.", function() {
      var size = [6000]
      symbol.type("star").size(function(d,i){return d;})
      expect(symbol(size[0])).toBe("M0,-67.56531120491297L12.903826209906322,-17.760593100217122 64.25842949694244,-20.878829392550163 20.87882939255016,6.783942903926073 39.71389349279924,54.66148499500665 0,21.9533003925821 -39.71389349279924,54.66148499500665 -20.87882939255016,6.783942903926073 -64.25842949694244,-20.878829392550163 -12.903826209906322,-17.760593100217122 0,-67.56531120491297Z")
    });
    it("should support index argument.", function() {
      var size = [6000]
      symbol.type("star").size(function(d,i){return d[i];})
      expect(symbol(size, 0)).toBe("M0,-67.56531120491297L12.903826209906322,-17.760593100217122 64.25842949694244,-20.878829392550163 20.87882939255016,6.783942903926073 39.71389349279924,54.66148499500665 0,21.9533003925821 -39.71389349279924,54.66148499500665 -20.87882939255016,6.783942903926073 -64.25842949694244,-20.878829392550163 -12.903826209906322,-17.760593100217122 0,-67.56531120491297Z")
    });
  });
});
