/* Copyright Â© 2013-2015 Academic Dashboards, All Rights Reserved. */var d2b=d2b||{};d2b.createNameSpace=function(a){var b=a.split("."),c=d2b;"d2b"===b[0]&&(b=b.slice(1));for(var d=0;d<b.length;d++){var e=b[d];"undefined"==typeof c[e]&&(c[e]={}),c=c[e]}return c},d2b.createNameSpace("d2b.CHARTS"),d2b.createNameSpace("d2b.DASHBOARDS"),d2b.createNameSpace("d2b.UTILS"),d2b.createNameSpace("d2b.UTILS.CHARTPAGE"),d2b.createNameSpace("d2b.UTILS.AXISCHART.TYPES"),d2b.createNameSpace("d2b.CONSTANTS"),d2b.CONSTANTS={DEFAULTPALETTE:{primary:"rgb(42,54,82)",secondary:"rgb(11,22,47)"},DEFAULTWIDTH:function(){return 960},DEFAULTHEIGHT:function(){return 540},DEFAULTMARGIN:function(){return{left:0,right:0,top:0,bottom:0}},DEFAULTFORCEDMARGIN:function(){return{left:30,bottom:20,right:30,top:20}},DEFAULTCOLOR:function(){return d3.scale.category10()},DEFAULTEVENTS:function(){return{elementMouseover:function(){},elementMouseout:function(){},elementClick:function(){}}},ANIMATIONLENGTHS:function(){return{normal:500,"short":200,"long":1e3}}},d2b.UTILS.chartAdapter=function(a,b){if(b.chart=new d2b.CHARTS[a],b.properties)for(key in b.properties)b.properties[key].args?b.chart[key].apply(this,b.properties[key].args):b.chart[key](b.properties[key])},d2b.UTILS.chartLayoutAdapter=function(a,b){if(b.chart=new d2b.CHARTS[a],b.chartLayoutData||(b.chartLayoutData={}),b.chartLayout=new d2b.UTILS.CHARTPAGE.chartLayout,b.chartLayout.chart(b.chart).data(b.chartLayoutData),b.properties)for(key in b.properties)b.properties[key].args?b.chart[key].apply(this,b.properties[key].args):b.chart[key](b.properties[key])},d2b.UTILS.chartPage=function(){var a={};a.width=d2b.CONSTANTS.DEFAULTWIDTH(),a.selection,a.currentData={},a.modifiedData={},a.dataLoaded=!1,a.computedHeight=0,a.animationDuration=d2b.CONSTANTS.ANIMATIONLENGTHS().normal,a.animateFrom=null,a.on={update:function(){}},a.init=function(b){(a.animateFrom||!a.selection.currentPage)&&(a.selection.selectAll(".d2b-chart-page").classed("d2b-chart-page-old",!0),a.selection.currentPage=a.selection.append("div").attr("class","d2b-chart-page").style("opacity",0).style("left",b.left+"px").style("top",b.top+"px"))},a.updateGrid=function(b){{var c=a.selection.currentPage.selectAll("div.d2b-page-chart-layout").data(b,function(a,b){return a.chart.key||b});c.enter().append("div").attr("class","d2b-page-chart-layout").each(function(b){d2b.UTILS.chartLayoutAdapter(b.chart.type,b.chart),this.chart=b.chart.chart,this.chartLayout=b.chart.chartLayout,this.chartLayout.select(this).width(a.width*b.width).height(b.height).animationDuration(0).update(b.chart.chartLayoutData.chartCallback)})}c.each(function(b){this.chart.data(b.chart.properties.data),this.chartLayout.animationDuration(a.animationDuration).width(a.width*b.width).update(b.chart.chartLayoutData.chartCallback)}).style("left",function(b){return a.width*b.x+"px"}).style("top",function(a){return a.y+"px"}).each(function(b){a.computedHeight=Math.max(a.computedHeight,b.y+b.height)}),c.exit().transition().duration(a.animationDuration).style("opacity",0).remove(),a.selection.currentPage.transition().duration(a.animationDuration).style("opacity",1).style("left","0px").style("top","0px")};var b={};a.getPosition=function(){var b={top:0,left:0};switch(a.animateFrom){case"right":b.top=0,b.left=a.width;break;case"left":b.top=0,b.left=-a.width;break;case"top":b.top=-a.computedHeight,b.left=0;break;case"bottom":b.top=a.computedHeight,b.left=0}return b};var b={};return b.on=d2b.UTILS.CHARTS.MEMBERS.on(b,a),b.width=function(c){return arguments.length?(a.width=c,b):a.width},b.computedHeight=function(){return a.computedHeight},b.selection=function(c){return arguments.length?(a.selection=c,b):a.selection},b.select=function(c){return arguments.length?(a.selection=d3.select(c),b):a.selection},b.animationDuration=function(c){return arguments.length?(a.animationDuration=c,b):a.animationDuration},b.animateFrom=function(c){return arguments.length?(a.animateFrom=c,b):a.animateFrom},b.data=function(c){return arguments.length?(a.currentData=c,a.currentData.charts||(a.currentData.charts=[]),a.currentData.controls||(a.currentData.controls=[]),b):a.currentData},b.update=function(c){if(!a.selection)return console.warn("page was not given a selection");var d=a.getPosition();if(a.animateFrom&&a.selection.currentPage&&(a.selection.oldPage=a.selection.currentPage),a.init(d),a.computedHeight=0,a.currentData.charts.length<1&&!a.currentData.url)console.warn("chart page was not provided any charts or url");else{a.modifiedData.charts=a.currentData.charts,a.modifiedData.controls=a.currentData.controls;var e={};if(a.currentData.controls.forEach(function(a){e[a.key]=a}),a.currentData.url){var f=d3.xhr(a.currentData.url);f.post(JSON.stringify(e),function(b,c){var d=JSON.parse(c.response);d.charts&&(a.modifiedData.charts=d.charts.concat(a.modifiedData.charts)),a.updateGrid(a.modifiedData.charts),a.dataLoaded=!0})}else a.dataLoaded=!0,a.updateGrid(a.modifiedData.charts)}a.selection.selectAll(".d2b-chart-page-old").transition().duration(a.animationDuration).style("opacity",0).style("left",-d.left+"px").style("top",-d.top+"px").remove(),d3.timer.flush(),c&&c();for(key in a.on.update)a.on.update[key].call(this,a.modifiedData);return b},b},d2b.UTILS.CHARTPAGE.chartLayout=function(){var a,b,c=d2b.CONSTANTS.DEFAULTWIDTH(),d=d2b.CONSTANTS.DEFAULTHEIGHT(),e={chartLayout:{}},f=d2b.CONSTANTS.ANIMATIONLENGTHS().normal,g=!0,h={};return h.chart=function(a){return arguments.length?(b=a,g=!0,h):b},h.width=function(a){return arguments.length?(c=a,h):c},h.height=function(a){return arguments.length?(d=a,h):d},h.selection=function(b){return arguments.length?(a=b,g=!0,h):a},h.select=function(b){return arguments.length?(a=d3.select(b),g=!0,h):a},h.animationDuration=function(a){return arguments.length?(f=a,h):f},h.data=function(a,b){return arguments.length?(b&&(e={chartLayout:{}},g=!0),a.data.chartLayout.footnote&&(e.chartLayout.footnote=a.data.chartLayout.footnote),a.data.chartLayout.rightNotes&&(e.chartLayout.rightNotes=a.data.chartLayout.rightNotes),a.data.chartLayout.leftNotes&&(e.chartLayout.leftNotes=a.data.chartLayout.leftNotes),a.data.chartLayout.title&&(e.chartLayout.title=a.data.chartLayout.title),a.data.chartLayout.titleAlt&&(e.chartLayout.titleAlt=a.data.chartLayout.titleAlt),a.data.chartCallback&&(e.chartCallback=a.data.chartCallback),a.data.info&&(e.chartLayout.info=a.data.info),h):e},h.generate=function(c){a.selectAll("*").remove(),a.wrapper=a.append("div").attr("class","d2b-chart-layout-wrapper"),a.container=a.wrapper.append("div").attr("class","d2b-chart-layout d2b-container"),a.container.header=a.container.append("div").attr("class","d2b-chart-layout-header"),a.container.header.title=a.container.header.append("div").attr("class","d2b-chart-layout-title"),a.container.header.titleAlt=a.container.header.append("div").attr("class","d2b-chart-layout-title-alt"),a.container.header.info=a.container.header.append("div").attr("class","d2b-chart-layout-info"),a.container.chart=a.container.append("div").attr("class","d2b-chart-layout-chart"),b.selection(a.container.chart),a.container.rightNotes=a.container.append("div").attr("class","d2b-chart-layout-right-notes"),a.container.rightNotes.ul=a.container.rightNotes.append("ul"),a.container.leftNotes=a.container.append("div").attr("class","d2b-chart-layout-left-notes"),a.container.leftNotes.ul=a.container.leftNotes.append("ul"),a.container.footnote=a.container.append("div").attr("class","d2b-chart-layout-footnote"),a.container.footnote.div=a.container.footnote.append("div"),a.container.source=a.container.append("div").attr("class","d2b-chart-layout-source").append("ul"),g=!1;var d=f;return h.animationDuration(0).update(c).animationDuration(d),h},h.update=function(i){if(!a)return console.warn("chartLayout was not given a selection");if(!b)return console.warn("chartLayout was not given a chart");g&&h.generate(i);var j={top:10,bottom:0,left:0,right:0};a.wrapper.style("width",c+"px").style("height",d+"px"),a.container.header.title.text(e.chartLayout.title),a.container.header.titleAlt.text(e.chartLayout.titleAlt),e.chartLayout.title?(a.container.header.style("opacity",1),j.top+=a.container.header.node().getBoundingClientRect().height):a.container.header.style("opacity","0"),e.chartLayout.info?a.container.header.info.html('<i class="fa fa-info-circle"></i>'):a.container.header.info.selectAll("*").remove(),a.container.footnote.div.text(e.chartLayout.footnote),j.bottom+=a.container.footnote.node().getBoundingClientRect().height,a.container.footnote.style("top",d-j.bottom+"px"),!e.chartLayout.rightNotes||e.chartLayout.rightNotes.length<1?e.chartLayout.rightNotes=[]:j.right+=.2*c+5;var k=a.container.rightNotes.ul.selectAll("li.d2b-chart-layout-note").data(e.chartLayout.rightNotes);k.enter().append("li").attr("class","d2b-chart-layout-note").append("div");var l=0;k.select("div").text(function(a){return a}).each(function(){l+=this.getBoundingClientRect().height}),k.exit().style("opacity",0).remove(),a.container.rightNotes.style("width",.2*c+"px").style("height",d-j.top+"px").style("left",.8*c-5+"px"),k.style("padding-top",Math.max(10,(d-l)/(1.8*k.size()))+"px"),!e.chartLayout.leftNotes||e.chartLayout.leftNotes.length<1?e.chartLayout.leftNotes=[]:j.left+=.2*c;var m=a.container.leftNotes.ul.selectAll("li.d2b-chart-layout-note").data(e.chartLayout.leftNotes);m.enter().append("li").attr("class","d2b-chart-layout-note").append("div");var n=0;m.select("div").text(function(a){return a}).each(function(){n+=this.getBoundingClientRect().height}),m.exit().style("opacity",0).remove(),a.container.leftNotes.style("width",.2*c+"px").style("left","5px"),m.style("padding-top",Math.max(10,(d-n)/(1.8*m.size()))+"px");var o=c-j.left-j.right-10,p=d-j.top-j.bottom;return a.container.chart.style("left",j.left+5+"px").style("top",j.top+"px").style("width",o+"px").style("height",p+"px"),b.width(o).height(p).animationDuration(f).update(e.chartCallback),d3.timer.flush(),i&&i(),h},h},d2b.UTILS.dashboardCategory=function(){var a={};a.width=d2b.CONSTANTS.DEFAULTWIDTH(),a.selection,a.chartPageSelection,a.currentData,a.computedHeight=0,a.animationDuration=d2b.CONSTANTS.ANIMATIONLENGTHS().normal,a.animateFrom=null,a.charts=[],a.on={pageChange:function(){}},a.init=function(b){if(a.animateFrom||!a.selection.currentCategory){a.currentPageIndex=0,a.selection.selectAll(".d2b-category").classed("d2b-category-old",!0),a.selection.currentCategory=a.selection.append("div").attr("class","d2b-category").style("opacity",0).style("left",b.left+"px").style("top",b.top+"px"),a.selection.currentCategory.label=a.selection.currentCategory.append("div").attr("class","d2b-category-label"),a.selection.currentCategory.label.section=a.selection.currentCategory.label.append("div").attr("class","d2b-category-label-section"),a.selection.currentCategory.label.category=a.selection.currentCategory.label.append("div").attr("class","d2b-category-label-category"),a.selection.currentCategory.label.pages=a.selection.currentCategory.label.append("div").attr("class","d2b-category-label-pages"),a.chartPageSelection=a.selection.chartPage=a.selection.currentCategory.append("div").attr("class","d2b-chart-page-container"),a.currentData.pages.length>0?(pageData=a.currentData.pages[0],a.selection.currentCategory.label.pages.style("display","")):(pageData=a.currentData,a.selection.currentCategory.label.pages.style("display","none"));for(key in a.on.pageChange)a.on.pageChange[key].call(this,pageData,0,0)}},a.getPosition=function(){var b={top:0,left:0};switch(a.animateFrom){case"right":b.top=0,b.left=a.width;break;case"left":b.top=0,b.left=-a.width;break;case"top":b.top=-a.computedHeight,b.left=0;break;case"bottom":b.top=a.computedHeight,b.left=0}return b};var b={};return b.on=d2b.UTILS.CHARTS.MEMBERS.on(b,a),b.chartPageSelection=d2b.UTILS.CHARTS.MEMBERS.prop(b,a,"chartPageSelection"),b.width=function(c){return arguments.length?(a.width=c,b):a.width},b.computedHeight=function(){return a.computedHeight},b.selection=function(c){return arguments.length?(a.selection=c,b):a.selection},b.select=function(c){return arguments.length?(a.selection=d3.select(c),b):a.selection},b.animationDuration=function(c){return arguments.length?(a.animationDuration=c,b):a.animationDuration},b.animateFrom=function(c){return arguments.length?(a.animateFrom=c,b):a.animateFrom},b.data=function(c){return arguments.length?(a.currentData=c.data,a.currentData.pages||(a.currentData.pages=[]),b):a.currentData},b.update=function(c){if(!a.selection)return console.warn("category was not given a $$.selection");var d=a.getPosition();return a.animateFrom&&a.selection.currentCategory&&(a.selection.oldCategory=a.selection.currentCategory),a.init(d),a.computedHeight=0,a.selection.currentCategory.label.section.text(a.currentData.sectionName),a.selection.currentCategory.label.category.text(a.currentData.name),a.selection.currentCategory.label.pages.tab=a.selection.currentCategory.label.pages.selectAll(".d2b-page-tab").data(a.currentData.pages),a.selection.currentCategory.label.pages.tab.enter().append("div").attr("class","d2b-page-tab").text(function(a){return a.name}).each(function(a,b){d3.select(this).classed("d2b-tab-selected",!b)}),a.selection.currentCategory.label.pages.tab.on("click",function(b,c){a.selection.currentCategory.label.pages.tab.classed("d2b-tab-selected",!1),d3.select(this).classed("d2b-tab-selected",!0);for(key in a.on.pageChange)a.on.pageChange[key].call(this,b,a.currentPageIndex,c);a.currentPageIndex=c}),a.selection.selectAll(".d2b-category-old").transition().duration(a.animationDuration).style("opacity",0).style("left",-d.left+"px").style("top",-d.top+"px").remove(),a.selection.currentCategory.transition().duration(a.animationDuration).style("opacity",1).style("left","0px").style("top","0px"),d3.timer.flush(),c&&c(),b},b},d2b.createNameSpace("d2b.UTILS.CONTROLS"),d2b.UTILS.CONTROLS.checkbox=function(){var a={};a.scale=5,a.selection,a.container,a.computedWidth=0,a.computedHeight=0,a.currentData={label:"",state:!1},a.on=d2b.CONSTANTS.DEFAULTEVENTS(),a.on.change=function(){};var b={};return b.scale=d2b.UTILS.CHARTS.MEMBERS.prop(b,a,"scale"),b.select=d2b.UTILS.CHARTS.MEMBERS.select(b,a),b.selection=d2b.UTILS.CHARTS.MEMBERS.prop(b,a,"selection"),b.container=d2b.UTILS.CHARTS.MEMBERS.prop(b,a,"container"),b.on=d2b.UTILS.CHARTS.MEMBERS.on(b,a),b.checked=function(c){return arguments.length?(a.currentData.state=c,b.update()):a.currentData.state},b.computedHeight=function(){return a.computedHeight},b.computedWidth=function(){return a.computedWidth},b.data=function(c){return arguments.length?(a.currentData=c,b):a.currentData},b.update=function(c){if(!a.selection&&!a.container)return console.warn("checkbox was not given a selection or html container"),b;if(!a.currentData)return console.warn("checkbox data is null"),b;a.selection||(a.selection=a.container.append("svg"),a.container.svg=a.selection);var d=a.selection.selectAll("g.d2b-checkbox-container").data([a.currentData]),e=d.enter().append("g").attr("class","d2b-checkbox-container").on("click.d2b-click",function(c,d){a.currentData.state=!a.currentData.state;for(key in a.on.change)a.on.change[key].call(this,c,d,"checkbox");b.update()}).call(d2b.UTILS.bindElementEvents,a,"checkbox");e.append("rect").attr("rx",1),e.append("path"),e.append("text").text(function(a){return a.label});var f="translate("+.4*a.scale+","+.4*a.scale+")",g=d.select("path").attr("transform",f).attr("d","M"+.38*a.scale+","+1.06*a.scale+" l"+.7*a.scale+","+.5*a.scale+" l"+.58*a.scale+","+-1.19*a.scale).style("stroke-width",.25*a.scale).attr("stroke-dasharray",2.2*a.scale);g.transition().duration(d2b.CONSTANTS.ANIMATIONLENGTHS()["short"]).attr("stroke-dashoffset",a.currentData.state?0:2.2*a.scale);var h=(d.select("rect").attr("width",2.1*a.scale+"px").attr("height",2.1*a.scale+"px").attr("transform",f).style("stroke-width",.25*a.scale),d.select("text").attr("y",2.4*a.scale).attr("x",3.2*a.scale).style("font-size",2.5*a.scale+"px")),i=h.node().getComputedTextLength(),j=a.scale;return i+=j,a.computedWidth=i+2.5*a.scale,a.computedHeight=2.9*a.scale,a.container&&a.container.svg&&a.container.svg.attr("width",a.computedWidth).attr("height",a.computedHeight),c&&c(),b},b},d2b.UTILS.CONTROLS.radioButtons=function(){var a={};a.scale=5,a.container,a.selection,a.computedWidth=0,a.computedHeight=0,a.currentData={label:"",values:[],selected:null},a.on=d2b.CONSTANTS.DEFAULTEVENTS(),a.on.change=function(){},a.resetValues=function(){a.currentData.values.forEach(function(a){a.selected=!1})};var b={};return b.scale=d2b.UTILS.CHARTS.MEMBERS.prop(b,a,"scale"),b.select=d2b.UTILS.CHARTS.MEMBERS.select(b,a),b.selection=d2b.UTILS.CHARTS.MEMBERS.prop(b,a,"selection"),b.container=d2b.UTILS.CHARTS.MEMBERS.prop(b,a,"container"),b.on=d2b.UTILS.CHARTS.MEMBERS.on(b,a),b.computedHeight=function(){return a.computedHeight},b.computedWidth=function(){return a.computedWidth},b.data=function(c){if(!arguments.length)return a.currentData;a.currentData=c;var d=!1;return a.currentData.values.forEach(function(b){d&&(b.selected=!1),b.selected&&(a.currentData.selected=b,d=!0)}),d||(a.currentData.selected=a.currentData.values[0],a.currentData.values[0].selected=!0),b},b.update=function(c){if(!a.selection&&!a.container)return console.warn("radio buttons was not given a selection or html container"),b;if(!a.currentData)return console.warn("radio buttons data is null"),b;a.selection||(a.selection=a.container.append("svg"),a.container.svg=a.selection);var d=a.selection.selectAll("g.d2b-radio-button-container").data(a.currentData.values,function(a){return a.label}),e=d.enter().append("g").attr("class","d2b-radio-button-container").on("click.d2b-click",function(c,d){a.resetValues(),c.selected=!0,a.currentData.selected=c;for(key in a.on.change)a.on.change[key].call(a.selection.node(),a.currentData,d,"radio-buttons");b.update()}).call(d2b.UTILS.bindElementEvents,a,"radio-button");d.attr("transform",function(b,c){return"translate(0,"+3.3*c*a.scale+")"}),e.append("circle").attr("class","d2b-radio-button-inner").style("fill-opacity",0),e.append("circle").attr("class","d2b-radio-button-outer"),e.append("text").text(function(a){return a.label});{var f=d.select("circle.d2b-radio-button-inner").attr("cy",1.4*a.scale).attr("cx",1.4*a.scale);d.select("circle.d2b-radio-button-outer").attr("r",1*a.scale+"px").attr("cy",1.4*a.scale).attr("cx",1.4*a.scale).style("stroke-width",.25*a.scale)}f.transition().duration(d2b.CONSTANTS.ANIMATIONLENGTHS()["short"]).style("fill-opacity",function(a){return a.selected?1:0}).attr("r",function(b){return b.selected?.5*a.scale:0});var g=d.select("text").attr("y",2.4*a.scale).attr("x",3.2*a.scale).style("font-size",2.5*a.scale+"px"),h=0;return g.each(function(){h=Math.max(h,this.getComputedTextLength())}),a.computedWidth=h+3.4*a.scale,a.computedHeight=a.currentData.values.length*a.scale*3.2,a.container&&a.container.svg&&a.container.svg.attr("width",a.computedWidth).attr("height",a.computedHeight),c&&c(),b},b},d2b.UTILS.CONTROLS.htmlControls=function(){var a={};a.maxWidth=d2b.CONSTANTS.DEFAULTWIDTH(),a.currentData,a.computedWidth=0,a.computedHeight=0,a.animationDuration=d2b.CONSTANTS.ANIMATIONLENGTHS().normal,a.controlsHash={},a.selection,a.scale=5,a.makeControlsHash=function(){a.controlsHash={},a.currentData.controls.forEach(function(b){a.controlsHash[b.key]=b})},a.on={elementMouseover:function(){},elementMouseout:function(){},elementClick:function(){},change:function(){}};var b={};return b.select=d2b.UTILS.CHARTS.MEMBERS.select(b,a),b.width=function(c){return arguments.length?(a.maxWidth=c,b):a.maxWidth},b.computedHeight=function(){return a.computedHeight},b.computedWidth=function(){return a.computedWidth},b.selection=function(c){return arguments.length?(a.selection=c,b):a.selection},b.scale=function(c){return arguments.length?(a.scale=c,b):a.scale},b.animationDuration=function(c){return arguments.length?(a.animationDuration=c,b):a.animationDuration},b.on=d2b.UTILS.CHARTS.MEMBERS.on(b,a),b.data=function(c){return arguments.length?(a.currentData=c,a.makeControlsHash(),b):a.currentData},b.update=function(c){if(!a.selection)return console.warn("controls was not given a selection");a.selection.controlContainer=a.selection.selectAll("div.d2b-control-container").data(a.currentData.controls,function(a){return a.type+"-"+a.key});var d=a.selection.controlContainer.enter().append("div").attr("class","d2b-control-container");return d.append("div").attr("class","d2b-control-label").text(function(a){return a.label+":"}),d.append("div").attr("class","d2b-control").each(function(a){this.control=new d2b.UTILS.CONTROLS[a.type],this.control.container(d3.select(this))}),a.selection.controlContainer.control=a.selection.controlContainer.select(".d2b-control").each(function(b){this.control.scale(a.scale).data(b).on("change.d2b-change",function(b,c){for(key in a.on.change)a.on.change[key].call(this,a.controlsHash,b,c)}).update()}),a.selection.controlContainer.exit().remove(),b},b},d2b.UTILS.CONTROLS.controls=function(){var a={};a.maxWidth=d2b.CONSTANTS.DEFAULTWIDTH(),a.currentData,a.computedWidth=0,a.computedHeight=0,a.animationDuration=d2b.CONSTANTS.ANIMATIONLENGTHS().normal,a.selection,a.scale=5;var b={elementMouseover:function(){},elementMouseout:function(){},elementClick:function(){},change:function(){}},c={};return c.width=function(b){return arguments.length?(a.maxWidth=b,c):a.maxWidth},c.computedHeight=function(){return a.computedHeight},c.computedWidth=function(){return a.computedWidth},c.selection=function(b){return arguments.length?(a.selection=b,c):a.selection},c.scale=function(b){return arguments.length?(a.scale=b,c):a.scale},c.animationDuration=function(b){return arguments.length?(a.animationDuration=b,c):a.animationDuration},c.on=function(a,d){return a=a.split("."),arguments.length?1==arguments.length?a[1]?b[a[0]][a[1]]:b[a[0]]["default"]:(a[1]?b[a[0]][a[1]]=d:b[a[0]]["default"]=d,c):b},c.data=function(b){return arguments.length?(a.currentData=b,c):a.currentData},c.update=function(c){if(!a.selection)return console.warn("controls was not given a $$.selection");var d=3*a.scale,e=a.scale;if(a.computedHeight=0,a.computedWidth=0,a.currentData.length>0){var f=a.selection.selectAll("g.d2b-control").data(a.currentData,function(a){return a.label+","+a.type});f.enter().append("g").attr("class","d2b-control").each(function(a){a.control=new d2b.UTILS.CONTROLS[a.type],a.control.selection(d3.select(this)).on("elementClick.d2b-click",function(a,c){for(key in b.elementClick)b.elementClick[key].call(this,a,c)}).on("change.d2b-change",function(a,c){for(key in b.change)b.change[key].call(this,a,c)}).on("elementMouseover.d2b-mouseover",function(a,c){for(key in b.elementMouseover)b.elementMouseover[key].call(this,a,c)}).on("elementMouseout.d2b-mouseout",function(a,c){for(key in b.elementMouseout)b.elementMouseout[key].call(this,a,c)})});var g=0,h=0;f.each(function(b){b.control.scale(a.scale).data(b.data).update(),a.computedWidth+b.control.computedWidth()>a.maxWidth&&(a.computedWidth=0,a.computedHeight+=g+e,g=0),d3.select(this).transition().duration(a.animationDuration).style("opacity",1).attr("transform","translate("+a.computedWidth+","+a.computedHeight+")"),a.computedWidth+=b.control.computedWidth()+d,g<b.control.computedHeight()&&(g=b.control.computedHeight()),h<a.computedWidth&&(h=a.computedWidth)}),a.computedWidth=h-d,a.computedHeight+=g,f.exit().transition().duration(a.animationDuration).style("opacity",0).remove()}return f},c},Function.prototype.clone=function(){var a=this,b=function(){return a.apply(this,arguments)};for(var c in this)this.hasOwnProperty(c)&&(b[c]=this[c]);return b},d2b.UTILS.tooltip=function(a,b,c){a.on("mouseover.d2b-mouseover-tooltip",function(a,d){d2b.UTILS.createGeneralTooltip(d3.select(this),b(a,d),c(a,d))}).on("mouseout.d2b-mouseout-tooltip",function(){d2b.UTILS.removeTooltip()})},d2b.UTILS.createGeneralTooltip=function(a,b,c){var d=d3.select("body"),e=d.append("div").attr("class","d2b-general-tooltip").html(b+": "+c).style("opacity",0);e.transition().duration(50).style("opacity",1);var f=d2b.UTILS.scrollOffset(),g=d.node().getBoundingClientRect().width,h={left:0,top:0};return h.left=f.left+d3.event.clientX<g/2?f.left+d3.event.clientX+10:f.left+d3.event.clientX-e.node().getBoundingClientRect().width-10,h.top=f.top+d3.event.clientY-10,d2b.UTILS.moveTooltip(e,h.left,h.top,0),a.on("mousemove",function(){f=d2b.UTILS.scrollOffset(),h.left=f.left+d3.event.clientX<g/2?f.left+d3.event.clientX+10:f.left+d3.event.clientX-e.node().getBoundingClientRect().width-10,h.top=f.top+d3.event.clientY-10,d2b.UTILS.moveTooltip(e,h.left,h.top,50)}),e},d2b.UTILS.removeTooltip=function(){d3.selectAll(".d2b-general-tooltip").remove()},d2b.UTILS.moveTooltip=function(a,b,c,d){a.transition().duration(d).ease("linear").style("opacity",1).style("top",c+"px").style("left",b+"px"),d3.timer.flush()},d2b.UTILS.scrollOffset=function(){var a=document.documentElement,b=(window.pageXOffset||a.scrollLeft)-(a.clientLeft||0),c=(window.pageYOffset||a.scrollTop)-(a.clientTop||0);return{top:c,left:b}},d2b.UTILS.getValues=function(a){var b=[];for(var c in a)a[c].key=c,b.push(a[c]);return b},d2b.createNameSpace("d2b.UTILS.AXISCHARTS"),d2b.UTILS.AXISCHARTS.getDomainLinear=function(a){return[d3.min(a)<0?d3.min(a):0,d3.max(a)+1]},d2b.UTILS.AXISCHARTS.getDomainOrdinal=function(a){return d3.set(a).values()},d2b.UTILS.niceFormat=function(a,b){b||(b=0);var c=d3.format("."+b+"f");return absValue=Math.abs(a),isNaN(a)?a:absValue<Math.pow(10,3)?c(absValue):absValue<Math.pow(10,6)?c(absValue/Math.pow(10,3))+" thousand":absValue<Math.pow(10,9)?c(absValue/Math.pow(10,6))+" million":absValue<Math.pow(10,12)?c(absValue/Math.pow(10,9))+" billion":absValue<Math.pow(10,15)?c(absValue/Math.pow(10,12))+" trillion":absValue<Math.pow(10,18)?c(absValue/Math.pow(10,15))+" quadrillion":absValue<Math.pow(10,21)?c(absValue/Math.pow(10,18))+" quintillion":absValue<Math.pow(10,24)?c(absValue/Math.pow(10,21))+" sextillion":absValue<Math.pow(10,27)?c(absValue/Math.pow(10,24))+" septillion":absValue<Math.pow(10,30)?c(absValue/Math.pow(10,27))+" octillion":absValue<Math.pow(10,33)?c(absValue/Math.pow(10,30))+" nonillion":absValue<Math.pow(10,36)?c(absValue/Math.pow(10,33))+" decillion":absValue<Math.pow(10,39)?c(absValue/Math.pow(10,36))+" undecillion":absValue<Math.pow(10,42)?c(absValue/Math.pow(10,39))+" duodecillion":absValue<Math.pow(10,45)?c(absValue/Math.pow(10,42))+" tredecillion":absValue<Math.pow(10,48)?c(absValue/Math.pow(10,45))+" quattuordecillion":absValue<Math.pow(10,51)?c(absValue/Math.pow(10,48))+" quindecillion":absValue<Math.pow(10,54)?c(absValue/Math.pow(10,51))+" sexdecillion":absValue<Math.pow(10,57)?c(absValue/Math.pow(10,54))+" septendecillion":absValue<Math.pow(10,60)?c(absValue/Math.pow(10,57))+" octdecillion":absValue<Math.pow(10,63)?c(absValue/Math.pow(10,60))+" novemdecillion":absValue<Math.pow(10,303)?c(absValue/Math.pow(10,63))+" vigintillion":c(absValue/Math.pow(10,303))+" centillion"},d2b.UTILS.numberFormat=function(a){var b,c="",d={before:a.units.before?a.units.before:"",after:a.units.after?a.units.after:""};return a.nice?function(b){return d.before+d2b.UTILS.niceFormat(b,a.precision)+d.after}:(a.siPrefixed?(a.precision>-1&&(c+="."+a.precision),c+="s"):(a.separateThousands&&(c+=","),a.precision>-1&&(c+="."+a.precision+"f")),b=d3.format(c),function(a){return isNaN(a)?d.before+a+d.after:d.before+b(a)+d.after})},d2b.UTILS.textWrap=function(a,b){a.each(function(){for(var a,c=d3.select(this),d=c.text().split(/\s+/).reverse(),e=[],f=0,g=1.1,h=c.attr("y"),i=parseFloat(c.attr("dy")),j=c.text(null).append("tspan").attr("x",0).attr("y",h).attr("dy",i+"em");a=d.pop();)e.push(a),j.text(e.join(" ")),j.node().getComputedTextLength()>b&&(e.pop(),j.text(e.join(" ")),e=[a],j=c.append("tspan").attr("x",0).attr("y",h).attr("dy",++f*g+i+"em").text(a))})},d2b.createNameSpace("d2b.UTILS.TWEENS"),d2b.UTILS.TWEENS.arcTween=function(a,b){a.attrTween("d",function(){function a(a){return c.oldArc=d(a),b(c.oldArc)}var c=this,d=d3.interpolate(c.oldArc,c.newArc);return a})},d2b.UTILS.bind=function(a,b,c,d,e,f){for(key in c.on[a])c.on[a][key].call(b,d,e,f)},d2b.UTILS.bindElementEvents=function(a,b,c){a.on("mouseover.d2b-element-mouseover",function(d,e){d2b.UTILS.bind("elementMouseover",a,b,d,e,c)}).on("mouseout.d2b-element-mouseout",function(d,e){d2b.UTILS.bind("elementMouseout",a,b,d,e,c)}).on("click.d2b-element-click",function(d,e){d2b.UTILS.bind("elementClick",a,b,d,e,c)})},d2b.createNameSpace("d2b.UTILS.LEGENDS"),d2b.UTILS.LEGENDS.legend=function(){var a,b,c,d,e=d2b.CONSTANTS.DEFAULTWIDTH(),f=d2b.CONSTANTS.DEFAULTHEIGHT(),g=[],h=d2b.CONSTANTS.DEFAULTCOLOR(),i=0,j=0,k=d2b.CONSTANTS.ANIMATIONLENGTHS().normal,l="horizontal",m=5,n=5,o={elementMouseover:function(){},elementMouseout:function(){},elementClick:function(){},elementDblClick:function(){}},p={};return p.items=function(a){return arguments.length?(g=a,p):g},p.padding=function(a){return arguments.length?(m=a,p):m},p.width=function(a){return arguments.length?(e=a,p):e},p.height=function(a){return arguments.length?(f=a,p):f},p.computedHeight=function(){return j},p.computedWidth=function(){return i},p.color=function(a){return arguments.length?(h=a,p):h},p.selection=function(a){return arguments.length?(c=a,p):c},p.select=function(a){return arguments.length?(c=d3.select(a),p):c},p.animationDuration=function(a){return arguments.length?(k=a,p):k},p.scale=function(a){return arguments.length?(n=a,p):n},p.orientation=function(a){return arguments.length?(l=a,p):l},p.on=function(a,b){return a=a.split("."),arguments.length?1==arguments.length?a[1]?o[a[0]][a[1]]:o[a[0]]["default"]:(a[1]?o[a[0]][a[1]]=b:o[a[0]]["default"]=b,p):o},p.data=function(a){return arguments.length?(d=a.data,p):d},p.update=function(g){if(!c)return console.warn("legend was not given a selection");j=0,i=0,a=f-2*m,b=e-2*m;var q=c.selectAll("g.d2b-legend-item").data(d.items,function(a){return a.label}),r=q.enter().append("g").attr("class","d2b-legend-item").style("opacity",0).on("mouseover.d2b-mouseover",function(a,b){for(key in o.elementMouseover)o.elementMouseover[key].call(this,a,b)}).on("mouseout.d2b-mouseout",function(a,b){for(key in o.elementMouseout)o.elementMouseout[key].call(this,a,b)}).on("click.d2b-click",function(a,b){for(key in o.elementClick)o.elementClick[key].call(this,a,b)}).on("dblclick.d2b-dblClick",function(a,b){for(key in o.elementDblClick)o.elementDblClick[key].call(this,a,b)});r.append("circle").style("fill",function(a){return a.color||h(a.colorKey?a.colorKey:a.label)}).style("stroke",function(a){return a.color||h(a.colorKey?a.colorKey:a.label)}),r.append("text").text(function(a){return a.label});var s=q.select("circle").attr("r",n).attr("y",n/2);s.transition().duration(k).style("stroke-width",function(a){return a.open?"2px":"0px"}).style("fill-opacity",function(a){return a.open?0:1});var t=q.select("text").style("font-size",2.5*n+"px").attr("x",2*n).attr("y",n),u=n+m,v=n+m,w=0,x=0;if(d.items.length>0)if("vertical"==l)q.transition().duration(k).style("opacity",1).attr("transform",function(){var b="translate("+u+","+v+")";return v>x&&(x=v),v+=4*n,w=Math.max(w,d3.select(this).select("text").node().getComputedTextLength()),v+n>a&&(v=n+m,u+=w+6*n,w=0),b}),i=u+w+2*n+m,j=x+n+m;else{var w=0;t.each(function(){var a=this.getComputedTextLength();a>w&&(w=a)}),w+=6*n;var y=Math.floor((b+3*n)/w);q.transition().duration(k).style("opacity",1).attr("transform",function(a,b){b%y==0&&b>0&&(u=n+m,v+=4*n);var c="translate("+u+","+v+")";return u+=w,c}),j=v+n+m,i=q.size()>y?w*y-3*n+2*m:w*q.size()-3*n+2*m}return q.exit().transition().duration(k).style("opacity",0).remove(),g&&g(),p},p},d2b.UTILS.breadcrumbs=function(){var a,b=d2b.CONSTANTS.DEFAULTWIDTH(),c=(d2b.CONSTANTS.DEFAULTCOLOR(),{items:[]}),d=0,e=0,f=d2b.CONSTANTS.ANIMATIONLENGTHS().normal,g=5,h={elementMouseover:function(){},elementMouseout:function(){},elementClick:function(){}},j={};return j.width=function(a){return arguments.length?(b=a,j):b},j.computedHeight=function(){return e},j.computedWidth=function(){return d},j.selection=function(b){return arguments.length?(a=b,j):a
},j.scale=function(a){return arguments.length?(g=a,j):g},j.animationDuration=function(a){return arguments.length?(f=a,j):f},j.on=function(a,b){return a=a.split("."),arguments.length?1==arguments.length?a[1]?h[a[0]][a[1]]:h[a[0]]["default"]:(a[1]?h[a[0]][a[1]]=b:h[a[0]]["default"]=b,j):h},j.data=function(a){return arguments.length?(c=a.data,j):c},j.update=function(b){if(!a)return console.warn("breadcrumbs was not given a selection");a.breadcrumb=a.selectAll("g.d2b-breadcrumb").data(c.items,function(a){return a.key?a.key:i});var d=a.breadcrumb.enter().append("g").attr("class","d2b-breadcrumb").style("opacity",0);d.append("path"),d.append("text");var h=g,k=g,l=4*g;a.breadcrumb.text=a.breadcrumb.select("text").text(function(a){return a.label}).attr("x",k+h).attr("y",2.9*g).style("font-size",2.5*g+"px"),a.breadcrumb.path=a.breadcrumb.select("path");var m=0;return a.breadcrumb.each(function(b,c){var d=d3.select(this);d.text=d.select("text"),d.path=d.select("path");var e=d.text.node().getComputedTextLength()+2*k+h,g=h,i=h;0==c&&(g=0),c==a.breadcrumb.size()-1&&(i=0),d.path.transition().duration(f/2).attr("d","M 0 0 L "+g+" "+l/2+" L 0 "+l+" L "+e+" "+l+" L "+(e+i)+" "+l/2+" L "+e+" 0 L 0 0 Z"),d.transition().duration(f/2).style("opacity",1).attr("transform","translate("+m+",0)"),m+=h+e}),e=l,a.breadcrumb.exit().transition().duration(f/4).style("opacity",0).remove(),j},j},d2b.createNameSpace("d2b.UTILS.CHARTS.MEMBERS"),d2b.UTILS.CHARTS.MEMBERS.on=function(a,b,c){return function(d,e){return d=d.split("."),arguments.length?1==arguments.length?d[1]?b.on[d[0]][d[1]]:b.on[d[0]]["default"]:(d[1]?b.on[d[0]][d[1]]=e:b.on[d[0]]["default"]=e,c&&c(e),a):b.on}},d2b.UTILS.CHARTS.MEMBERS.select=function(a,b,c){return function(d){return b.selection=d3.select(d),c&&c(d),a}},d2b.UTILS.CHARTS.MEMBERS.prop=function(a,b,c,d){return function(e){return arguments.length?(b[c]=e,d&&d(e),a):b[c]}},d2b.UTILS.CHARTS.MEMBERS.scale=function(a,b,c,d){return function(e){if(!arguments.length)return b[c];if(e.type){b[c].type=e.type;var f=b[c].type.split(",");b[c].scale="quantitative"==f[0]?d3.scale[f[1]]():"time"==f[0]?d3[f[0]].scale():d3.scale[f[0]]()}return e.domain&&(b[c].domain=e.domain,b[c].scale.domain(b[c].domain)),b[c].hide=e.hide,b[c].invert=e.invert,d&&d(e),a}},d2b.UTILS.CHARTS.MEMBERS.format=function(a,b,c,d){return function(e){return arguments.length?(b[c]=d2b.UTILS.numberFormat(e),d&&d(e),a):b[c]}},d2b.UTILS.CHARTS.MEMBERS.controls=function(a,b,c){return function(d){if(!arguments.length)return b.controlsData;for(control in d)for(controlProp in d[control])b.controlsData[control][controlProp]=d[control][controlProp];return c&&c(d),a}},d2b.createNameSpace("d2b.UTILS.CHARTS.HELPERS"),d2b.UTILS.CHARTS.HELPERS.updateLegend=function(a){var b=10;"right"==a.legendOrientation||"left"==a.legendOrientation?a.legend.orientation("vertical").data(a.legendData).height(a.innerHeight).update():a.legend.orientation("horizontal").data(a.legendData).width(a.innerWidth).update();var c;c="right"==a.legendOrientation?"translate("+(a.forcedMargin.left+a.innerWidth-a.legend.computedWidth())+","+((a.innerHeight-a.legend.computedHeight())/2+a.forcedMargin.top)+")":"left"==a.legendOrientation?"translate("+a.forcedMargin.left+","+((a.innerHeight-a.legend.computedHeight())/2+a.forcedMargin.top)+")":"top"==a.legendOrientation?"translate("+(a.forcedMargin.left+(a.innerWidth-a.legend.computedWidth())/2)+","+a.forcedMargin.top+")":"translate("+(a.forcedMargin.left+(a.innerWidth-a.legend.computedWidth())/2)+","+(a.innerHeight+a.forcedMargin.top-a.legend.computedHeight())+")",a.selection.legend.transition().duration(a.animationDuration).attr("transform",c);var d;d="right"==a.legendOrientation||"left"==a.legendOrientation?a.legend.computedWidth():a.legend.computedHeight(),d&&(d+=b),a.forcedMargin[a.legendOrientation]+=d,a.innerHeight=a.outerHeight-a.forcedMargin.top-a.forcedMargin.bottom,a.innerWidth=a.outerWidth-a.forcedMargin.left-a.forcedMargin.right},d2b.UTILS.CHARTS.HELPERS.updateControls=function(a){var b=10,c=d2b.UTILS.getValues(a.controlsData).filter(function(a){return a.visible});c.map(function(a){a.data={state:a.enabled,label:a.label,key:a.key}}),a.controls.data(c).width(a.innerWidth).update(),a.selection.controls.transition().duration(a.animationDuration).attr("transform","translate("+(a.forcedMargin.left+a.innerWidth-a.controls.computedWidth())+","+a.forcedMargin.top+")");var d=a.controls.computedHeight();d&&(d+=b),a.forcedMargin.top+=d,a.innerHeight=a.outerHeight-a.forcedMargin.top-a.forcedMargin.bottom},d2b.UTILS.CHARTS.HELPERS.updateDimensions=function(a){a.outerWidth=a.outerWidth-a.forcedMargin.right-a.forcedMargin.left,a.outerHeight=a.outerHeight-a.forcedMargin.top-a.forcedMargin.bottom,a.forcedMargin={top:0,bottom:0,left:0,right:0},a.innerWidth=a.outerWidth,a.innerHeight=a.outerHeight},d2b.UTILS.CHARTS.HELPERS.generateDefaultSVG=function(a){a.selection.selectAll("*").remove(),a.selection.svg=a.selection.append("svg").attr("class","d2b-svg d2b-container"),a.forcedMargin=d2b.CONSTANTS.DEFAULTFORCEDMARGIN(),a.selection.group=a.selection.svg.append("g").attr("transform","translate("+a.forcedMargin.left+","+a.forcedMargin.top+")"),a.selection.legend=a.selection.group.append("g").attr("class","d2b-legend"),a.selection.controls=a.selection.group.append("g").attr("class","d2b-controls")},d2b.CHARTS.sunburstChart=function(){var a={};a.width=d2b.CONSTANTS.DEFAULTWIDTH(),a.height=d2b.CONSTANTS.DEFAULTHEIGHT(),a.innerHeight=a.height,a.innerWidth=a.width,a.outerHeight=a.height,a.outerWidth=a.width,a.forcedMargin=d2b.CONSTANTS.DEFAULTFORCEDMARGIN(),a.generateRequired=!0,a.selection=d3.select("body"),a.animationDuration=d2b.CONSTANTS.ANIMATIONLENGTHS().normal,a.color=d2b.CONSTANTS.DEFAULTCOLOR(),a.currentChartData={data:{partition:{}}},a.xFormat=function(a){return a},a.on=d2b.CONSTANTS.DEFAULTEVENTS(),a.legend=new d2b.UTILS.LEGENDS.legend,a.legendOrientation="bottom",a.legendData={data:{items:[]}},a.controls=new d2b.UTILS.CONTROLS.controls,a.breadcrumbs=new d2b.UTILS.breadcrumbs,a.breadcrumbs.scale(6),a.partitionData,a.currentRoot,a.newData=!0,a.arc=d3.svg.arc().startAngle(function(a){return Math.max(0,Math.min(2*Math.PI,a.start))}).endAngle(function(a){return Math.max(0,Math.min(2*Math.PI,a.end))}).innerRadius(function(a){return Math.max(0,a.inner)}).outerRadius(function(a){return Math.max(0,a.outer)}),a.radius={},a.y={children:d3.scale.pow().exponent(.8),parents:d3.scale.linear()},a.x=d3.scale.linear().range([0,2*Math.PI]),a.controlsData={invert:{label:"Invert",type:"checkbox",visible:!1,enabled:!1},sort:{label:"Sort",type:"checkbox",visible:!1,enabled:!1},hideLegend:{label:"Hide Legend",type:"checkbox",visible:!1,enabled:!1}},a.getAncestors=function(a){for(var b=[],c=a;c.parent;)b.unshift(c),c=c.parent;return b.unshift(c),b},a.arcFill=function(b){var c=a.getAncestors(b).reverse();for(i=0;i<c.length;i++)if(c[i].top)return d3.rgb(a.color(c[i].name)).brighter(.1*i);return a.color(b.name)},a.arcMouseover=function(b){var c=a.getAncestors(b);a.selection.arcs.arc.filter(function(a){return c.indexOf(a)>=0}).transition().duration(a.animationDuration/7).style("opacity",1),a.selection.arcs.arc.filter(function(a){return c.indexOf(a)<0}).transition().duration(a.animationDuration/7).style("opacity",.4),a.updateBreadcrumbs(c)},a.arcMouseover.children=function(b){a.setSunburstTooltip(b,!0)},a.arcMouseover.parents=function(b){a.setSunburstTooltip(b,!1)},a.sunburstMouseout=function(){a.resetBreadcrumbs(),a.selection.arcs.arc.transition().duration(a.animationDuration/5).style("opacity",1),a.resetSunburstTooltip()},a.resetSunburstTooltip=function(){a.setSunburstTooltip(a.currentRoot,!1)},a.setSunburstTooltip=function(b,c){var d=b.name,e=a.xFormat(b.value);c&&(e+=" / "+d3.format(".2%")(b.value/a.currentRoot.value)),a.selection.tooltip.text.selectAll("*").remove(),a.selection.tooltip.text.append("tspan").text(d),a.selection.tooltip.text.append("tspan").attr("y",30).attr("x",0).text(e)},a.arcClick=function(b){a.currentRoot=b,a.updateArcs()},a.getZoomParentDomain=function(a){var b=a,c=[1,0];do c[0]>b.y&&(c[0]=b.y),c[1]<b.y+b.dy&&(c[1]=b.y+b.dy),b=b.parent;while(b);return c},a.getZoomChildDomain=function(b,c){return c?(c[0]>b.y&&(c[0]=b.y),c[1]<b.y+b.dy&&(c[1]=b.y+b.dy)):c=[1,0],b.children&&b.children.forEach(function(b){return a.getZoomChildDomain(b,c)}),c},a.updateArcs=function(){var b=a.getAncestors(a.currentRoot),c={};c.parents=a.selection.arcs.arc.path.filter(function(a){return b.indexOf(a)>=0}).on("mouseover.updateTooltip",a.arcMouseover.parents),a.x.domain([a.currentRoot.x,a.currentRoot.x+a.currentRoot.dx]),a.y.parents.domain(a.getZoomParentDomain(a.currentRoot)),a.y.children.domain(a.getZoomChildDomain(a.currentRoot));c.parents.each(function(b){this.newArc={start:a.x(b.x),end:a.x(b.x+b.dx),inner:a.y.parents(b.y),outer:a.y.parents(b.y+b.dy)},this.oldArc||(this.oldArc={start:this.newArc.start,end:this.newArc.start,inner:this.newArc.inner,outer:this.newArc.outer})}),c.children=a.selection.arcs.arc.path.filter(function(a){return b.indexOf(a)<0}).on("mouseover.updateTooltip",a.arcMouseover.children),c.children.each(function(b){this.newArc={start:a.x(b.x),end:a.x(b.x+b.dx),inner:a.y.children(b.y),outer:a.y.children(b.y+b.dy)},this.oldArc||(this.oldArc={start:this.newArc.start,end:this.newArc.start,inner:this.newArc.inner,outer:this.newArc.outer})}),a.selection.arcs.arc.exit().transition().duration(1.5*a.animationDuration).style("opacity",0).remove().select("path").each(function(){this.newArc={start:this.oldArc.start,end:this.oldArc.start,inner:this.oldArc.inner,outer:this.oldArc.outer}}).call(d2b.UTILS.TWEENS.arcTween,a.arc);var d=a.selection.arcs.arc.path.transition().duration(1.5*a.animationDuration).call(d2b.UTILS.TWEENS.arcTween,a.arc);d.each("end",function(){this.oldArc=this.newArc})},a.setupNewData=function(){var b;a.newData=!1,b=a.controlsData.sort.enabled?d3.layout.partition().value(function(a){return a.size}):d3.layout.partition().value(function(a){return a.size}).sort(function(a,b){return a.index-b.index}),a.partitionData=b.nodes(a.currentChartData.partition);var c=a.partitionData.filter(function(a){return a.top});a.legendData=a.controlsData.hideLegend.enabled?{data:{items:[]}}:{data:{items:d3.set(c.map(function(a){return a.name})).values().map(function(a){return{label:a}})}}},a.resetBreadcrumbs=function(){var b={data:{items:[]}};a.breadcrumbs.data(b).update()},a.saveIndicies=function(b){b.children&&b.children.forEach(function(b,c){b.index=c,a.saveIndicies(b)})},a.updateBreadcrumbs=function(b){var c={data:{items:b.map(function(a,b){return{label:a.name,key:b+","+a.name,data:a}})}};a.breadcrumbs.data(c).update();var d=a.breadcrumbs.selection();d.breadcrumb.path.attr("stroke-width",2).attr("stroke",function(b){return a.arcFill(b.data)})};var b={};return b.select=d2b.UTILS.CHARTS.MEMBERS.select(b,a,function(){a.generateRequired=!0}),b.selection=d2b.UTILS.CHARTS.MEMBERS.prop(b,a,"selection",function(){a.generateRequired=!0}),b.width=d2b.UTILS.CHARTS.MEMBERS.prop(b,a,"width"),b.height=d2b.UTILS.CHARTS.MEMBERS.prop(b,a,"height"),b.animationDuration=d2b.UTILS.CHARTS.MEMBERS.prop(b,a,"animationDuration",function(){a.legend.animationDuration(a.animationDuration),a.controls.animationDuration(a.animationDuration)}),b.legendOrientation=d2b.UTILS.CHARTS.MEMBERS.prop(b,a,"legendOrientation"),b.xFormat=d2b.UTILS.CHARTS.MEMBERS.format(b,a,"xFormat"),b.controls=d2b.UTILS.CHARTS.MEMBERS.controls(b,a),b.on=d2b.UTILS.CHARTS.MEMBERS.on(b,a),b.data=function(c,d){return arguments.length?(d&&(a.currentChartData={},a.generateRequired=!0),a.newData=!0,a.currentChartData=c.data,a.saveIndicies(a.currentChartData.partition),a.currentRoot=a.currentChartData.partition,b):a.currentChartData},b.generate=function(c){a.generateRequired=!1,d2b.UTILS.CHARTS.HELPERS.generateDefaultSVG(a),a.selection.main=a.selection.group.append("g").attr("class","d2b-sunburst").on("mouseout.d2b-mouseout",a.sunburstMouseout),a.selection.arcs=a.selection.main.append("g").attr("class","d2b-sunburst-arcs"),a.selection.tooltip=a.selection.main.append("g").attr("class","d2b-sunburst-tooltip"),a.selection.tooltip.text=a.selection.tooltip.append("text"),a.selection.breadcrumbs=a.selection.group.append("g").attr("class","d2b-sunburst-breadcrumbs"),a.controls.selection(a.selection.controls).on("change",function(c){a.controlsData[c.key].enabled=c.state,("sort"==c.key||"hideLegend"==c.key)&&(a.newData=!0),b.update()}),a.legend.color(a.color).selection(a.selection.legend),a.breadcrumbs.selection(a.selection.breadcrumbs);var d=a.animationDuration;return b.animationDuration(0).update(c).animationDuration(d),b},b.update=function(c){if(a.generateRequired)return b.generate(c);a.newData&&a.setupNewData(),a.forcedMargin=d2b.CONSTANTS.DEFAULTFORCEDMARGIN(),a.outerWidth=a.width,a.outerHeight=a.height,a.selection.svg.attr("width",a.width).attr("height",a.height),d2b.UTILS.CHARTS.HELPERS.updateDimensions(a),d2b.UTILS.CHARTS.HELPERS.updateControls(a),a.selection.breadcrumbs.transition().duration(a.animationDuration).attr("transform","translate("+a.forcedMargin.left+","+a.forcedMargin.top+")"),a.selection.controls.transition().duration(a.animationDuration).attr("transform","translate("+(a.forcedMargin.left+a.innerWidth-a.controls.computedWidth())+","+a.forcedMargin.top+")"),a.breadcrumbs.width(a.innerWidth).update(),a.forcedMargin.top+=a.breadcrumbs.computedHeight(),d2b.UTILS.CHARTS.HELPERS.updateLegend(a),a.selection.main.transition().duration(a.animationDuration).attr("transform","translate("+(a.forcedMargin.left+a.innerWidth/2)+","+(a.forcedMargin.top+a.innerHeight/2)+")"),a.radius.outer=Math.min(a.innerWidth,a.innerHeight)/2-20,a.radius.inner=a.radius.outer/3,a.controlsData.invert.enabled?(a.y.children.range([a.radius.outer-.17*(a.radius.outer-a.radius.inner),a.radius.inner]),a.y.parents.range([a.radius.outer,a.radius.outer-.13*(a.radius.outer-a.radius.inner)])):(a.y.children.range([a.radius.inner+.17*(a.radius.outer-a.radius.inner),a.radius.outer]),a.y.parents.range([a.radius.inner,a.radius.inner+.13*(a.radius.outer-a.radius.inner)])),a.selection.arcs.arc=a.selection.arcs.selectAll("g.sunburst-arc").data(a.partitionData,function(b){return"unique"==b.key?Math.floor(65536*(1+Math.random())):b.key&&"auto"!=b.key?b.key:a.getAncestors(b).map(function(a){return a.name}).join("-")});{var d=a.selection.arcs.arc.enter().append("g").attr("class","sunburst-arc").style("opacity",0).call(d2b.UTILS.bindElementEvents,a,"arc");d.append("path").on("mouseover.d2b-mouseover",a.arcMouseover)}return a.selection.arcs.arc.transition().duration(a.animationDuration).style("opacity",1),a.selection.arcs.arc.path=a.selection.arcs.arc.select("path").style("fill",a.arcFill),a.selection.arcs.arc.path.on("click.d2b-click",a.arcClick).classed("d2b-pointer-element",!0),a.updateArcs(),a.resetSunburstTooltip(),d3.timer.flush(),c&&c(),b},b},d2b.CHARTS.bubbleChart=function(){var a=d2b.CONSTANTS.DEFAULTWIDTH(),b=d2b.CONSTANTS.DEFAULTHEIGHT(),c=b-55,d=b,e=a,f=!0,g=d3.select("body"),h=d2b.CONSTANTS.ANIMATIONLENGTHS().normal,i=d2b.CONSTANTS.DEFAULTFORCEDMARGIN(),j=new d2b.UTILS.LEGENDS.legend,k=new d2b.UTILS.CONTROLS.controls,l="right",m=d2b.CONSTANTS.DEFAULTCOLOR(),n={},o=function(a){return a},p={grouping:null,colorGrouping:null},q=250,r=d3.scale.linear(),s=d3.scale.threshold().domain([-.25,-.05,-.001,.001,.05,.25]).range(["#d84b2a","#ee9586","#e4b7b2","#888","#beccae","#9caf84","#7aa25c"]),t=d3.scale.ordinal().domain([-1,-.25,-.05,0,.05,.25,1]).rangeBands([0,q]),u=d3.scale.linear().domain([-.25,.25]),v=d3.scale.ordinal(),w={x:d3.scale.ordinal(),y:d3.scale.ordinal(),fontSize:d3.scale.linear().range([10,30]).domain([0,500])},x=0,y=d3.format("%"),z=d3.svg.axis().orient("top").tickFormat(function(a){if(a>.25||-.25>a)return"";if(B.sortByChange.enabled){if(.25==a)return y(a)+" or higher";if(a==-.25)return y(a)+" or lower"}return y(a)}),A=d3.svg.axis().scale(v).orient("left"),B={hideLegend:{label:"Hide Legend",type:"checkbox",visible:!1,enabled:!1},sortByChange:{label:"Sort By Change",type:"checkbox",visible:!1,enabled:!1},colorByChange:{label:"Color By Change",type:"checkbox",visible:!1,enabled:!1}},C={elementMouseover:function(){},elementMouseout:function(){},elementClick:function(){}},D=function(a){var b=.095*a.alpha;this.nodeElements.each(function(a){a.group&&(a.y+=(a.group.focus.y-a.y)*b,a.x+=(a.group.focus.x-a.x)*b)})},E=function(a,b){b||(b="grouping"),n.nodes.forEach(function(c){c[b]=a})},F=function(){n.nodes.forEach(function(a){a.group=p.grouping.groups[a.enrollments[a.grouping.index]]})},G=function(a){r.range([0,Math.min(d,e)/4]).domain([0,Math.sqrt(a.total/Math.PI)])},H=function(a){return Math.max(3,r(Math.sqrt(a/Math.PI)))},I=function(){g.buttonsWrapper.buttons.button=g.buttonsWrapper.buttons.selectAll("ul").data(n.groupings,function(a){return"unique"==a.key?Math.floor(65536*(1+Math.random())):a.key&&"auto"!=a.key?a.key:a.label});var a=g.buttonsWrapper.buttons.button.enter().append("ul");a.append("li").attr("class","d2b-button").on("click.d2b-click",function(a,b){p.grouping=a,E(a),F(),S.update();for(key in C.elementClick)C.elementClick[key].call(this,a,b,"grouping-button")}).on("mouseover.d2b-mouseover",function(a,b){for(key in C.elementMouseover)C.elementMouseover[key].call(this,a,b,"grouping-button")}).on("mouseout.d2b-mouseout",function(a,b){for(key in C.elementMouseout)C.elementMouseout[key].call(this,a,b,"grouping-button")}),a.append("li").attr("class","d2b-color-button").on("click.d2b-click",function(a,b){p.colorGrouping=a,E(a,"colorGrouping"),S.update();for(key in C.elementClick)C.elementClick[key].call(this,a,b,"color-by-grouping-button")}).on("mouseover.d2b-mouseover",function(a,b){for(key in C.elementMouseover)C.elementMouseover[key].call(this,a,b,"color-by-grouping-button")}).on("mouseout.d2b-mouseout",function(a,b){for(key in C.elementMouseout)C.elementMouseout[key].call(this,a,b,"color-by-grouping-button")}),g.buttonsWrapper.buttons.button.exit().transition().duration(h).style("opacity",0).remove(),g.buttonsWrapper.buttons.button.grouping=g.buttonsWrapper.buttons.button.select("li.d2b-button").text(function(a){return a.label}).classed("d2b-selected",function(a){return a==p.grouping}),g.buttonsWrapper.buttons.button.color=g.buttonsWrapper.buttons.button.select("li.d2b-color-button").html('<i class="fa fa-paint-brush"></i>').classed("d2b-selected",function(a){return a==p.colorGrouping})},J=function(){var a=d2b.UTILS.getValues(B).filter(function(a){return a.visible});a.map(function(a){a.data={state:a.enabled,label:a.label,key:a.key}}),k.data(a).width(e).update(),g.controls.transition().duration(h).attr("transform","translate("+(i.left+e-k.computedWidth())+","+i.top+")")},K=function(){var a;a=B.hideLegend.enabled?{data:{items:[]}}:B.colorByChange.enabled?{data:{items:[]}}:p.colorGrouping.hideLegend?{data:{items:[]}}:{data:{items:d3.set(p.grouping.nodes.map(function(a){return a.enrollments[a.colorGrouping.index]})).values().map(function(a){return"null"==a?{label:"Non-"+p.colorGrouping.label}:{label:a}})}},d=c-i.top-i.bottom,"right"==l||"left"==l?j.orientation("vertical").data(a).height(d).update():j.orientation("horizontal").data(a).width(e).update();var b;b="right"==l?"translate("+(i.left+e-j.computedWidth())+","+((d-j.computedHeight())/2+i.top)+")":"left"==l?"translate("+i.left+","+((d-j.computedHeight())/2+i.top)+")":"top"==l?"translate("+(i.left+(e-j.computedWidth())/2)+","+i.top+")":"translate("+(i.left+(e-j.computedWidth())/2)+","+(d+i.top-j.computedHeight())+")",g.legend.transition().duration(h).attr("transform",b)},L=function(){(B.sortByChange.enabled||B.colorByChange.enabled)&&g.changeAxis.transition().duration(h).style("opacity",1),(B.sortByChange.enabled||!B.colorByChange.enabled)&&g.changeAxis.legend.transition().duration(h).style("opacity",0),B.sortByChange.enabled?g.group.groups.transition().duration(h).style("opacity",0):(R(),g.group.groups.transition().duration(h).style("opacity",1)),B.colorByChange.enabled?g.buttonsWrapper.buttons.button.color.style("display","none"):g.buttonsWrapper.buttons.button.color.style("display","block"),x=0,B.sortByChange.enabled?(v.domain(Object.keys(p.grouping.groups)).rangeBands([0,d-60]),g.groupsAxis.call(A),g.groupsAxis.selectAll(".tick text").each(function(){x<this.getComputedTextLength()&&(x=this.getComputedTextLength())}),A.tickSize(-e+i.left+x),g.groupsAxis.transition().duration(h).call(A).style("opacity",1).attr("transform","translate("+(i.left+x-20)+","+(i.top+60)+")"),u.range([0,e-80-x]),z.tickSize(-d+30).scale(u),g.changeAxis.transition().duration(h).style("opacity",1).attr("transform","translate("+(i.left+30+x)+","+(20+i.top+k.computedHeight())+")"),g.changeAxis.axis.transition().duration(h).call(z)):B.colorByChange.enabled?(g.groupsAxis.transition().duration(h).style("opacity",0),g.changeAxis.legend.transition().delay(h/4).duration(h).style("opacity",1),z.tickSize(15).scale(t),g.changeAxis.transition().duration(h).style("opacity",1).attr("transform","translate("+(a-q-20)+","+(20+i.top+k.computedHeight())+")"),g.changeAxis.axis.transition().duration(h).call(z)):(g.changeAxis.transition().duration(h).style("opacity",0),g.groupsAxis.transition().duration(h).style("opacity",0))},M=function(a,b){var c="";isNaN(a.change)||(a.change>=0?c="(+"+y(a.change)+")":a.change<0&&(c="("+y(a.change)+")")),d2b.UTILS.createGeneralTooltip(d3.select(this),"<b>"+a.label+"</b>",o(a.value)+" "+c);for(key in C.elementMouseover)C.elementMouseover[key].call(this,a,b,"bubble")},N=function(a,b){d2b.UTILS.removeTooltip();for(key in C.elementMouseout)C.elementMouseout[key].call(this,a,b,"bubble")},O=function(a,b){d2b.UTILS.removeTooltip();for(key in C.elementClick)C.elementClick[key].call(this,a,b,"bubble")},P=function(a,b,c){var d=0,e=!1,f=!1,g={next:function(){return e&&f&&c?c():void(a>d?(d++,b(g)):(e=!0,c&&c()))},iteration:function(){return d-1},"break":function(a){e=!0,f=a}};return g.next(),g},Q=function(){g.group.bubbles.bubble=g.group.bubbles.selectAll("g.d2b-bubble").data(p.grouping.nodes.sort(function(a,b){return d3.ascending(b.value,a.value)}),function(a){return"unique"==a.key?Math.floor(65536*(1+Math.random())):a.key&&"auto"!=a.key?a.key:a.label});var a=g.group.bubbles.bubble.enter().append("g").attr("class","d2b-bubble").on("mouseover.d2b-mouseover",M).on("mouseout.d2b-mouseout",N).on("click.d2b-click",O);a.append("circle").style("fill",function(a){return m(a.enrollments[a.colorGrouping.index])}).style("stroke",function(a){return m(a.enrollments[a.colorGrouping.index])}).attr("r",0),g.group.bubbles.bubble.circle=g.group.bubbles.bubble.select("circle");var b=g.group.bubbles.bubble.circle.transition().duration(h).attr("r",function(a){return H(a.value)});if(p.groups&&p.groups.forEach(function(a){a.nodeElements=g.group.bubbles.bubble.filter(function(b){return b.group==a&&b.enrollments[p.grouping.index]})}),B.colorByChange.enabled?b.style("fill",function(a){return s(a.change)}).style("stroke",function(a){return d3.rgb(s(a.change)).darker(1)}):b.style("fill",function(a){return m(a.enrollments[a.colorGrouping.index]?a.enrollments[a.colorGrouping.index]:"Non-"+p.colorGrouping.label)}).style("stroke",function(a){return a.enrollments[a.colorGrouping.index]?d3.rgb(m(a.enrollments[a.colorGrouping.index])).darker(1):d3.rgb(m("Non-"+p.colorGrouping.label)).darker(1)}),B.sortByChange.enabled){var c=u.range();g.group.bubbles.bubble.transition().duration(1.5*h).each(function(a){a.x=20+Math.min(c[1],Math.max(c[0],u(a.change)))+(x+10)+i.left,a.y=v(a.enrollments[a.grouping.index])+v.rangeBand()/2+60+i.top}).attr("transform",function(a){return"translate("+a.x+","+a.y+")"})}else p.groups.forEach(function(a){a.force.size([e,d]).start(),P(300,function(b){a.force.alpha()<.025&&b["break"](!0);b.iteration();a.force.tick(),b.next()},function(){a.force.stop(),a.nodeElements.transition().duration(1.5*h).attr("transform",function(a){return"translate("+a.x+","+a.y+")"})})});a.size()&&g.group.bubbles.bubble.size()>a.size()&&g.group.bubbles.bubble.each(function(){g.group.bubbles.node().appendChild(this)}),g.group.bubbles.bubble.exit().transition().duration(h).style("opacity",0).attr("transform",function(){return"translate(0,0)"}).remove().select("circle").attr("r",0)},R=function(){p.groups=[];for(key in p.grouping.groups)p.groups.push(p.grouping.groups[key]);var a=e/d,b=Math.min(p.groups.length,Math.max(1,Math.round(Math.sqrt(p.groups.length)*a))),c=Math.ceil(p.groups.length/b);g.group.groups.group=g.group.groups.selectAll("g").data(p.groups),w.x.domain(d3.range(0,b)).rangeBands([0,e]),w.y.domain(d3.range(0,c)).rangeBands([0,d-100]);var f=g.group.groups.group.enter().append("g").style("opacity",0);f.append("text").attr("class","d2b-group-title"),f.append("text").attr("class","d2b-group-total"),g.group.groups.group.each(function(a,c){a.total=d3.sum(a.nodes.map(function(a){return a.value})),a.focus={x:w.x(c%b)+w.x.rangeBand()/2,y:w.y(Math.floor(c/b))+100+w.y.rangeBand()/2},a.force||(a.force=d3.layout.force().links([]).gravity(0).friction(.9).charge(function(a){return-Math.pow(H(a.value),2)/9}).nodes(a.nodes).on("tick",D.bind(a))),a.force.stop()}).transition().duration(h).attr("transform",function(a,c){return"translate("+(w.x(c%b)+w.x.rangeBand()/2)+","+(w.y(Math.floor(c/b))+100)+")"}).style("opacity",1),g.group.groups.selectAll(".focus").remove();var i=Math.min(30,Math.max(8,w.fontSize((e+d)/p.groups.length)));g.group.groups.group.total=g.group.groups.group.select("text.d2b-group-total").text(function(a){return o(a.total)}).style("font-size",i+"px"),g.group.groups.group.each(function(){}),g.group.groups.group.title=g.group.groups.group.select("text.d2b-group-title").text(function(a){return a.label}).attr("dy",0).attr("y",i).style("font-size",i+"px").call(d2b.UTILS.textWrap,w.x.rangeBand()-10),g.group.groups.group.exit().transition().duration(h).style("opacity",0).remove()},S={};return S.select=function(a){return g=d3.select(a),f=!0,S},S.selection=function(a){return arguments.length?(g=a,f=!0,S):g},S.width=function(b){return arguments.length?(a=b,S):a},S.height=function(a){return arguments.length?(b=a,c=b-55,S):b},S.animationDuration=function(a){return arguments.length?(h=a,j.animationDuration(h),S):h},S.xFormat=function(a){return arguments.length?(o=d2b.UTILS.numberFormat(a),S):o},S.legendOrientation=function(a){return arguments.length?(l=a,S):l},S.controls=function(a){return arguments.length?(a.hideLegend&&(B.hideLegend.visible=null!=a.hideLegend.visible?a.hideLegend.visible:B.hideLegend.visible,B.hideLegend.enabled=null!=a.hideLegend.enabled?a.hideLegend.enabled:B.hideLegend.enabled),a.sortByChange&&(B.sortByChange.visible=null!=a.sortByChange.visible?a.sortByChange.visible:B.sortByChange.visible,B.sortByChange.enabled=null!=a.sortByChange.enabled?a.sortByChange.enabled:B.sortByChange.enabled),a.colorByChange&&(B.colorByChange.visible=null!=a.colorByChange.visible?a.colorByChange.visible:B.colorByChange.visible,B.colorByChange.enabled=null!=a.colorByChange.enabled?a.colorByChange.enabled:B.colorByChange.enabled),S):B},S.on=function(a,b){return a=a.split("."),arguments.length?1==arguments.length?a[1]?C[a[0]][a[1]]:C[a[0]]["default"]:(a[1]?C[a[0]][a[1]]=b:C[a[0]]["default"]=b,S):C},S.data=function(a,b){if(!arguments.length)return n;b&&(n={},f=!0),n=a.data,n.nodes=n.nodes.filter(function(a){return a.value>0}),n.groupings.forEach(function(a,b){a.index=b,a.nodes=n.nodes.filter(function(a){return a.enrollments[b]}),a.groups={},a.total=0,a.nodes.forEach(function(c){a.total+=c.value,a.groups[c.enrollments[b]]||(a.groups[c.enrollments[b]]={nodes:[],label:c.enrollments[b]}),a.groups[c.enrollments[b]].nodes.push(c)})});var c=p.grouping;return p.grouping=n.groupings[0],c&&n.groupings.forEach(function(a){c.label==a.label&&(p.grouping=a)}),E(p.grouping),F(),c=p.colorGrouping,p.colorGrouping=n.groupings.filter(function(a){return a.default_color_grouping})[0],c?n.groupings.forEach(function(a){c.label==a.label&&(p.colorGrouping=a)}):p.colorGrouping||(p.colorGrouping=n.groupings[0]),E(p.colorGrouping,"colorGrouping"),S},S.generate=function(a){f=!1,g.selectAll("*").remove(),g.buttonsWrapper=g.append("div").attr("class","d2b-bubble-chart-buttons-wrapper"),g.buttonsWrapper.buttons=g.buttonsWrapper.append("ul").attr("class","d2b-buttons"),g.svg=g.append("svg").attr("class","d2b-bubble-chart d2b-svg d2b-container"),g.group=g.svg.append("g"),g.group.bubbles=g.group.append("g").attr("class","d2b-bubbles"),g.changeAxis=g.group.append("g").attr("class","d2b-change-axis-legend"),g.changeAxis.legend=g.changeAxis.append("g"),g.changeAxis.axis=g.changeAxis.append("g"),g.group.groups=g.group.append("g").attr("class","d2b-groups"),g.groupsAxis=g.group.append("g").attr("class","d2b-groups-axis"),g.changeAxis.legend.rect=g.changeAxis.legend.selectAll("rect").data([-.25,-.05,0,.05,.25,1]),g.changeAxis.legend.rect.enter().append("rect").style("fill",function(a){return s(a-.01)}).attr("x",function(a){return t(a)-t.rangeBand()/2}).attr("width",t.rangeBand()).attr("height",10).attr("y",-15),g.legend=g.group.append("g").attr("class","d2b-legend"),g.controls=g.group.append("g").attr("class","d2b-controls"),k.selection(g.controls).on("change",function(a){B[a.key].enabled=a.state,("sort"==a.key||"hideLegend"==a.key)&&(newData=!0),S.update()}),j.color(m).selection(g.legend);var b=h;return S.animationDuration(0).update(a).animationDuration(b),S},S.update=function(b){return f?S.generate(b):(g.svg.attr("width",a).attr("height",c),I(),i=d2b.CONSTANTS.DEFAULTFORCEDMARGIN(),e=a-i.right-i.left,J(),i.top+=k.computedHeight()+10,K(),i[l]+="right"==l||"left"==l?j.computedWidth():j.computedHeight(),d=c-i.top-i.bottom,e=a-i.left-i.right,L(),G(p.grouping),Q(),d3.timer.flush(),b&&b(),S)},S},d2b.CHARTS.axisChart=function(){var a={};a.width=d2b.CONSTANTS.DEFAULTWIDTH(),a.height=d2b.CONSTANTS.DEFAULTHEIGHT(),a.innerHeight=a.height,a.innerWidth=a.width,a.outerHeight=a.height,a.outerWidth=a.width,a.forcedMargin=d2b.CONSTANTS.DEFAULTFORCEDMARGIN(),a.generateRequired=!0,a.selection=d3.select("body"),a.animationDuration=d2b.CONSTANTS.ANIMATIONLENGTHS().normal,a.color=d2b.CONSTANTS.DEFAULTCOLOR(),a.currentChartData={types:[],labels:{}},a.xFormat=function(a){return a},a.yFormat=function(a){return a},a.on=d2b.CONSTANTS.DEFAULTEVENTS(),a.legend=new d2b.UTILS.LEGENDS.legend,a.legendOrientation="bottom",a.legendData={data:{items:[]}},a.controls=new d2b.UTILS.CONTROLS.controls,a.rotate=!1,a.controlsData={hideLegend:{label:"Hide Legend",type:"checkbox",visible:!1,enabled:!1},lockYAxis:{label:"Lock Y-Axis",type:"checkbox",visible:!1,enabled:!1},lockXAxis:{label:"Lock X-Axis",type:"checkbox",visible:!1,enabled:!1}},a.orientationMap={x:"x",y:"y"};for(type in d2b.UTILS.AXISCHART.TYPES)if(d2b.UTILS.AXISCHART.TYPES[type].tools){var b=d2b.UTILS.AXISCHART.TYPES[type].tools();if(b&&b.controlsData)for(control in b.controlsData)a.controlsData[control]=b.controlsData[control]}a.xAlias={scale:d3.scale.linear(),axis:d3.svg.axis(),type:"quantitative,linear",orientation:"bottom",domain:[0,1],hide:!1,tickData:{}},a.xAlias.axis.scale(a.xAlias.scale).orient(a.xAlias.orientation),a.yAlias={scale:d3.scale.linear(),axis:d3.svg.axis(),type:"quantitative,linear",orientation:"left",domain:[0,1],hide:!1,tickData:{}},a.yAlias.axis.scale(a.yAlias.scale).orient(a.yAlias.orientation),a.x=a.xAlias,a.y=a.yAlias,a.persistentChartData={},a.padQuantitativeDomain=function(a){var b=a[1]-a[0],c=.15;return[0==a[0]?0:a[0]-b*c,a[1]+b*c]},a.updateDomains=function(){var b=a.xAlias.type.split(",")[0],c=[],d=[];if(a.selection.types.background.type.each(function(b){this.adType.data(b.graphs.filter(function(b){return!a.persistentChartData[b.type][b.label].hide})),this.adType.xValues&&(c=c.concat(this.adType.xValues())),this.adType.yValues&&(d=d.concat(this.adType.yValues()))}),0==c.length?c=[0,1]:1==c.length&&"quantitative"==b&&(c=[c[0]/2,1.5*c[0]]),a.controlsData.lockXAxis.enabled)a.xAlias.scale.domain(a.xAlias.domain);else switch(b){case"ordinal":a.xAlias.scale.domain(d3.set(c).values());break;case"quantitative":a.xAlias.scale.domain(a.padQuantitativeDomain(d3.extent(c)));
break;default:a.xAlias.scale.domain(d3.extent(c))}var e=a.yAlias.type.split(",")[0];if(0==d.length?d=[0,1]:1==d.length&&"quantitative"==e&&(d=[d[0]/2,1.5*d[0]]),a.controlsData.lockYAxis.enabled)a.yAlias.scale.domain(a.yAlias.domain);else switch(e){case"ordinal":a.yAlias.scale.domain(d3.set(d).values());break;case"quantitative":a.yAlias.scale.domain(a.padQuantitativeDomain(d3.extent(d)));break;default:a.yAlias.scale.domain(d3.extent(d))}},a.initGraphs=function(){a.selection.types.foreground.type=a.selection.types.foreground.selectAll("g.d2b-axis-type-foreground").data(a.currentChartData.types,function(a){return a.type}),a.selection.types.foreground.type.enter().append("g").attr("class",function(a){return"d2b-axis-type-foreground d2b-"+a.type}),a.selection.types.foreground.type.exit().transition().duration(a.animationDuration).style("opacity",0).remove(),a.selection.types.foreground.type.graph=a.selection.types.foreground.type.selectAll("g.d2b-axis-chart-foreground-graph").data(function(b){return b.graphs.filter(function(b){return!a.persistentChartData[b.type][b.label].hide})},function(a){return a.label}),a.selection.types.foreground.type.graph.enter().append("g").style("opacity",0).attr("class","d2b-axis-chart-foreground-graph").each(function(b){a.persistentChartData[b.type][b.label].foreground=d3.select(this)}),a.selection.types.foreground.type.graph.transition().duration(a.animationDuration).style("opacity",1),a.selection.types.foreground.type.graph.exit().each(function(b){a.persistentChartData[b.type][b.label].foreground=null}).transition().duration(a.animationDuration).style("opacity",0).remove(),a.selection.types.background.type=a.selection.types.background.selectAll("g.d2b-axis-type-background").data(a.currentChartData.types,function(a){return a.type}),a.selection.types.background.type.enter().append("g").attr("class",function(a){return"d2b-axis-type-background d2b-"+a.type}).each(function(b){var d="axis-chart-";this.adType=new d2b.UTILS.AXISCHART.TYPES[b.type](b.type),this.adType.on("elementClick.d2b-click",function(b,c,e){for(key in a.on.elementClick)a.on.elementClick[key].call(this,b,c,d+e)}).on("elementMouseover.d2b-mouseover",function(b,c,e){for(key in a.on.elementMouseover)a.on.elementMouseover[key].call(this,b,c,d+e)}).on("elementMouseout.d2b-mouseout",function(b,c,e){for(key in a.on.elementMouseout)a.on.elementMouseout[key].call(this,b,c,d+e)}).x(a.xAlias).y(a.yAlias).color(a.color).axisChart(c).xFormat(a.xFormat).yFormat(a.yFormat).controls(a.controlsData)}),a.selection.types.background.type.exit().transition().duration(a.animationDuration).style("opacity",0).remove(),a.selection.types.background.type.graph=a.selection.types.background.type.selectAll("g.d2b-axis-chart-background-graph").data(function(b){return b.graphs.filter(function(b){return!a.persistentChartData[b.type][b.label].hide})},function(a){return a.label}),a.selection.types.background.type.graph.enter().append("g").attr("class","d2b-axis-chart-background-graph").style("opacity",0).each(function(b){a.persistentChartData[b.type][b.label].background=d3.select(this)}),a.selection.types.background.type.graph.transition().duration(a.animationDuration).style("opacity",1),a.selection.types.background.type.graph.exit().each(function(b){a.persistentChartData[b.type][b.label].background=null}).transition().duration(a.animationDuration).style("opacity",0).remove(),a.selection.types.foreground.type.each(function(a){var b=d3.select(this),c=b.selectAll(".d2b-axis-chart-foreground-graph");a.foregroundGraphs=c})},a.updateCustomScales=function(){a.x.customScale=function(b,c){var d=0;return d=a.rotate?a.innerWidth-a.x.scale(b):a.x.scale(b),"ordinal"==a.x.type&&(d+=a.x.scale.rangeBand()/2),c&&(d=a.innerWidth-d),d},a.y.customScale=function(b,c){var d=0;return d=a.y.scale(b),"ordinal"==a.y.type&&(d+=a.y.scale.rangeBand()/2),c&&(d=a.innerHeight-d),d},a.yAlias.customBarScale=function(b){var c={y:0,height:0};return c.origin=a.yAlias.customScale(0),c.destination=a.yAlias.customScale(b),c.sHeight=c.origin-c.destination,c.y=Math.min(a.yAlias.customScale(0),c.destination),c.height=Math.abs(c.sHeight),c}},a.updateGraphs=function(){a.updateCustomScales(),a.selection.types.background.type.each(function(b){var c=d3.select(this),d=c.selectAll(".d2b-axis-chart-background-graph");b.backgroundGraphs=d.filter(function(b){return!a.persistentChartData[b.type][b.label].hide}),this.adType.animationDuration(a.animationDuration).width(a.innerWidth).height(a.innerHeight).foreground(b.foregroundGraphs).background(b.backgroundGraphs).data(b.graphs.filter(function(b){return!a.persistentChartData[b.type][b.label].hide})).update()}),a.selection.types.background.type.exit().transition().duration(a.animationDuration).style("opacity",0).remove()},a.axisModifier=function(a,b){b?(a("x",b.x),a("y",b.y)):(a("x"),a("y"))},a.updateAxis=function(){var b=10,d={};a.axisModifier(function(c,e){d[c]=a.selection.axes[c].label.transition().duration(a.animationDuration),a.currentChartData.labels[c]&&!a[c].hide?(a.forcedMargin[a[c].orientation]+=b,a[e.dimension]-=b,d[c].style("opacity",1),a.selection.axes[c].label.text.text(a[c].label)):(d[c].style("opacity",0),a.selection.axes[c].label.text.text(""))},{x:{dimension:"innerHeight"},y:{dimension:"innerWidth"}});var e={};a.axisModifier(function(b){e[b]=a.selection.axes[b].transition().duration(a.animationDuration)});var f={};a.axisModifier(function(b){f[b]=a.selection.grid[b].transition().duration(a.animationDuration)});var g=0;a.selection.axes.y.text=a.selection.axes.y.selectAll(".tick text").each(function(){var a=this.getComputedTextLength();g=Math.max(g,a)}).on("click.d2b-element-click",function(b,c){var d={label:b};for(var e in a.y.tickData[b])d[e]=a.y.tickData[b][e];for(e in a.on.elementClick)a.on.elementClick[e].call(this,d,c,"axis-tick")}).on("mouseover.d2b-element-mouseover",function(b,c){var d={label:b};for(var e in a.y.tickData[b])d[e]=a.y.tickData[b][e];for(e in a.on.elementMouseover)a.on.elementMouseover[e].call(this,d,c,"axis-tick")}).on("mouseout.d2b-element-mouseout",function(b,c){var d={label:b};for(var e in a.y.tickData[b])d[e]=a.y.tickData[b][e];for(e in a.on.elementMouseout)a.on.elementMouseout[e].call(this,d,c,"axis-tick")}),a.selection.axes.x.text=a.selection.axes.x.selectAll("text").on("click.d2b-element-click",function(b,c){var d={label:b};for(var e in a.x.tickData[b])d[e]=a.x.tickData[b][e];for(e in a.on.elementClick)a.on.elementClick[e].call(this,d,c,"axis-tick")}).on("mouseover.d2b-element-mouseover",function(b,c){var d={label:b};for(var e in a.x.tickData[b])d[e]=a.x.tickData[b][e];for(e in a.on.elementMouseover)a.on.elementMouseover[e].call(this,d,c,"axis-tick")}).on("mouseout.d2b-element-mouseout",function(b,c){var d={label:b};for(var e in a.x.tickData[b])d[e]=a.x.tickData[b][e];for(e in a.on.elementMouseout)a.on.elementMouseout[e].call(this,d,c,"axis-tick")});var h=10;a.axisModifier(function(b,c){a[b].hide?e[b].style("opacity",0):(e[b].style("opacity",1),a.forcedMargin[a[b].orientation]+=c.offset,a[c.dimension]-=c.offset)},{x:{offset:10+h,dimension:"innerHeight"},y:{offset:g+h,dimension:"innerWidth"}});var i="left"==a.y.orientation?-g-b-h-5:g+b+h+d.y.node().getBBox().width;d.y.attr("transform","translate("+i+","+a.innerHeight/2+")"),i="top"==a.x.orientation?1.5*-b-h:1*+b+h+d.x.node().getBBox().height,d.x.attr("transform","translate("+a.innerWidth/2+","+i+")");var j={};a.rotate?(j.x=a.x.invert?[a.innerWidth,0]:[0,a.innerWidth],j.y=a.y.invert?[a.innerHeight,0]:[0,a.innerHeight]):(j.x=a.x.invert?[a.innerWidth,0]:[0,a.innerWidth],j.y=a.y.invert?[0,a.innerHeight]:[a.innerHeight,0]),"ordinal"==a.x.type.split(",")[0]?(a.x.scale.rangeBands(j.x),a.x.rangeBand=.75*a.x.scale.rangeBand()):(a.x.scale.range(j.x),a.x.rangeBand=a.innerWidth/10),"ordinal"==a.y.type.split(",")[0]?(a.y.scale.rangeBands(j.y),a.y.rangeBand=.75*a.y.scale.rangeBand()):(a.y.scale.range(j.y),a.y.rangeBand=a.innerHeight/10),a.x.axis.tickSize(5),a.y.axis.tickSize(5),e.x.call(a.x.axis),"top"==a.x.orientation?e.x.attr("transform","translate("+a.forcedMargin.left+","+a.forcedMargin.top+")"):e.x.attr("transform","translate("+a.forcedMargin.left+","+(a.innerHeight+a.forcedMargin.top)+")"),e.y.call(a.y.axis).each("end",function(){setTimeout(function(){var b=0;a.selection.axes.y.selectAll(".tick text").each(function(){var a=this.getComputedTextLength();b=Math.max(b,a)}),g!=b&&c.update()},10)}),"left"==a.y.orientation?e.y.attr("transform","translate("+a.forcedMargin.left+","+a.forcedMargin.top+")"):e.y.attr("transform","translate("+(a.innerWidth+a.forcedMargin.left)+","+a.forcedMargin.top+")"),a.x.axis.tickSize(-a.innerHeight),a.y.axis.tickSize(-a.innerWidth),f.x.call(a.x.axis),"top"==a.x.orientation?f.x.attr("transform","translate("+a.forcedMargin.left+","+a.forcedMargin.top+")"):f.x.attr("transform","translate("+a.forcedMargin.left+","+(a.innerHeight+a.forcedMargin.top)+")"),f.y.call(a.y.axis),"left"==a.y.orientation?f.y.attr("transform","translate("+a.forcedMargin.left+","+a.forcedMargin.top+")"):f.y.attr("transform","translate("+(a.innerWidth+a.forcedMargin.left)+","+a.forcedMargin.top+")")};var c={};return c.select=d2b.UTILS.CHARTS.MEMBERS.select(c,a,function(){a.generateRequired=!0}),c.selection=d2b.UTILS.CHARTS.MEMBERS.prop(c,a,"selection",function(){a.generateRequired=!0}),c.width=d2b.UTILS.CHARTS.MEMBERS.prop(c,a,"width"),c.height=d2b.UTILS.CHARTS.MEMBERS.prop(c,a,"height"),c.animationDuration=d2b.UTILS.CHARTS.MEMBERS.prop(c,a,"animationDuration",function(){a.legend.animationDuration(a.animationDuration),a.controls.animationDuration(a.animationDuration)}),c.legendOrientation=d2b.UTILS.CHARTS.MEMBERS.prop(c,a,"legendOrientation"),c.xFormat=d2b.UTILS.CHARTS.MEMBERS.format(c,a,"xFormat",function(){a.xAlias.axis.tickFormat(a.xFormat)}),c.yFormat=d2b.UTILS.CHARTS.MEMBERS.format(c,a,"yFormat",function(){a.yAlias.axis.tickFormat(a.yFormat)}),c.controls=d2b.UTILS.CHARTS.MEMBERS.controls(c,a),c.on=d2b.UTILS.CHARTS.MEMBERS.on(c,a),c.rotate=function(b){return a.rotate=b,b?(a.orientationMap={x:"y",y:"x"},a.x=a.yAlias,a.y=a.xAlias):(a.orientationMap={x:"x",y:"y"},a.x=a.xAlias,a.y=a.yAlias),c},c.x=d2b.UTILS.CHARTS.MEMBERS.scale(c,a,"xAlias",function(b){b.orientation&&(a.xAlias.orientation=b.orientation),a.xAlias.axis.scale(a.xAlias.scale).orient(a.xAlias.orientation),b.tickData&&(a.xAlias.tickData=b.tickData)}),c.y=d2b.UTILS.CHARTS.MEMBERS.scale(c,a,"yAlias",function(b){b.orientation&&(a.yAlias.orientation=b.orientation),a.yAlias.axis.scale(a.yAlias.scale).orient(a.yAlias.orientation),b.tickData&&(a.yAlias.tickData=b.tickData)}),c.data=function(b,d){return arguments.length?(d&&(a.currentChartData={}),b.data.types&&(a.currentChartData.types=b.data.types,a.currentChartData.types.forEach(function(b){a.persistentChartData[b.type]||(a.persistentChartData[b.type]={}),b.graphs.forEach(function(c){a.persistentChartData[b.type][c.label]||(a.persistentChartData[b.type][c.label]={hide:!1})})})),b.data.labels&&(a.currentChartData.labels=b.data.labels,a.xAlias.label=a.currentChartData.labels.x,a.yAlias.label=a.currentChartData.labels.y),c):a.currentChartData},c.generate=function(b){a.generateRequired=!1,d2b.UTILS.CHARTS.HELPERS.generateDefaultSVG(a),a.legend.color(a.color).selection(a.selection.legend),a.controls.selection(a.selection.controls).on("change.d2b-change",function(b){a.controlsData[b.key].enabled=b.state,c.update()}),a.selection.main=a.selection.group.append("g").attr("class","d2b-axis-chart"),a.selection.axes=a.selection.main.append("g").attr("class","d2b-axes"),a.selection.axes.x=a.selection.axes.append("g").attr("class","d2b-axis d2b-x"),a.selection.axes.x.label=a.selection.axes.x.append("g").attr("class","d2b-label"),a.selection.axes.x.label.text=a.selection.axes.x.label.append("text"),a.selection.axes.y=a.selection.axes.append("g").attr("class","d2b-axis d2b-y"),a.selection.axes.y.label=a.selection.axes.y.append("g").attr("class","d2b-label"),a.selection.axes.y.label.text=a.selection.axes.y.label.append("text").attr("transform","rotate(-90)"),a.selection.grid=a.selection.main.append("g").attr("class","d2b-grid"),a.selection.grid.x=a.selection.grid.append("g").attr("class","d2b-grid d2b-x"),a.selection.grid.y=a.selection.grid.append("g").attr("class","d2b-grid d2b-y"),a.selection.types=a.selection.main.append("g").attr("class","d2b-axis-types"),a.selection.types.background=a.selection.types.append("g").attr("class","d2b-axis-types-background"),a.selection.types.foreground=a.selection.types.append("g").attr("class","d2b-axis-types-foreground");var d=function(){a.currentChartData.types.forEach(function(b){b.graphs.forEach(function(b){a.persistentChartData[b.type][b.label].hide=!1})})};a.legend.on("elementMouseover",function(b){var c=a.persistentChartData[b.type][b.label].background,d=a.persistentChartData[b.type][b.label].foreground;if(c&&d){var e=c.node(),f=d.node();e.parentNode&&(e.parentNode.appendChild(e),e.parentNode.parentNode&&e.parentNode.parentNode.appendChild(e.parentNode)),f.parentNode&&(f.parentNode.appendChild(f),f.parentNode.parentNode&&f.parentNode.parentNode.appendChild(f.parentNode)),a.selection.types.foreground.type.graph.transition().duration(a.animationDuration/2).style("opacity",.2),a.selection.types.background.type.graph.transition().duration(a.animationDuration/2).style("opacity",.2),c.transition().duration(a.animationDuration/2).style("opacity",1),d.transition().duration(a.animationDuration/2).style("opacity",1)}}).on("elementMouseout",function(){a.selection.types.foreground.type.graph.transition().duration(a.animationDuration/2).style("opacity",1),a.selection.types.background.type.graph.transition().duration(a.animationDuration/2).style("opacity",1)}).on("elementClick",function(b){a.persistentChartData[b.type][b.label].hide=!a.persistentChartData[b.type][b.label].hide;var e=!0;a.currentChartData.types.forEach(function(b){b.graphs.forEach(function(b){1!=e||a.persistentChartData[b.type][b.label].hide||(e=!1)})}),e&&d(),c.update()}).on("elementDblClick",function(){d(),c.update()});var e=a.animationDuration;return c.animationDuration(0).update(b).animationDuration(e),c},c.update=function(b){return a.generateRequired?c.generate(b):(a.forcedMargin=d2b.CONSTANTS.DEFAULTFORCEDMARGIN(),a.outerWidth=a.width,a.outerHeight=a.height,a.selection.svg.attr("width",a.width).attr("height",a.height),d2b.UTILS.CHARTS.HELPERS.updateDimensions(a),d2b.UTILS.CHARTS.HELPERS.updateControls(a),a.currentChartData.types.forEach(function(a){a.graphs.forEach(function(b){b.type=a.type})}),a.controlsData.hideLegend.enabled?a.legendData={data:{items:[]}}:a.legendData.data.items=[].concat.apply([],a.currentChartData.types.map(function(b){return b.graphs.map(function(c){return c.open=a.persistentChartData[b.type][c.label].hide,c})})),d2b.UTILS.CHARTS.HELPERS.updateLegend(a),!a.legend.computedHeight()||"left"!=a.legendOrientation&&"right"!=a.legendOrientation||(a.forcedMargin[a.legendOrientation]+=10),a.selection.main.transition().duration(a.animationDuration).attr("transform","translate("+a.forcedMargin.left+","+a.forcedMargin.top+")"),d2b.UTILS.CHARTS.HELPERS.updateDimensions(a),a.initGraphs(),a.updateDomains(),a.updateAxis(),a.selection.types.transition().duration(a.animationDuration).attr("transform","translate("+a.forcedMargin.left+","+a.forcedMargin.top+")"),a.rotate?(a.selection.types.background.transition().duration(a.animationDuration).attr("transform","translate("+a.innerWidth+", 0),rotate(90)"),a.selection.types.foreground.transition().duration(a.animationDuration).attr("transform","translate("+a.innerWidth+", 0),rotate(90)")):(a.selection.types.background.transition().duration(a.animationDuration).attr("transform",""),a.selection.types.foreground.transition().duration(a.animationDuration).attr("transform","")),a.updateGraphs(),d3.timer.flush(),b&&b(),c)},c},d2b.CHARTS.sankeyChart=function(){var a={};a.on=d2b.CONSTANTS.DEFAULTEVENTS();var b,c=d2b.CONSTANTS.DEFAULTWIDTH(),d=d2b.CONSTANTS.DEFAULTHEIGHT(),e=d,f=c,g=!0,h=d3.select("body"),i=d2b.CONSTANTS.ANIMATIONLENGTHS().normal,j=d2b.CONSTANTS.DEFAULTFORCEDMARGIN(),k=new d2b.UTILS.LEGENDS.legend,l=new d2b.UTILS.CONTROLS.controls,m="bottom",n=d2b.CONSTANTS.DEFAULTCOLOR(),o={nodes:[],links:[]},p=30,q=15,r=20,s=1,t={hideLegend:{label:"Hide Legend",type:"checkbox",visible:!1,enabled:!1}},u=function(a){return a},v={};return v.select=function(a){return h=d3.select(a),g=!0,v},v.selection=function(a){return arguments.length?(h=a,g=!0,v):h},v.width=function(a){return arguments.length?(c=a,v):c},v.height=function(a){return arguments.length?(d=a,v):d},v.animationDuration=function(a){return arguments.length?(i=a,k.animationDuration(i),v):i},v.xFormat=function(a){return arguments.length?(u=d2b.UTILS.numberFormat(a),v):u},v.legendOrientation=function(a){return arguments.length?(m=a,v):m},v.nodePadding=function(a){return arguments.length?(p=a,v):p},v.layout=function(a){return arguments.length?(r=a,v):r},v.controls=function(a){return arguments.length?(a.hideLegend&&(t.hideLegend.visible=null!=a.hideLegend.visible?a.hideLegend.visible:t.hideLegend.visible,t.hideLegend.enabled=null!=a.hideLegend.enabled?a.hideLegend.enabled:t.hideLegend.enabled),v):t},v.minLinkWidth=function(a){return arguments.length?(s=a,v):s},v.on=d2b.UTILS.CHARTS.MEMBERS.on(v,a),v.data=function(a,b){return arguments.length?(b&&(o={nodes:[],links:[]},g=!0),a.data.nodes&&(o.nodes=a.data.nodes),a.data.links&&(o.links=a.data.links),a.data.labels&&(o.labels=a.data.labels),a.data.columnHeaders&&(o.columnHeaders=a.data.columnHeaders),v):o},v.generate=function(a){g=!1,h.selectAll("*").remove(),h.svg=h.append("svg").attr("class","d2b-sankey-chart d2b-svg d2b-container"),h.group=h.svg.append("g"),h.group.sankey=h.group.append("g").attr("class","d2b-sankey"),h.group.sankey.links=h.group.sankey.append("g").attr("class","d2b-sankey-links"),h.group.sankey.nodes=h.group.sankey.append("g").attr("class","d2b-sankey-nodes"),h.group.labels=h.group.append("g").attr("class","d2b-sankey-labels"),h.group.labels.source=h.group.labels.append("g").attr("class","d2b-sankey-label-source"),h.group.labels.source.text=h.group.labels.source.append("text").attr("y",23),h.group.labels.destination=h.group.labels.append("g").attr("class","d2b-sankey-label-destination"),h.group.labels.destination.text=h.group.labels.destination.append("text").attr("y",23),h.group.columnHeaders=h.group.append("g").attr("class","d2b-sankey-column-headers"),h.controls=h.group.append("g").attr("class","d2b-controls"),l.selection(h.controls).on("change",function(a){t[a.key].enabled=a.state,("sort"==a.key||"hideLegend"==a.key)&&(newData=!0),v.update()}),h.legend=h.group.append("g").attr("class","d2b-legend"),k.color(n).selection(h.legend);var b=i;return v.animationDuration(0).update(a).animationDuration(b),v},v.update=function(w){if(g)return v.generate(w);j=d2b.CONSTANTS.DEFAULTFORCEDMARGIN(),f=c-j.right-j.left;var x=d2b.UTILS.getValues(t).filter(function(a){return a.visible});if(x.map(function(a){a.data={state:a.enabled,label:a.label,key:a.key}}),l.data(x).width(f).update(),h.controls.transition().duration(i).attr("transform","translate("+(j.left+f-l.computedWidth())+","+j.top+")"),j.top+=l.computedHeight(),e=d-j.top-j.bottom,t.hideLegend.enabled)var y={data:{items:[]}};else var y={data:{items:d3.set(o.nodes.map(function(a){return a.colorKey?a.colorKey:a.name})).values().map(function(a){return{label:a}})}};"right"==m||"left"==m?k.orientation("vertical").data(y).height(e).update():k.orientation("horizontal").data(y).width(f).update();var z;z="right"==m?"translate("+(j.left+f-k.computedWidth())+","+((e-k.computedHeight())/2+j.top)+")":"left"==m?"translate("+j.left+","+((e-k.computedHeight())/2+j.top)+")":"top"==m?"translate("+(j.left+(f-k.computedWidth())/2)+","+j.top+")":"translate("+(j.left+(f-k.computedWidth())/2)+","+(e+j.top-k.computedHeight())+")",h.legend.transition().duration(i).attr("transform",z),j[m]+="right"==m||"left"==m?k.computedWidth()+10:k.computedHeight(),e=d-j.top-j.bottom,f=c-j.left-j.right;var A={source:h.group.labels.source.transition().duration(i),destination:h.group.labels.destination.transition().duration(i)};o.labels?(h.group.labels.transition().duration(i).attr("transform","translate("+j.left+","+j.top+")"),o.labels.source?(A.source.style("opacity",1),h.group.labels.source.text.text(o.labels.source)):A.source.style("opacity",0),o.labels.destination?(A.destination.style("opacity",1),h.group.labels.destination.text.text(o.labels.destination)):A.destination.style("opacity",0),A.source.attr("transform","translate(0,0)"),A.destination.attr("transform","translate("+f+",0)"),j.top+=35):(A.source.style("opacity",0),A.destination.style("opacity",0));var B,C;o.columnHeaders&&o.columnHeaders.length>0&&(C=d3.scale.linear().domain([0,o.columnHeaders.length-1]).range([0,f-q]),h.group.columnHeaders.transition().duration(i).attr("transform","translate("+j.left+","+j.top+")"),B=h.group.columnHeaders.selectAll("g.d2b-sankey-column-header").data(o.columnHeaders),B.enter().append("g").attr("class","d2b-sankey-column-header").append("text").attr("y",16).attr("x",function(a,b){return 0==b?-q/2:b==o.columnHeaders.length-1?q/2:void 0}),B.select("text").text(function(a){return a}),B.transition().duration(i).attr("transform",function(a,b){return"translate("+(C(b)+q/2)+",0)"}),j.top+=25),e=d-j.top-j.bottom,b=d3.sankey().size([f,e]).nodeWidth(q).nodePadding(p).nodes(o.nodes).links(o.links).layout(r);var D=h.group.sankey.nodes.selectAll("g.d2b-sankey-node").data(o.nodes,function(a,b){return"unique"==a.key?Math.floor(65536*(1+Math.random())):a.key&&"auto"!=a.key?a.key:b}),E=D.enter().append("g").attr("class","d2b-sankey-node").on("mouseover.d2b-mouseover",function(a){d2b.UTILS.createGeneralTooltip(d3.select(this),"<b>"+a.name+"</b>",u(a.value))}).on("mouseout.d2b-mouseout",function(){d2b.UTILS.removeTooltip()}).attr("transform",function(a){return"translate("+a.x+","+a.y+")"}).style("opacity",0).call(d2b.UTILS.bindElementEvents,a,"node");E.append("rect"),E.append("text");var F=D.select("text").text(function(a){return a.shortName});D.transition().duration(i).attr("transform",function(a){return"translate("+a.x+","+a.y+")"}).style("opacity",1),D.select("rect").transition().duration(i).attr("width",b.nodeWidth()).attr("height",function(a){return Math.max(0,a.dy)}),F.transition().duration(i).style("text-anchor",function(a){return a.x<f/2?"start":"end"}).attr("x",function(a){return a.x<f/2?b.nodeWidth()+5:-5}).attr("y",function(a){return a.dy/2+5});var G=h.group.sankey.links.selectAll("g.d2b-sankey-link").data(o.links,function(a,b){return"unique"==a.key?Math.floor(65536*(1+Math.random())):a.key&&"auto"!=a.key?a.key:b}),H=G.enter().append("g").attr("class","d2b-sankey-link").on("mouseover.d2b-mouseover",function(a){d2b.UTILS.createGeneralTooltip(d3.select(this),"<b>"+a.source.name+' <i class="fa fa-arrow-right"></i> '+a.target.name+"</b>",u(a.value))}).on("mouseout.d2b-mouseout",function(){d2b.UTILS.removeTooltip()}).style("opacity",0).call(d2b.UTILS.bindElementEvents,a,"link");return H.append("path"),H.append("text"),G.exit().transition().duration(i).style("opacity",0).remove(),D.exit().transition().duration(i).style("opacity",0).remove(),G.transition().duration(i).style("opacity",1),G.select("path").style("stroke",function(a){return a.colorBy?n(a[a.colorBy].colorKey?a[a.colorBy].colorKey:a[a.colorBy].name):"#777"}).transition().style("stroke-width",function(a){return Math.max(a.dy,s)}).duration(i).attr("d",b.link()),h.svg.attr("width",c).attr("height",d),h.group.sankey.transition().duration(i).attr("transform","translate("+j.left+","+j.top+")"),d3.timer.flush(),w&&w(),v},v},d2b.CHARTS.pieChart=function(){var a=d2b.CONSTANTS.DEFAULTWIDTH(),b=d2b.CONSTANTS.DEFAULTHEIGHT(),c=b,d=a,e=!0,f=!0,g=d3.select("body"),h=d2b.CONSTANTS.ANIMATIONLENGTHS().normal,i=d2b.CONSTANTS.DEFAULTFORCEDMARGIN(),j=new d2b.UTILS.LEGENDS.legend,k=new d2b.UTILS.CONTROLS.controls,l=d2b.CONSTANTS.DEFAULTCOLOR(),m={},n=function(a){return a},o={},p=d2b.CONSTANTS.DEFAULTEVENTS(),q=0,r=Math.min(c,d)/2,s=d3.svg.arc().outerRadius(r).innerRadius(r*q),t=d3.layout.pie().value(function(a){return a.value}).sort(null),u=1,v=function(a,b){a.attrTween("d",function(a){_self=this;var c=d3.interpolate(_self._current,a);return function(a){return _self._current=c(a),b(c(a))}})},w={};return w.select=function(a){return g=d3.select(a),e=!0,w},w.selection=function(a){return arguments.length?(g=a,e=!0,w):g},w.width=function(b){return arguments.length?(a=b,w):a},w.height=function(a){return arguments.length?(b=a,w):b},w.animationDuration=function(a){return arguments.length?(h=a,j.animationDuration(h),w):h},w.xFormat=function(a){return arguments.length?(n=d2b.UTILS.numberFormat(a),w):n},w.controls=function(){return arguments.length?w:o},w.donutRatio=function(a){return arguments.length?(q=a,w):q},w.on=function(a,b){return a=a.split("."),arguments.length?1==arguments.length?a[1]?p[a[0]][a[1]]:p[a[0]]["default"]:(a[1]?p[a[0]][a[1]]=b:p[a[0]]["default"]=b,w):p},w.data=function(a,b){return arguments.length?(b&&(m={},e=!0),m.values=a.data.values,u=d3.sum(m.values.map(function(a){return a.value})),f=!0,w):m},w.generate=function(a){e=!1,g.selectAll("*").remove(),g.svg=g.append("svg").attr("class","d2b-pie-chart d2b-svg d2b-container"),g.group=g.svg.append("g"),g.group.pie=g.group.append("g").attr("class","d2b-pie"),g.legend=g.group.append("g").attr("class","d2b-legend"),g.controls=g.group.append("g").attr("class","d2b-controls"),k.selection(g.controls).on("change",function(a){o[a.key].enabled=a.state,w.update()}),j.color(l).selection(g.legend);var b=h;return w.animationDuration(0).update(a).animationDuration(b),w},w.update=function(x){if(e)return w.generate(x);i=d2b.CONSTANTS.DEFAULTFORCEDMARGIN(),d=a-i.right-i.left;var y=d2b.UTILS.getValues(o).filter(function(a){return a.visible});y.map(function(a){a.data={state:a.enabled,label:a.label,key:a.key}}),k.data(y).width(d).update(),g.controls.transition().duration(h).attr("transform","translate("+(d-k.computedWidth())+","+-k.computedHeight()+")"),i.top+=k.computedHeight(),c=b-i.top-i.bottom,i.bottom+=j.computedHeight(),c=b-i.top-i.bottom,r=Math.min(c,d)/2,s.outerRadius(r).innerRadius(r*q),g.group.pie.transition().duration(h).attr("transform","translate("+d/2+","+c/2+")");var z=g.group.pie.datum(m.values).selectAll("g.d2b-arc").data(t,function(a){return"unique"==a.data.key?Math.floor(65536*(1+Math.random())):a.data.key&&"auto"!=a.data.key?a.data.key:a.data.label}),A=z.enter().append("g").attr("class","d2b-arc").style("opacity",0);z.transition().duration(h).style("opacity",1),A.append("path").each(function(a){this._current={},this._current.startAngle=0,this._current.endAngle=0,a.path=d3.select(this)}),A.append("text"),z.select("text").transition().duration(h).text(function(a){return d3.format("%")(a.data.value/u)}).attr("transform",function(a){var b=s.centroid(a);return"translate("+b[0]+","+b[1]+")"});var B=z.select("path");B.each(function(a){a.test="test"}).style("fill",function(a){return l(a.data.colorKey?a.data.colorKey:a.data.label)}).on("mouseover.d2b-mouseover",null).on("mouseout.d2b-mouseout",null);var C=B.transition().duration(h);return f?(f=!f,C.call(v,s)):C.attr("d",s),C.each("end",function(){var a=d3.select(this);a.on("mouseover.d2b-mouseover",function(b,c){a.transition().duration(d2b.CONSTANTS.ANIMATIONLENGTHS()["short"]).attr("transform","scale(1.01)").style("fill-opacity",.9),d2b.UTILS.createGeneralTooltip(a,"<b>"+b.data.label+"</b>",n(b.data.value));for(key in p.elementMouseover)p.elementMouseover[key].call(this,b,c,"arc")}).on("mouseout.d2b-mouseout",function(b,c){a.transition().duration(d2b.CONSTANTS.ANIMATIONLENGTHS()["short"]).attr("transform","scale(1)").style("fill-opacity",""),d2b.UTILS.removeTooltip();for(key in p.elementMouseout)p.elementMouseout[key].call(this,b,c,"arc")}).on("click.d2b-click",function(a,b){for(key in p.elementClick)p.elementClick[key].call(this,a,b,"arc")})}),z.exit().transition().duration(h).style("opacity",0).remove(),g.legend.transition().duration(h).attr("transform","translate("+(d-j.computedWidth())/2+","+c+")"),g.svg.attr("width",a).attr("height",b),g.group.attr("transform","translate("+i.left+","+i.top+")"),d3.timer.flush(),x&&x(),w},w},d2b.CHARTS.interactiveBarChart=function(){var a,b=d2b.CONSTANTS.DEFAULTWIDTH(),c=d2b.CONSTANTS.DEFAULTHEIGHT(),d=c,e=b,f={horizontal:e,vertical:d},g={type:"linear",scale:d3.scale.linear(),domain:"auto"},h={type:"linear",scale:d3.scale.linear(),domain:"auto"},i={horizontal:g,vertical:h},j=!0,k=d3.select("body"),l=d2b.CONSTANTS.ANIMATIONLENGTHS().normal,m=d2b.CONSTANTS.DEFAULTFORCEDMARGIN(),n=new d2b.UTILS.LEGENDS.legend,o=new d2b.UTILS.CONTROLS.controls,p="bottom",q=function(a){return a},r=function(a){return a},s=d2b.CONSTANTS.DEFAULTEVENTS(),t={x:"x",y:"y",horizontal:"horizontal",vertical:"vertical",width:"width",height:"height",bottom:"bottom",left:"left"},u={yAxisLock:{label:"Lock Y-Axis",type:"checkbox",visible:!1,enabled:!1,maxStacked:d2b.CONSTANTS.DEFAULTHEIGHT(),maxNonStacked:d2b.CONSTANTS.DEFAULTHEIGHT()},stacking:{label:"Stack Bars",type:"checkbox",visible:!1,enabled:!1},horizontal:{label:"Horizontal",type:"checkbox",visible:!1,enabled:!1},hideLegend:{label:"Hide Legend",type:"checkbox",visible:!1,enabled:!1}},v=d2b.CONSTANTS.DEFAULTCOLOR(),w={columns:{},labels:{x:"",y:""}},x=function(a){var b=a.svg;b.transition().duration(l).style("opacity",0).each("end",function(){b.remove()})},y=function(a){var b=a.svg.selectAll("rect").data(a.data.values,function(a){return a.x});b.enter().append("rect").attr("class","d2b-bar-rect").style("opacity",0).attr(t.height,0).attr(t.y,u.horizontal.enabled?0:f.vertical).on("mouseover.d2b-mouseover",function(b,c){d2b.UTILS.createGeneralTooltip(d3.select(this),"<b>"+a.key+" <i>("+q(b.x)+")</i></b> ",r(b.y));for(key in s.elementMouseover)s.elementMouseover[key].call(this,b,c,"bar")}).on("mouseout.d2b-mouseout",function(a,b){d2b.UTILS.removeTooltip();for(key in s.elementMouseout)s.elementMouseout[key].call(this,a,b,"bar")}).on("click.d2b-click",function(a,b){for(key in s.elementClick)s.elementClick[key].call(this,a,b,"bar")}),b.style("fill",v(a.data.label)).style("opacity",1),b.transition().duration(l).attr(t.x,function(a){return a.xPos}).attr(t.y,function(a){return a.yPos}).attr(t.width,function(a){return a[t.width]}).attr(t.height,function(a){return a[t.height]}),b.exit().transition().duration(l).style("opacity",0).attr(t.height,0).attr(t.y,u.horizontal.enabled?0:f.vertical).remove()},z=function(a){var b,c,d=e/(2*a.length),j={};u.stacking.enabled?("ordinal"==g.type?(b=i[t.horizontal].scale.rangeBand(),c=.6*b):(b=2.5*-d,c=d),a.forEach(function(a){a.data.values.forEach(function(a){u.horizontal.enabled?(a[t.height]=i[t.vertical].scale(a.y),j[a.x]=j[a.x]||0,a.xPos=i[t.horizontal].scale(a.x)+.2*b,a.yPos=j[a.x],j[a.x]+=a[t.height],a[t.width]=c):(a[t.height]=f[t.vertical]-i[t.vertical].scale(a.y),j[a.x]=j[a.x]||f[t.vertical],j[a.x]-=a[t.height],a.xPos=i[t.horizontal].scale(a.x)+.2*b,a.yPos=j[a.x],a[t.width]=c)})})):(b="ordinal"==g.type?d3.scale.ordinal().domain(a.map(function(a){return a.data.label})).rangeRoundBands([0,g.scale.rangeBand()],.05,0):d3.scale.ordinal().domain(a.map(function(a){return a.data.label})).rangeRoundBands([-d/2,d/2],.05,.3),c=b.rangeBand(),a.forEach(function(a){a.data.values.forEach(function(d){u.horizontal.enabled?(d.xPos=i[t.horizontal].scale(d.x)+b(a.data.label),d[t.height]=h.scale(d.y),d.yPos=0,d[t.width]=c):(d.xPos=i[t.horizontal].scale(d.x)+b(a.data.label),d[t.height]=f[t.vertical]-h.scale(d.y),d.yPos=f[t.vertical]-d[t.height],d[t.width]=c)})}))},A={};return A.select=function(a){return k=d3.select(a),j=!0,A},A.selection=function(a){return arguments.length?(k=a,j=!0,A):k},A.xScale=function(a){return arguments.length?(g.type=a.type,g.domain=a.domain,"linear"==a.type?g.scale=d3.scale.linear():"ordinal"==a.type&&(g.scale=d3.scale.ordinal()),a.domain||(g.domain="auto"),A):g},A.yScale=function(a){return arguments.length?(h.type=a.type,h.domain=a.domain,"linear"==a.type?h.scale=d3.scale.linear():"ordinal"==a.type&&(h.scale=d3.scale.ordinal()),a.domain||(h.domain="auto"),A):h
},A.width=function(a){return arguments.length?(b=a,A):b},A.height=function(a){return arguments.length?(c=a,A):c},A.controls=function(a){return arguments.length?(a.yAxisLock&&(u.yAxisLock.visible=null!=a.yAxisLock.visible?a.yAxisLock.visible:u.yAxisLock.visible,u.yAxisLock.enabled=null!=a.yAxisLock.enabled?a.yAxisLock.enabled:u.yAxisLock.enabled,u.yAxisLock.maxStacked=null!=a.yAxisLock.maxStacked?a.yAxisLock.maxStacked:u.yAxisLock.maxStacked,u.yAxisLock.maxNonStacked=null!=a.yAxisLock.maxNonStacked?a.yAxisLock.maxNonStacked:u.yAxisLock.maxNonStacked),a.stacking&&(u.stacking.visible=null!=a.stacking.visible?a.stacking.visible:u.stacking.visible,u.stacking.enabled=null!=a.stacking.enabled?a.stacking.enabled:u.stacking.enabled),a.horizontal&&(u.horizontal.visible=null!=a.horizontal.visible?a.horizontal.visible:u.horizontal.visible,u.horizontal.enabled=null!=a.horizontal.enabled?a.horizontal.enabled:u.horizontal.enabled),a.hideLegend&&(u.hideLegend.visible=null!=a.hideLegend.visible?a.hideLegend.visible:u.hideLegend.visible,u.hideLegend.enabled=null!=a.hideLegend.enabled?a.hideLegend.enabled:u.hideLegend.enabled),A):u},A.animationDuration=function(a){return arguments.length?(l=a,n.animationDuration(l),o.animationDuration(l),A):l},A.xFormat=function(a){return arguments.length?(q=d2b.UTILS.numberFormat(a),A):q},A.yFormat=function(a){return arguments.length?(r=d2b.UTILS.numberFormat(a),A):r},A.legendOrientation=function(a){return arguments.length?(p=a,A):p},A.on=function(a,b){return a=a.split("."),arguments.length?1==arguments.length?a[1]?s[a[0]][a[1]]:s[a[0]]["default"]:(a[1]?s[a[0]][a[1]]=b:s[a[0]]["default"]=b,A):s},A.data=function(a,b){return arguments.length?(b&&(w={columns:{},labels:{x:"",y:""}},j=!0),a.data.columns.forEach(function(a){var b;w.columns[a.label]?(b=w.columns[a.label],b.data.values=a.values||b.data.values,b.type=a.type):(b=w.columns[a.label]={data:a,type:a.type},j||(b.svg=k.group.columns.append("g"))),"none"==b.type&&(x(b),delete w.columns[a.label])}),a.data.labels&&(w.labels=a.data.labels),A):w},A.generate=function(a){j=!1,k.selectAll("*").remove(),k.svg=k.append("svg").attr("class","d2b-interactive-bar-chart d2b-svg d2b-container"),k.group=k.svg.append("g"),k.group.axes=k.group.append("g").attr("class","d2b-axes"),k.group.axes.x=k.group.axes.append("g").attr("class","d2b-x d2b-axis"),k.group.axes.y=k.group.axes.append("g").attr("class","d2b-y d2b-axis"),k.group.axes.xLabel=k.group.axes.append("g").attr("class","d2b-x-label").append("text"),k.group.axes.yLabel=k.group.axes.append("g").attr("class","d2b-y-label").append("text"),k.group.columns=k.group.append("g").attr("class","d2b-columns");for(key in w.columns)w.columns[key].svg=k.group.columns.append("g");k.controls=k.group.append("g").attr("class","d2b-controls"),o.selection(k.controls).on("change",function(a){u[a.key].enabled=a.state,A.update()}),k.legend=k.group.append("g").attr("class","d2b-legend"),n.color(v).selection(k.legend).on("elementMouseover.d2b-mouseover",function(a){k.group.columns.selectAll("rect").transition().duration(l/2).style("opacity",.35),a.data.svg.selectAll("rect").transition().duration(0).style("opacity",1)}).on("elementMouseout.d2b-mouseout",function(){k.group.columns.selectAll("rect").transition().duration(l/4).style("opacity",1)});var b=l;return A.animationDuration(0),A.update(a),A.animationDuration(b),A},A.update=function(s){if(j)return A.generate(s);m=d2b.CONSTANTS.DEFAULTFORCEDMARGIN(),m.bottom+=20,m.left+=20,u.horizontal.enabled?(i={horizontal:h,vertical:g},t={x:"y",y:"x",horizontal:"vertical",vertical:"horizontal",width:"height",height:"width",bottom:"left",left:"bottom"}):(i={horizontal:g,vertical:h},t={x:"x",y:"y",horizontal:"horizontal",vertical:"vertical",width:"width",height:"height",bottom:"bottom",left:"left"});var v=d2b.UTILS.getValues(w.columns);if(e=b-m.right-m.left,u.hideLegend.enabled)var x={data:{items:[]}};else var x={data:{items:v.filter(function(a){return"none"!=a.newType}).map(function(a){return{label:a.data.label,type:a.newType,data:a}}).sort(function(a,b){return a.label-b.label})}};n.width(e).data(x).update();var B=d2b.UTILS.getValues(u).filter(function(a){return a.visible});B.map(function(a){a.data={state:a.enabled,label:a.label,key:a.key}}),o.width(e).data(B).update(),m.top+=o.computedHeight(),d=c-m.top-m.bottom,k.controls.transition().duration(l).attr("transform","translate("+(m.left+e-o.computedWidth())+","+(-o.computedHeight()-10+m.top)+")"),"right"==p||"left"==p?n.orientation("vertical").height(d).update():n.orientation("horizontal").width(e).update();var C;C="right"==p?"translate("+(m.left+e-n.computedWidth())+","+((d-n.computedHeight())/2+m.top)+")":"left"==p?"translate("+m.left+","+((d-n.computedHeight())/2+m.top)+")":"top"==p?"translate("+(m.left+(e-n.computedWidth())/2)+","+(m.top-20)+")":"translate("+(m.left+(e-n.computedWidth())/2)+","+(25+d+m.top-n.computedHeight())+")",k.legend.transition().duration(l).attr("transform",C),m[p]+="right"==p||"left"==p?n.computedWidth()+30:n.computedHeight()+10,d=c-m.top-m.bottom,e=b-m.right-m.left,f={horizontal:e,vertical:d};var D=[],E=[],F={};u.stacking.enabled?(v.forEach(function(a){a.data.values.forEach(function(a){F[a.x]||(F[a.x]=0),F[a.x]+=a.y,D.push(a.x),E.push(a.y)})}),E=E.concat(d2b.UTILS.getValues(F))):v.forEach(function(a){a.data.values&&a.data.values.forEach(function(a){D.push(a.x),E.push(a.y)})});var G={};"ordinal"==i[t.horizontal].type?(i[t.horizontal].scale.rangeRoundBands([0,f[t.horizontal]],.1),G[t.horizontal]=d2b.UTILS.AXISCHARTS.getDomainOrdinal(D).sort()):(i[t.horizontal].scale.range([0,f[t.horizontal]]),G[t.horizontal]=d2b.UTILS.AXISCHARTS.getDomainLinear(D)),G[t.vertical]=u.yAxisLock.enabled?u.stacking.enabled?[0,u.yAxisLock.maxStacked]:[0,u.yAxisLock.maxNonStacked]:d2b.UTILS.AXISCHARTS.getDomainLinear(E),i[t.vertical].scale.range([f[t.vertical],0]),i[t.horizontal].scale.domain("auto"==i[t.horizontal].domain?G[t.horizontal]:i[t.horizontal].domain),i[t.vertical].scale.domain("auto"==i[t.vertical].domain?G[t.vertical]:i[t.vertical].domain),u.horizontal.enabled&&i[t.vertical].scale.domain(i[t.vertical].scale.domain().reverse()),k.svg.attr("width",b).attr("height",c),i[t.vertical].scale.nice(5);var H={x:d3.svg.axis().scale(i[t.horizontal].scale).orient(t.bottom).tickFormat(q),y:d3.svg.axis().scale(i[t.vertical].scale).orient(t.left).tickFormat(r)};k.group.axes[t.y].transition().duration(l).call(H[t.y]);var I=0;return k.group.axes[t.y].selectAll(".tick text").each(function(){I<this.getComputedTextLength()&&(I=this.getComputedTextLength())}),m.left+=I,e=b-m.right-m.left,f.horizontal=e,u.horizontal.enabled?"linear"==i.horizontal.type?i.horizontal.scale.range([f.horizontal,0]):"ordinal"==i.horizontal.type&&i.horizontal.scale.rangeRoundBands([f.horizontal,0],.1):"linear"==i.horizontal.type?i.horizontal.scale.range([0,f.horizontal]):"ordinal"==i.horizontal.type&&i.horizontal.scale.rangeRoundBands([0,f.horizontal],.1),H.x.tickSize(-f[t.vertical]),H.y.tickSize(-f[t.horizontal]),k.group.axes[t.x].transition().duration(l).attr("transform","translate("+m.left+","+(m.top+d)+")").call(H[t.x]),k.group.axes[t.y].transition().duration(l).attr("transform","translate("+m.left+","+m.top+")").call(H[t.y]),a="ordinal"==i[t.horizontal].type?d3.scale.ordinal().domain(v.map(function(a){return a.data.label})).rangeRoundBands([0,i[t.horizontal].scale.rangeBand()]):f[t.horizontal]/(20*v.length),k.group.axes[t.x+"Label"].transition().duration(l).text(w.labels[t.x]).attr("transform","translate("+(m.left+e/2)+","+(d+30+m.top)+")"),k.group.axes[t.y+"Label"].transition().duration(l).attr("transform","translate("+(m.left-I-10)+","+(d/2+m.top)+"),rotate(-90)").text(w.labels[t.y]),k.group.columns.transition().duration(l).attr("transform","translate("+m.left+","+m.top+")"),z(v),v.forEach(function(a){y(a)}),d3.timer.flush(),s&&s(),A},A},d2b.CHARTS.guageChart=function(){var a={};a.width=d2b.CONSTANTS.DEFAULTWIDTH(),a.height=d2b.CONSTANTS.DEFAULTHEIGHT(),a.innerHeight=a.height,a.innerWidth=a.width,a.outerHeight=a.height,a.outerWidth=a.width,a.forcedMargin=d2b.CONSTANTS.DEFAULTFORCEDMARGIN(),a.generateRequired=!0,a.selection=d3.select("body"),a.animationDuration=d2b.CONSTANTS.ANIMATIONLENGTHS().normal,a.color=d2b.CONSTANTS.DEFAULTCOLOR(),a.currentChartData={},a.xFormat=function(a){return a},a.on=d2b.CONSTANTS.DEFAULTEVENTS(),a.percentFormat=d2b.UTILS.numberFormat({precision:2,units:{after:"%"}}),a.arc=d3.svg.arc().innerRadius(0).outerRadius(0).startAngle(function(a){return a.start}).endAngle(function(a){return a.end});var b={};return b.select=d2b.UTILS.CHARTS.MEMBERS.select(b,a,function(){a.generateRequired=!0}),b.selection=d2b.UTILS.CHARTS.MEMBERS.prop(b,a,"selection",function(){a.generateRequired=!0}),b.width=d2b.UTILS.CHARTS.MEMBERS.prop(b,a,"width"),b.height=d2b.UTILS.CHARTS.MEMBERS.prop(b,a,"height"),b.animationDuration=d2b.UTILS.CHARTS.MEMBERS.prop(b,a,"animationDuration"),b.color=d2b.UTILS.CHARTS.MEMBERS.prop(b,a,"color"),b.xFormat=d2b.UTILS.CHARTS.MEMBERS.format(b,a,"xFormat"),b.on=d2b.UTILS.CHARTS.MEMBERS.on(b,a),b.data=function(c,d){return arguments.length?(d&&(a.currentChartData={}),a.currentChartData=c.data,b):a.currentChartData},b.generate=function(c){a.generateRequired=!1,a.selection.selectAll("*").remove(),a.selection.svg=a.selection.append("svg").attr("class","d2b-template-chart d2b-svg d2b-container"),a.forcedMargin=d2b.CONSTANTS.DEFAULTFORCEDMARGIN(),a.selection.group=a.selection.svg.append("g").attr("transform","translate("+a.forcedMargin.left+","+a.forcedMargin.top+")"),a.selection.main=a.selection.group.append("g").attr("class","d2b-guage-chart"),a.selection.arcs=a.selection.main.append("g"),a.selection.arcHeader=a.selection.main.append("text").attr("class","d2b-guage-arc-header"),a.selection.arcLabels=a.selection.main.append("g").attr("class","d2b-guage-arc-labels"),a.selection.arcLabels.start=a.selection.arcLabels.append("text").attr("y",20).text("0%"),a.selection.arcLabels.end=a.selection.arcLabels.append("text").attr("y",20).text("100%"),a.selection.arcLabels.percent=a.selection.arcLabels.append("text").attr("class","d2b-guage-arc-percent").text("0%");var d=a.animationDuration;return b.animationDuration(0).update(c).animationDuration(d),b},b.update=function(c){if(a.generateRequired)return b.generate(c);a.forcedMargin=d2b.CONSTANTS.DEFAULTFORCEDMARGIN(),a.outerWidth=a.width,a.outerHeight=a.height,a.selection.svg.attr("width",a.width).attr("height",a.height),d2b.UTILS.CHARTS.HELPERS.updateDimensions(a);var d={current:{outer:Math.min(2*a.outerHeight-80,a.outerWidth)/2},previous:{inner:a.arc.innerRadius(),outer:a.arc.outerRadius()}};d.current.inner=.8*d.current.outer,a.arc.innerRadius(d.current.inner).outerRadius(d.current.outer);var e=[],f=0;a.currentChartData.percent?(f=a.currentChartData.percent,e=[{percent:f,start:-Math.PI/2,end:Math.PI*a.currentChartData.percent-Math.PI/2,color:a.color(a.currentChartData.label),filled:!0},{percent:f,start:Math.PI*a.currentChartData.percent-Math.PI/2,end:Math.PI/2,color:"#ddd",filled:!1}]):a.currentChartData.value&&a.currentChartData.total?(f=a.currentChartData.value/a.currentChartData.total,e=[{percent:f,start:-Math.PI/2,end:Math.PI*a.currentChartData.value/a.currentChartData.total-Math.PI/2,color:a.color(a.currentChartData.label),filled:!0},{percent:f,start:Math.PI*a.currentChartData.value/a.currentChartData.total-Math.PI/2,end:Math.PI/2,color:"#ddd",filled:!1}]):(f=0,e=[{percent:f,start:-Math.PI/2,end:-Math.PI/2,color:a.color(a.currentChartData.label),filled:!0},{percent:f,start:-Math.PI/2,end:Math.PI/2,color:"#ddd",filled:!1}]),a.selection.arcs.arc=a.selection.arcs.selectAll("g").data(e);var g=a.selection.arcs.arc.enter().append("g");return g.append("path").attr("d",a.arc).style("fill",function(a){return a.color}).each(function(a){this._current={start:a.start,end:a.end},this._radiusCurrent={inner:d.current.inner,outer:d.current.outer}}),g.filter(function(a){return a.filled}).on("mouseover.d2b-mouseover",function(b){var c=d3.select(this);c.transition().duration(a.animationDuration/4).attr("transform","scale(1.05)"),d2b.UTILS.createGeneralTooltip(c,"<b>"+a.currentChartData.label+"</b>",a.percentFormat(100*b.percent))}).on("mouseout.d2b-mouseout",function(){var b=d3.select(this);b.transition().duration(a.animationDuration/4).attr("transform","scale(1)"),d2b.UTILS.removeTooltip()}).call(d2b.UTILS.bindElementEvents,a,"arc"),a.selection.arcs.arc.path=a.selection.arcs.arc.select("path").transition().duration(a.animationDuration).attrTween("d",function(b){var c=this,e=d3.interpolate(c._current,{start:b.start,end:b.end}),f=d3.interpolate(c._radiusCurrent,{inner:d.current.inner,outer:d.current.outer});return function(b){return c._current=e(b),c._radiusCurrent=f(b),a.arc.innerRadius(c._radiusCurrent.inner).outerRadius(c._radiusCurrent.outer),a.arc(c._current)}}).style("fill",function(a){return a.color}).attr("class","d2b-arc"),a.selection.arcs.transition().duration(a.animationDuration).attr("transform","translate("+a.outerWidth/2+","+(a.outerHeight-10)+")"),a.selection.arcLabels.transition().duration(a.animationDuration).attr("transform","translate("+a.outerWidth/2+","+(a.outerHeight-10)+")"),a.selection.arcLabels.percent.transition().duration(a.animationDuration).tween("text",function(){var a=this;a._current||(a._current=0);var b=d3.interpolate(a._current,f);return function(c){a._current=b(c),a.textContent=d3.format("%")(b(c))}}).attr("font-size",.5*d.current.inner+"px"),a.selection.arcLabels.start.transition().duration(a.animationDuration).attr("x",-(d.current.outer-(d.current.outer-d.current.inner)/2)),a.selection.arcLabels.end.transition().duration(a.animationDuration).attr("x",d.current.outer-(d.current.outer-d.current.inner)/2),a.selection.arcHeader.text(a.currentChartData.label).transition().duration(a.animationDuration).attr("x",a.outerWidth/2).attr("y",20),d3.timer.flush(),c&&c(),b},b},d2b.CHARTS.iframeChart=function(){var a=d2b.CONSTANTS.DEFAULTWIDTH(),b=d2b.CONSTANTS.DEFAULTHEIGHT(),c=!0,d=d3.select("body"),e=d2b.CONSTANTS.ANIMATIONLENGTHS().normal,f=(d2b.CONSTANTS.DEFAULTFORCEDMARGIN(),d2b.CONSTANTS.DEFAULTCOLOR(),{}),g=d2b.CONSTANTS.DEFAULTEVENTS(),h={};return h.select=function(a){return d=d3.select(a),c=!0,h},h.selection=function(a){return arguments.length?(d=a,c=!0,h):d},h.width=function(b){return arguments.length?(a=b,h):a},h.height=function(a){return arguments.length?(b=a,h):b},h.animationDuration=function(a){return arguments.length?(e=a,h):e},h.on=function(a,b){return a=a.split("."),arguments.length?1==arguments.length?a[1]?g[a[0]][a[1]]:g[a[0]]["default"]:(a[1]?g[a[0]][a[1]]=b:g[a[0]]["default"]=b,h):g},h.data=function(a,b){return arguments.length?(b&&(f={}),c=!0,f=a.data,h):f},h.generate=function(a){c=!1,d.selectAll("*").remove(),d.div=d.append("div").attr("class","d2b-iframe-chart d2b-container"),d.div.iframe=d.div.append("iframe").attr("class","d2b-iframe").attr("src",f.url);var b=e;return h.animationDuration(0).update(a).animationDuration(b),h},h.update=function(f){return c?h.generate(f):(d.div.iframe.transition().duration(e).attr("width",a).attr("height",b),d3.timer.flush(),f&&f(),h)},h},d2b.CHARTS.multiChart=function(){var a,b,c,d=d2b.CONSTANTS.DEFAULTWIDTH(),e=d2b.CONSTANTS.DEFAULTHEIGHT(),f=!0,g=d3.select("body"),h=d2b.CONSTANTS.ANIMATIONLENGTHS().normal,i=(d2b.CONSTANTS.DEFAULTFORCEDMARGIN(),d2b.CONSTANTS.DEFAULTCOLOR(),{}),j={chart:{}},k={chart:null},l={elementMouseover:function(){},elementMouseout:function(){},elementClick:function(){}},m=function(a,b){k.chart=j.chart,j.chart=a;for(key in l.elementClick)l.elementClick[key].call(this,a,b,"chart-button");s.update()},n=function(a,b){for(key in l.elementMouseover)l.elementMouseover[key].call(this,a,b,"chart-button")},o=function(a,b){for(key in l.elementMouseout)l.elementMouseout[key].call(this,a,b,"chart-button")},p=function(){g.buttonsWrapper.buttons.button=g.buttonsWrapper.buttons.selectAll("li").data(i.charts,function(a){return"unique"==a.key?Math.floor(65536*(1+Math.random())):a.key&&"auto"!=a.key?a.key:a.label}),g.buttonsWrapper.buttons.button.enter().append("li").on("click.d2b-click",m).on("mouseover.d2b-mouseover",n).on("mouseout.d2b-mouseout",o),g.buttonsWrapper.buttons.button.text(function(a){return a.label}).classed("d2b-selected",function(a){return a==j.chart})},q=function(){if(j.chart.properties)for(key in j.chart.properties)j.chart.properties[key].args?c[key].apply(this,j.chart.properties[key].args):c[key](j.chart.properties[key]);var a="multiChart-"+j.chart.type+"-";c.on("elementClick.d2b-click",function(b,c,d){for(key in l.elementClick)l.elementClick[key].call(this,b,c,a+d)}).on("elementMouseover.d2b-mouseover",function(b,c,d){for(key in l.elementMouseover)l.elementMouseover[key].call(this,b,c,a+d)}).on("elementMouseout.d2b-mouseout",function(b,c,d){for(key in l.elementMouseout)l.elementMouseout[key].call(this,b,c,a+d)})},r=function(){g.chartWrapper.chart?j.chart!=k.chart&&(j.chart.type==k.chart.type?c.data(j.chart.data):(g.chartWrapper.chart.transition().duration(h).style("opacity",0).remove(),g.chartWrapper.chart=g.chartWrapper.append("div").attr("class","d2b-multi-chart-chart").style("opacity",0),c=j.chart.chart,c.selection(g.chartWrapper.chart).data(JSON.parse(JSON.stringify(j.chart.data))),g.chartWrapper.chart.transition().duration(h).style("opacity",1))):(g.chartWrapper.chart=g.chartWrapper.append("div").attr("class","d2b-multi-chart-chart").style("opacity",1),c=j.chart.chart,c.selection(g.chartWrapper.chart).data(j.chart.data)),q(),c.width(a).height(b).update(),k.chart=j.chart},s={};return s.select=function(a){return g=d3.select(a),f=!0,s},s.selection=function(a){return arguments.length?(g=a,f=!0,s):g},s.width=function(a){return arguments.length?(d=a,s):d},s.height=function(a){return arguments.length?(e=a,s):e},s.animationDuration=function(a){return arguments.length?(h=a,s):h},s.on=function(a,b){return a=a.split("."),arguments.length?1==arguments.length?a[1]?l[a[0]][a[1]]:l[a[0]]["default"]:(a[1]?l[a[0]][a[1]]=b:l[a[0]]["default"]=b,s):l},s.data=function(a,b){if(!arguments.length)return i;b&&(i={});var c=!0;if(j.chart.key){var d=a.data.charts.filter(function(a){return j.chart.key==a.key})[0];d&&(c=!1,j.chart=d)}return c&&(j.chart=a.data.charts[0]),f=!0,i=a.data,i.charts.forEach(function(a){a.chart=new d2b.CHARTS[a.type]}),s},s.generate=function(a){f=!1,g.selectAll("*").remove(),g.buttonsWrapper=g.append("div").attr("class","d2b-multi-chart-buttons-wrapper"),g.buttonsWrapper.buttons=g.buttonsWrapper.append("ul").attr("class","d2b-buttons"),g.chartWrapper=g.append("div").attr("class","d2b-multi-chart d2b-container");var b=h;return s.animationDuration(0).update(a).animationDuration(b),s},s.update=function(c){return f?s.generate(c):(a=d,b=e-50,g.chartWrapper.style("width",a+"px").style("height",b+"px"),p(),r(),d3.timer.flush(),c&&c(),s)},s},d2b.CHARTS.templateChart=function(){var a={};a.width=d2b.CONSTANTS.DEFAULTWIDTH(),a.height=d2b.CONSTANTS.DEFAULTHEIGHT(),a.innerHeight=a.height,a.innerWidth=a.width,a.outerHeight=a.height,a.outerWidth=a.width,a.forcedMargin=d2b.CONSTANTS.DEFAULTFORCEDMARGIN(),a.generateRequired=!0,a.selection=d3.select("body"),a.animationDuration=d2b.CONSTANTS.ANIMATIONLENGTHS().normal,a.color=d2b.CONSTANTS.DEFAULTCOLOR(),a.currentChartData={},a.xFormat=function(a){return a},a.on=d2b.CONSTANTS.DEFAULTEVENTS(),a.legend=new d2b.UTILS.LEGENDS.legend,a.legendOrientation="bottom",a.legendData={data:{items:[]}},a.controls=new d2b.UTILS.CONTROLS.horizontalControls,a.controlsData={hideLegend:{label:"Hide Legend",type:"checkbox",visible:!1,enabled:!1}};var b={};return b.select=d2b.UTILS.CHARTS.MEMBERS.select(b,a,function(){a.generateRequired=!0}),b.selection=d2b.UTILS.CHARTS.MEMBERS.prop(b,a,"selection",function(){a.generateRequired=!0}),b.width=d2b.UTILS.CHARTS.MEMBERS.prop(b,a,"width"),b.height=d2b.UTILS.CHARTS.MEMBERS.prop(b,a,"height"),b.animationDuration=d2b.UTILS.CHARTS.MEMBERS.prop(b,a,"animationDuration",function(){a.legend.animationDuration(a.animationDuration),a.controls.animationDuration(a.animationDuration)}),b.legendOrientation=d2b.UTILS.CHARTS.MEMBERS.prop(b,a,"legendOrientation"),b.xFormat=d2b.UTILS.CHARTS.MEMBERS.format(b,a,"xFormat"),b.controls=d2b.UTILS.CHARTS.MEMBERS.controls(b,a),b.on=d2b.UTILS.CHARTS.MEMBERS.on(b,a),b.data=function(c,d){return arguments.length?(d&&(a.currentChartData={}),a.currentChartData=c.data,b):a.currentChartData},b.generate=function(c){a.generateRequired=!1,d2b.UTILS.CHARTS.HELPERS.generateDefaultSVG(a),a.legend.color(a.color).selection(a.selection.legend),a.controls.selection(a.selection.controls).on("change",function(c){a.controlsData[c.key].enabled=c.state,b.update()}),a.selection.main=a.selection.group.append("g").attr("class","d2b-main-chart");var d=a.animationDuration;return b.animationDuration(0).update(c).animationDuration(d),b},b.update=function(c){return a.generateRequired?b.generate(c):(a.forcedMargin=d2b.CONSTANTS.DEFAULTFORCEDMARGIN(),a.outerWidth=a.width,a.outerHeight=a.height,a.selection.svg.attr("width",a.width).attr("height",a.height),d2b.UTILS.CHARTS.HELPERS.updateDimensions(a),d2b.UTILS.CHARTS.HELPERS.updateControls(a),a.controlsData.hideLegend.enabled?a.legendData={data:{items:[]}}:a.legendData.data.items=[{label:"item 1"},{label:"item 2"},{label:"item 3"},{label:"item 4"},{label:"item 5"},{label:"item 6"}],d2b.UTILS.CHARTS.HELPERS.updateLegend(a),a.selection.main.transition().duration(a.animationDuration).attr("transform","translate("+a.forcedMargin.left+","+a.forcedMargin.top+")"),d2b.UTILS.CHARTS.HELPERS.updateDimensions(a),d3.timer.flush(),c&&c(),b)},b},d2b.UTILS.AXISCHART.scatter=function(){},d2b.UTILS.AXISCHART.TYPES.bar=function(){var a={};a.animationDuration=d2b.CONSTANTS.ANIMATIONLENGTHS().normal,a.color=d2b.CONSTANTS.DEFAULTCOLOR(),a.currentChartData={},a.xFormat=function(a){return a},a.yFormat=function(a){return a},a.on=d2b.CONSTANTS.DEFAULTEVENTS(),a.groupScale=d3.scale.ordinal(),a.updateStackedVals=function(a,b){return b.sHeight<0?(a+=b.height,{newValue:a,modifier:-b.height}):(a-=b.height,{newValue:a,modifier:0})};var b={};return b.foreground=d2b.UTILS.CHARTS.MEMBERS.prop(b,a,"foreground"),b.background=d2b.UTILS.CHARTS.MEMBERS.prop(b,a,"background"),b.animationDuration=d2b.UTILS.CHARTS.MEMBERS.prop(b,a,"animationDuration"),b.x=d2b.UTILS.CHARTS.MEMBERS.prop(b,a,"x"),b.y=d2b.UTILS.CHARTS.MEMBERS.prop(b,a,"y"),b.xFormat=d2b.UTILS.CHARTS.MEMBERS.prop(b,a,"xFormat"),b.yFormat=d2b.UTILS.CHARTS.MEMBERS.prop(b,a,"yFormat"),b.width=d2b.UTILS.CHARTS.MEMBERS.prop(b,a,"width"),b.height=d2b.UTILS.CHARTS.MEMBERS.prop(b,a,"height"),b.on=d2b.UTILS.CHARTS.MEMBERS.on(b,a),b.color=d2b.UTILS.CHARTS.MEMBERS.prop(b,a,"color"),b.controls=d2b.UTILS.CHARTS.MEMBERS.prop(b,a,"controlsData"),b.axisChart=d2b.UTILS.CHARTS.MEMBERS.prop(b,a,"axisChart"),b.xValues=function(){var b=[];return a.currentChartData.forEach(function(a){b=b.concat(a.values.map(function(a){return a.x}))}),b},b.yValues=function(){var b={},c=[0];if(a.controlsData.stackBars.enabled){a.currentChartData.forEach(function(a){a.values.forEach(function(a){b[a.x]||(b[a.x]={positive:0,negative:0}),a.y>0?b[a.x].positive+=a.y:b[a.x].negative+=a.y})});for(var d in b)c.push(b[d].negative),c.push(b[d].positive)}else a.currentChartData.forEach(function(a){c=c.concat(a.values.map(function(a){return a.y}))});return c},b.data=function(c){return arguments.length?(a.currentChartData=c,b):a.currentChartData},b.update=function(c){var d=a.currentChartData.map(function(a){return a.label});a.groupScale.domain(d).rangeBands([0,a.x.rangeBand]);var e={};return a.background.each(function(b){var c=d3.select(this),d=c.selectAll("rect").data(b.values,function(a){return a.x}),f=d.enter().append("rect").style("fill",a.color(b.label)).call(d2b.UTILS.tooltip,function(){return"<b>"+b.label+"</b>"},function(b){return a.yFormat(b.y)}).call(d2b.UTILS.bindElementEvents,a,"bar");if(a.controlsData.stackBars.enabled)f.attr("y",a.y.customScale(0)).attr("height",0),d.transition().duration(a.animationDuration).attr("x",function(b){return a.x.customScale(b.x)-a.x.rangeBand/2}).attr("y",function(b){e[b.x]||(e[b.x]={negative:a.y.customScale(0),positive:a.y.customScale(0)});var c;return b.y<0?(c=a.updateStackedVals(e[b.x].negative,a.y.customBarScale(b.y)),e[b.x].negative=c.newValue,e[b.x].negative+c.modifier):(c=a.updateStackedVals(e[b.x].positive,a.y.customBarScale(b.y)),e[b.x].positive=c.newValue,e[b.x].positive+c.modifier)}).attr("width",function(){return Math.max(0,a.x.rangeBand)}).attr("height",function(b){return a.y.customBarScale(b.y).height}),d.exit().transition().duration(a.animationDuration).attr("y",a.y.customScale(0)).attr("height",0);else{f.attr("y",a.y.customScale(0)).attr("height",0);var g=Math.min(1,.1*a.groupScale.rangeBand());d.transition().duration(a.animationDuration).attr("x",function(c){return a.x.customScale(c.x)-a.x.rangeBand/2+a.groupScale(b.label)+g}).attr("width",function(){return Math.max(0,a.groupScale.rangeBand()-2*g)}).attr("y",function(b){return a.y.customBarScale(b.y).y}).attr("height",function(b){return a.y.customBarScale(b.y).height}),d.exit().transition().duration(a.animationDuration).attr("y",a.y.customScale(0)).attr("height",0)}}),d3.timer.flush(),c&&c(),b},b},d2b.UTILS.AXISCHART.TYPES.bar.tools=function(){return{controlsData:{stackBars:{label:"Stack Bars",type:"checkbox",visible:!1,enabled:!1}}}},d2b.UTILS.AXISCHART.TYPES.line=function(){var a={};a.animationDuration=d2b.CONSTANTS.ANIMATIONLENGTHS().normal,a.color=d2b.CONSTANTS.DEFAULTCOLOR(),a.currentChartData={},a.xFormat=function(a){return a},a.yFormat=function(a){return a},a.on=d2b.CONSTANTS.DEFAULTEVENTS(),a.line=d3.svg.line().x(function(b){return a.x.customScale(b.x)}).y(function(b){return a.y.customScale(b.y)});var b={};return b.foreground=d2b.UTILS.CHARTS.MEMBERS.prop(b,a,"foreground"),b.background=d2b.UTILS.CHARTS.MEMBERS.prop(b,a,"background"),b.animationDuration=d2b.UTILS.CHARTS.MEMBERS.prop(b,a,"animationDuration"),b.x=d2b.UTILS.CHARTS.MEMBERS.prop(b,a,"x"),b.y=d2b.UTILS.CHARTS.MEMBERS.prop(b,a,"y"),b.xFormat=d2b.UTILS.CHARTS.MEMBERS.prop(b,a,"xFormat"),b.yFormat=d2b.UTILS.CHARTS.MEMBERS.prop(b,a,"yFormat"),b.width=d2b.UTILS.CHARTS.MEMBERS.prop(b,a,"width"),b.height=d2b.UTILS.CHARTS.MEMBERS.prop(b,a,"height"),b.on=d2b.UTILS.CHARTS.MEMBERS.on(b,a),b.color=d2b.UTILS.CHARTS.MEMBERS.prop(b,a,"color"),b.controls=d2b.UTILS.CHARTS.MEMBERS.prop(b,a,"controlsData"),b.axisChart=d2b.UTILS.CHARTS.MEMBERS.prop(b,a,"axisChart"),b.xValues=function(){var b=[];return a.currentChartData.forEach(function(a){b=b.concat(a.values.map(function(a){return a.x}))}),b},b.yValues=function(){var b=[];return a.currentChartData.forEach(function(a){b=b.concat(a.values.map(function(a){return a.y}))}),b},b.data=function(c){return arguments.length?(a.currentChartData=c,b):a.currentChartData},b.update=function(c){return a.background.each(function(b){var c=d3.select(this),d=c.select("path");0==d.size()&&(d=c.append("path").call(d2b.UTILS.bindElementEvents,a,"line")),a.line.interpolate(b.interpolate?b.interpolate:"linear"),d.style("stroke",function(){return a.color(b.label)}).datum(function(){return b.values}).transition().duration(a.animationDuration).attr("d",a.line)}),a.foreground.each(function(b){var c=d3.select(this),d=c.selectAll("g").data(function(a){return a.values});newPoint=d.enter().append("g").attr("transform",function(b){return"translate("+a.x.customScale(b.x)+","+a.y.customScale(b.y)+")"}),newPoint.append("circle").attr("r",3.5),newPoint.append("circle").attr("r",3.5).on("mouseover.d2b-mouseover",function(){d3.select(this).transition().duration(a.animationDuration/2).attr("r",7)}).on("mouseout.d2b-mouseover",function(){d3.select(this).transition().duration(a.animationDuration/2).attr("r",3.5)}).style("fill-opacity",0).call(d2b.UTILS.tooltip,function(){return"<b>"+b.label+"</b>"},function(b){return a.yFormat(b.y)}).call(d2b.UTILS.bindElementEvents,a,"line-point"),d.selectAll("circle").style("stroke",a.color(b.label)).style("fill","white"),d.transition().duration(a.animationDuration).attr("transform",function(b){return"translate("+a.x.customScale(b.x)+","+a.y.customScale(b.y)+")"}),d.exit().transition().duration(a.animationDuration).style("opacity",0).attr("r",0).remove()}),d3.timer.flush(),c&&c(),b},b},d2b.UTILS.AXISCHART.TYPES.area=function(){var a={};a.animationDuration=d2b.CONSTANTS.ANIMATIONLENGTHS().normal,a.color=d2b.CONSTANTS.DEFAULTCOLOR(),a.currentChartData={},a.xFormat=function(a){return a},a.yFormat=function(a){return a},a.on=d2b.CONSTANTS.DEFAULTEVENTS(),a.area=d3.svg.area().x(function(b){return a.x.customScale(b.x)}).y1(function(b){return a.y.customScale(b.y)}).y0(function(b){return a.y.customScale(b.y0)});var b={};return b.foreground=d2b.UTILS.CHARTS.MEMBERS.prop(b,a,"foreground"),b.background=d2b.UTILS.CHARTS.MEMBERS.prop(b,a,"background"),b.width=d2b.UTILS.CHARTS.MEMBERS.prop(b,a,"width"),b.height=d2b.UTILS.CHARTS.MEMBERS.prop(b,a,"height"),b.animationDuration=d2b.UTILS.CHARTS.MEMBERS.prop(b,a,"animationDuration"),b.x=d2b.UTILS.CHARTS.MEMBERS.prop(b,a,"x"),b.y=d2b.UTILS.CHARTS.MEMBERS.prop(b,a,"y"),b.xFormat=d2b.UTILS.CHARTS.MEMBERS.prop(b,a,"xFormat"),b.yFormat=d2b.UTILS.CHARTS.MEMBERS.prop(b,a,"yFormat"),b.on=d2b.UTILS.CHARTS.MEMBERS.on(b,a),b.color=d2b.UTILS.CHARTS.MEMBERS.prop(b,a,"color"),b.controls=d2b.UTILS.CHARTS.MEMBERS.prop(b,a,"controlsData"),b.axisChart=d2b.UTILS.CHARTS.MEMBERS.prop(b,a,"axisChart"),a.updatePoints=function(b,c,d){a.foreground.point[d]=c.selectAll("g.d2b-"+d+"-point").data(function(a){return a.values});var e=a.foreground.point[d].enter().append("g").attr("class","d2b-"+d+"-point").attr("transform",function(b){return"translate("+a.x.customScale(b.x)+","+a.y.customScale(b[d])+")"});e.append("circle").attr("r",3.5),e.append("circle").attr("r",3.5).style("fill-opacity",0).on("mouseover.d2b-mouseover",function(){d3.select(this).transition().duration(a.animationDuration/2).attr("r",7)}).on("mouseout.d2b-mouseover",function(){d3.select(this).transition().duration(a.animationDuration/2).attr("r",3.5)}).call(d2b.UTILS.bindElementEvents,a,"area-point-"+d).call(d2b.UTILS.tooltip,function(){return"<b>"+b.label+"</b>"},function(b){return a.yFormat(b[d])}),a.foreground.point[d].selectAll("circle").style("stroke",a.color(b.label)).style("fill","white"),a.foreground.point[d].transition().duration(a.animationDuration).attr("transform",function(b){return"translate("+a.x.customScale(b.x)+","+a.y.customScale(b[d])+")"}),a.foreground.point[d].exit().transition().duration(a.animationDuration).style("opacity",0).attr("r",0).remove()},b.xValues=function(){var b=[];return a.currentChartData.forEach(function(a){b=b.concat(a.values.map(function(a){return a.x}))}),b},b.yValues=function(){var b=[];return a.currentChartData.forEach(function(a){b=b.concat(a.values.map(function(a){return a.y})),b=b.concat(a.values.map(function(a){return a.y0}))}),b},b.data=function(c,d){return arguments.length?(d&&(a.currentChartData={}),a.currentChartData=c,b):a.currentChartData},b.update=function(c){return a.background.each(function(b){var c=d3.select(this),d=c.select("path");0==d.size()&&(d=c.append("path").call(d2b.UTILS.bindElementEvents,a,"area")),a.area.interpolate(b.interpolate?b.interpolate:"linear"),d.style("stroke",function(){return a.color(b.label)}).style("fill",function(){return a.color(b.label)}).datum(function(){return b.values}).transition().duration(a.animationDuration).attr("d",a.area)}),a.foreground.each(function(b){var c=d3.select(this);c.on("mouseover",function(){console.log(d3.event)}),a.foreground.point={},a.updatePoints(b,c,"y"),a.updatePoints(b,c,"y0")}),d3.timer.flush(),c&&c(),b},b},d2b.UTILS.AXISCHART.TYPES.histogram=function(){var a={};a.animationDuration=d2b.CONSTANTS.ANIMATIONLENGTHS().normal,a.color=d2b.CONSTANTS.DEFAULTCOLOR(),a.currentChartData={},a.xFormat=function(a){return a},a.yFormat=function(a){return a},a.on=d2b.CONSTANTS.DEFAULTEVENTS(),a.hist=d3.layout.histogram();var b={};return b.foreground=d2b.UTILS.CHARTS.MEMBERS.prop(b,a,"foreground"),b.background=d2b.UTILS.CHARTS.MEMBERS.prop(b,a,"background"),b.animationDuration=d2b.UTILS.CHARTS.MEMBERS.prop(b,a,"animationDuration"),b.x=d2b.UTILS.CHARTS.MEMBERS.prop(b,a,"x"),b.y=d2b.UTILS.CHARTS.MEMBERS.prop(b,a,"y"),b.xFormat=d2b.UTILS.CHARTS.MEMBERS.prop(b,a,"xFormat"),b.yFormat=d2b.UTILS.CHARTS.MEMBERS.prop(b,a,"yFormat"),b.width=d2b.UTILS.CHARTS.MEMBERS.prop(b,a,"width"),b.height=d2b.UTILS.CHARTS.MEMBERS.prop(b,a,"height"),b.on=d2b.UTILS.CHARTS.MEMBERS.on(b,a),b.color=d2b.UTILS.CHARTS.MEMBERS.prop(b,a,"color"),b.controls=d2b.UTILS.CHARTS.MEMBERS.prop(b,a,"controlsData"),b.axisChart=d2b.UTILS.CHARTS.MEMBERS.prop(b,a,"axisChart"),b.xValues=function(){var b=[];
return a.currentChartData.forEach(function(a){b=b.concat(a.histData.map(function(a){return a.x}))}),b},b.yValues=function(){var b=[];return a.currentChartData.forEach(function(a){b=b.concat(a.histData.map(function(a){return a.y}))}),b},b.data=function(c){return arguments.length?(a.currentChartData=c,a.currentChartData.forEach(function(b){b.histData=a.hist.bins(b.bins)(b.values)}),b):a.currentChartData},b.update=function(c){return a.background.each(function(b){var c=d3.select(this),d=b.histData.map(function(a){return a.x}),e=[a.x.customScale(d3.min(d)),a.x.customScale(d3.max(d))],f=1.03*Math.abs(e[0]-e[1])/b.histData.length;c.selectAll("rect");{var g=c.selectAll("rect").data(b.histData,function(a){return a.x});g.enter().append("rect").call(d2b.UTILS.bindElementEvents,a,"histogram-bar").style("fill",a.color(b.label)).attr("y",a.y.customScale(0)).attr("height",0).call(d2b.UTILS.tooltip,function(){return"<b>"+b.label+"</b>"},function(b){return a.yFormat(b.y)})}g.transition().duration(a.animationDuration).attr("x",function(b){return a.x.customScale(b.x)-f/2}).attr("width",function(){return Math.max(0,f)}).attr("y",function(b){return a.y.customBarScale(b.y).y}).attr("height",function(b){return a.y.customBarScale(b.y).height}),g.exit().transition().duration(a.animationDuration).attr("y",a.y.customScale(0)).attr("height",0)}),d3.timer.flush(),c&&c(),b},b},d2b.UTILS.AXISCHART.TYPES.bubblePack=function(){var a={};a.animationDuration=d2b.CONSTANTS.ANIMATIONLENGTHS().normal,a.color=d2b.CONSTANTS.DEFAULTCOLOR(),a.currentChartData={},a.packData=[],a.xFormat=function(a){return a},a.yFormat=function(a){return a},a.on=d2b.CONSTANTS.DEFAULTEVENTS(),a.pack=d3.layout.pack().size([500,500]).value(function(a){return a.size}),a.persistentData={expandedNodes:{}},a.resetExpandedNodes=function(b){a.persistentData.expandedNodes[b.key]=!1,b.children&&b.children.forEach(function(b){a.resetExpandedNodes(b)})},a.setParentPositions=function(b){b.children&&(b.x0=0,b.y0=0,b.children.forEach(function(c){a.setParentPositions(c),b.x0+=c.x0*c.value/b.value,b.y0+=c.y0*c.value/b.value}))},a.flatten=function(a){function b(a){return a.children&&(a.size=a.children.reduce(function(a,c){return a+b(c)},0)),a.id||(a.id=++d),c.push(a),a.size}var c=[],d=0;return a.size=b(a),c},a.addNodeKey=function(b){return b.key=b.name,b.parent&&(b.key+=a.addNodeKey(b.parent)),b.key},a.packJoin=function(){var b={children:a.currentChartData.map(function(a){return a.pack})};a.pack(b),b.children&&b.children.forEach(function(a){a.parent=null})},a.bubbleEnter=function(b,c,d){newBubble=d.enter().append("g").attr("class","d2b-bubble").call(d2b.UTILS.tooltip,function(a){return"<b>"+c.label+" - "+a.name+"</b>"},function(a){return a.value}).call(d2b.UTILS.bindElementEvents,a,"bubble").attr("transform",function(b){return b.parent&&!a.persistentData.expandedNodes[b.parent.key]?"translate("+a.x.customScale(b.parent.x0)+","+a.y.customScale(b.parent.y0)+")":"translate("+a.x.customScale(b.x0)+","+a.y.customScale(b.y0)+")"}).style("opacity",0),newBubble.append("circle").attr("class","d2b-bubble-background").style("stroke",a.color(c.label)),newBubble.append("circle").attr("class","d2b-bubble-foreground").style("fill",a.color(c.label))},a.bubbleUpdate=function(b,c,d){var e=d.filter(function(a){return a.children?!0:!1}).on("click.d2b-click",function(b){a.persistentData.expandedNodes[b.key]=!0,a.axisChart.update()}).style("cursor","pointer").on("mouseover.d2b-mouseover",function(b){d3.select(this).select(".d2b-bubble-background").transition().duration(a.animationDuration/2).attr("r",3+Math.max(.5,b.r))}).on("mouseout.d2b-mouseout",function(b){d3.select(this).select(".d2b-bubble-background").transition().duration(a.animationDuration/2).attr("r",Math.max(.5,b.r))});e.select(".d2b-bubble-background").style("stroke",d3.rgb(a.color(c.label)).darker(1));var f=d.filter(function(a){return a.children?!1:!0}).style("cursor","auto");f.select(".d2b-bubble-background").style("stroke",d3.rgb(a.color(c.label)));var g=d.filter(a.visible).classed("d2b-hidden",!1).transition().duration(a.animationDuration).style("opacity",.7).attr("transform",function(b){return"translate("+a.x.customScale(b.x0)+","+a.y.customScale(b.y0)+")"});g.select("circle.d2b-bubble-background").attr("r",function(a){return Math.max(.5,a.r)}),g.select("circle.d2b-bubble-foreground").attr("r",function(a){return Math.max(.5,a.r)});var h=d.filter(function(b){if(b.parent){if(a.persistentData.expandedNodes[b.parent.key]&&!a.persistentData.expandedNodes[b.key])return!1}else if(!a.persistentData.expandedNodes[b.key])return!1;return!0}).classed("d2b-hidden",!0).transition().duration(a.animationDuration).style("opacity",0).attr("transform",function(b){var c="";return c=b.parent?"translate("+a.x.customScale(b.parent.x0)+","+a.y.customScale(b.parent.y0)+")":"translate("+a.x.customScale(b.x0)+","+a.y.customScale(b.y0)+")"});h.select("circle.d2b-bubble-background").attr("r",function(a){return Math.max(1,a.r)}),h.select("circle.d2b-bubble-foreground").attr("r",function(a){return Math.max(1,a.r)})},a.bubbleExit=function(b,c,d){d.exit().transition().duration(a.animationDuration).style("opacity",0).remove()},a.visible=function(b){if(b.parent){if(a.persistentData.expandedNodes[b.parent.key]&&!a.persistentData.expandedNodes[b.key])return!0}else if(!a.persistentData.expandedNodes[b.key])return!0;return!1};var b={};return b.foreground=d2b.UTILS.CHARTS.MEMBERS.prop(b,a,"foreground"),b.background=d2b.UTILS.CHARTS.MEMBERS.prop(b,a,"background"),b.animationDuration=d2b.UTILS.CHARTS.MEMBERS.prop(b,a,"animationDuration"),b.x=d2b.UTILS.CHARTS.MEMBERS.prop(b,a,"x"),b.y=d2b.UTILS.CHARTS.MEMBERS.prop(b,a,"y"),b.xFormat=d2b.UTILS.CHARTS.MEMBERS.prop(b,a,"xFormat"),b.yFormat=d2b.UTILS.CHARTS.MEMBERS.prop(b,a,"yFormat"),b.width=d2b.UTILS.CHARTS.MEMBERS.prop(b,a,"width"),b.height=d2b.UTILS.CHARTS.MEMBERS.prop(b,a,"height"),b.on=d2b.UTILS.CHARTS.MEMBERS.on(b,a),b.color=d2b.UTILS.CHARTS.MEMBERS.prop(b,a,"color"),b.controls=d2b.UTILS.CHARTS.MEMBERS.prop(b,a,"controlsData"),b.axisChart=d2b.UTILS.CHARTS.MEMBERS.prop(b,a,"axisChart"),b.xValues=function(){var b=[];a.currentChartData.forEach(function(c){b=b.concat(c.packed.filter(a.visible).map(function(a){return a.x0}))});var c=[];return c=c.concat.apply(c,b)},b.yValues=function(){var b=[];a.currentChartData.forEach(function(c){b=b.concat(c.packed.filter(a.visible).map(function(a){return a.y0}))});var c=[];return c=c.concat.apply(c,b)},b.data=function(c){return arguments.length?(a.currentChartData=c,a.packJoin(),a.currentChartData.forEach(function(b){a.setParentPositions(b.pack),b.packed=a.flatten(b.pack),b.packed.forEach(a.addNodeKey)}),b):a.currentChartData},b.update=function(c){a.pack.size([a.width/2,a.height/2]),a.packJoin(),a.background.each(function(){d3.select(this)});var d={x:10,y:10};return a.foreground.each(function(b){var c=d3.select(this),e=c.selectAll("g.d2b-bubble").data(b.packed,function(a){return a.key});a.bubbleEnter(c,b,e),a.bubbleUpdate(c,b,e),a.bubbleExit(c,b,e);var f=c.selectAll("g.d2b-expanded-bubble-indicator").data(b.packed.filter(function(b){return a.persistentData.expandedNodes[b.key]}),function(a){return a.key}),g=f.enter().append("g").attr("class","d2b-expanded-bubble-indicator").on("click.d2b-click",function(b){a.resetExpandedNodes(b),d2b.UTILS.removeTooltip(),a.axisChart.update()}).call(d2b.UTILS.tooltip,function(a){return"<b>"+b.label+" - "+a.name+"</b>"},function(a){return a.value});g.append("rect").attr("width",50).attr("height",20).style("fill",a.color(b.label)).style("stroke",d3.rgb(a.color(b.label)).darker(1)),g.append("text").attr("x",25).attr("y",15).text(function(a){return a.name.substring(0,5)});var h=f.transition().duration(a.animationDuration);h.attr("transform",function(){return d.x+=55,d.x>a.width-20&&(d.y+=25,d.x=65),"translate("+(d.x-55)+","+d.y+")"}),f.exit().remove()}),d3.timer.flush(),c&&c(),b},b},d2b.UTILS.AXISCHART.TYPES.template=function(a){var b={};b.animationDuration=d2b.CONSTANTS.ANIMATIONLENGTHS().normal,b.color=d2b.CONSTANTS.DEFAULTCOLOR(),b.currentChartData={},b.xFormat=function(a){return a},b.yFormat=function(a){return a},b.on=d2b.CONSTANTS.DEFAULTEVENTS();var c={};return c.foreground=d2b.UTILS.CHARTS.MEMBERS.prop(c,b,"foreground"),c.background=d2b.UTILS.CHARTS.MEMBERS.prop(c,b,"background"),c.animationDuration=d2b.UTILS.CHARTS.MEMBERS.prop(c,b,"animationDuration"),c.x=d2b.UTILS.CHARTS.MEMBERS.prop(c,b,"x"),c.y=d2b.UTILS.CHARTS.MEMBERS.prop(c,b,"y"),c.xFormat=d2b.UTILS.CHARTS.MEMBERS.prop(c,b,"xFormat"),c.yFormat=d2b.UTILS.CHARTS.MEMBERS.prop(c,b,"yFormat"),c.width=d2b.UTILS.CHARTS.MEMBERS.prop(c,b,"width"),c.height=d2b.UTILS.CHARTS.MEMBERS.prop(c,b,"height"),c.on=d2b.UTILS.CHARTS.MEMBERS.on(c,b),c.color=d2b.UTILS.CHARTS.MEMBERS.prop(c,b,"color"),c.controls=d2b.UTILS.CHARTS.MEMBERS.prop(c,b,"controlsData"),c.axisChart=d2b.UTILS.CHARTS.MEMBERS.prop(c,b,"axisChart"),c.xValues=function(){if(a&&d2b.UTILS.AXISCHART.TYPES[a].xValues)return d2b.UTILS.AXISCHART.TYPES[a].xValues.call(b,c);var d=[];return d},c.yValues=function(){if(a&&d2b.UTILS.AXISCHART.TYPES[a].yValues)return d2b.UTILS.AXISCHART.TYPES[a].yValues.call(b,c);var d=[];return d},c.data=function(a){return arguments.length?(b.currentChartData=a,c):b.currentChartData},c.update=function(d){return a&&d2b.UTILS.AXISCHART.TYPES[a].update?(d2b.UTILS.AXISCHART.TYPES[a].update.call(b,c),d&&d(),c):(b.background.each(function(){d3.select(this)}),b.foreground.each(function(){d3.select(this)}),d3.timer.flush(),d&&d(),c)},c},d2b.DASHBOARDS.dashboard=function(){var a=d2b.CONSTANTS.DEFAULTWIDTH(),b=d2b.CONSTANTS.DEFAULTMARGIN(),c=210,d=a-c,e=!0,f=d3.select("body"),g=d2b.CONSTANTS.ANIMATIONLENGTHS().normal,h=(d2b.CONSTANTS.DEFAULTFORCEDMARGIN(),new d2b.UTILS.dashboardCategory),i=new d2b.UTILS.chartPage,j=new d2b.UTILS.CONTROLS.htmlControls,k={},l=!1,m=!1,n={};n.array=[],n.position=-1,n.pushNew=function(a){n.array=n.array.slice(0,n.position+1),n.position++,n.array.push({category:a.category,section:a.section})};var o={section:{},category:{}},p=!0,q={},r=d2b.CONSTANTS.DEFAULTPALETTE,s=function(a,b,c){a.forEach(function(a,d){a.categoryName=b,a.sectionName=c,a.index=d})},t=function(a,b){a&&a.forEach(function(a){a.sectionName=b,a.pages||(a.pages=[]),s(a.pages,a.name,a.sectionName)})},u=function(a,b,c){b.forEach(function(b){b.key&&(k[b.key]=b),t(b.categories,b.name),b.position=a.concat([{section:b,sectionGroup:c}]),b.sections&&u(a.concat([{section:b,sectionGroup:c}]),b.sections),b.sectionGroups&&v(a.concat([{section:b,sectionGroup:c}]),b.sectionGroups)})},v=function(a,b){b.forEach(function(b){b.sections&&u(a,b.sections,b)})},w=function(a){u([],[a.dashboard.topSection])},x=function(){f.container.header.breadcrumbs.svg.selectAll(".d2b-breadcrumb-sub-section-group-section").transition().duration(g/2).style("opacity",0),f.container.header.breadcrumbs.svg.selectAll(".d2b-breadcrumb").each(function(){this.expanded=!1}),f.container.header.breadcrumbs.svg.style("height","28px")},y=function(){var a=7,b=f.container.header.breadcrumbs.svg.selectAll("g.d2b-breadcrumb").data(o.section.position,function(a){return a.section.name}),c=b.enter().append("g").style("opacity",0).attr("class","d2b-breadcrumb");c.append("path").attr("class","d2b-breadcrumb-background"),c.append("path").attr("class","d2b-breadcrumb-foreground"),c.append("text").text(function(a){return a.section.name}).attr("y",17).attr("x",15),b.each(function(c,d){var e,h=this,i=d3.select(h),j=i.select("text"),k=i.select("path.d2b-breadcrumb-foreground"),l=i.select("path.d2b-breadcrumb-background"),m=j.node().getBBox().width+25;if(i.select("g.d2b-breadcrumb-triangle").remove(),c.section!=o.section?i.classed("d2b-innactive",!1).on("click.d2b-click",function(a){D(a.section)}):i.classed("d2b-innactive",!0).on("click.d2b-click",null),c.sectionGroup){var n=i.selectAll("g.d2b-breadcrumb-sub-section-group-section").data(c.sectionGroup.sections.filter(function(a){return a!=c.section}));h.dyExpanded=0,h.expanded=!1;var p=n.enter().append("g").style("opacity",0).attr("class","d2b-breadcrumb-sub-section-group-section");p.append("path").attr("class","d2b-breadcrumb-background"),p.append("path").attr("class","d2b-breadcrumb-foreground"),p.append("text").attr("y",17).attr("x",15).text(function(a){return a.name}),n.each(function(){var b=d3.select(this),c=b.select("path.d2b-breadcrumb-foreground"),d=b.select("path.d2b-breadcrumb-background"),e=b.select("text"),f=e.node().getBBox().width+25;c.attr("d","M 0 0 L "+a+" 12.5 L 0 25 L "+f+" 25 L "+(f+a)+" 12.5 L "+f+" 0 L 0 0 Z").attr("transform","translate(4,0)"),d.attr("d","M 0 0 L "+a+" 12.5 L 0 25 L "+f+" 25 L "+(f+a)+" 12.5 L "+f+" 0 L 0 0 Z")}).on("click.d2b-click",function(a){d3.event.stopPropagation(),D(a)}).attr("transform",function(a,b){return"translate(0,"+28*(b+1)+")"}),h.dyExpanded=32*(n.size()+5),m+=15,e=i.append("g").attr("class","d2b-breadcrumb-triangle").on("click.d2b-click",function(){d3.event.stopPropagation(),h.expanded?(n.transition().duration(g/2).style("opacity",0),f.container.header.breadcrumbs.svg.style("height","27px")):(x(),f.container.header.breadcrumbs.svg.style("height",Math.max(25,h.dyExpanded)+"px"),n.transition().duration(g/2).delay(function(a,b){return 20*b}).style("opacity",1)),h.expanded=!h.expanded}),e.append("rect").attr("width",20).attr("height",24).attr("y",.5).attr("transform","translate("+(m-20)+",0)"),e.append("path").attr("d","M 0 0 L 9 0 L 4.5 5 L 0 0 Z").attr("transform","translate("+(m-15)+",11)")}var q=a,r=a;0==d&&(q=0),d+1==b.size()&&(r=0),k.transition().duration(g).attr("transform","translate(4,0)").attr("d","M 0 0 L "+q+" 12.5 L 0 25 L "+m+" 25 L "+(m+r)+" 12.5 L "+m+" 0 L 5 0 Z"),l.transition().duration(g).attr("d","M 0 0 L "+q+" 12.5 L 0 25 L "+m+" 25 L "+(m+r)+" 12.5 L "+m+" 0 L 5 0 Z"),this.dx=m});var d=0;b.transition().duration(g).attr("transform",function(){var a="translate("+d+",1)";return d+=this.dx+7,a}).style("opacity",1),b.exit().transition().duration(g).style("opacity",0).remove()},z=function(){var a=f.container.header.navigation.categoryTabs.selectAll("li.d2b-category-tab").data(o.section.categories);a.enter().append("li").attr("class","d2b-category-tab").on("click.d2b-click",E),a.text(function(a){return a.name}).each(function(a){a==o.category?d3.select(this).classed("d2b-innactive",!0).on("click.d2b-click",null):d3.select(this).classed("d2b-innactive",!1).on("click.d2b-click",E)}),a.exit().transition().duration(g).style("opacity",0).remove()},A=function(){var a=f.container.sidebar.subSections.selectAll("li.d2b-sub-section").data(o.section.sections);a.enter().append("li").style("opacity",0).attr("class","d2b-sub-section").on("click.d2b-click",D),a.text(function(a){return a.name}).transition().duration(g).style("opacity",1),a.exit().transition().duration(g).style("opacity",0).remove()},B=function(){var a=o.section.sectionGroups.filter(function(a){return a.sections.length>0}),b=f.container.sidebar.subSectionGroups.selectAll("li.d2b-sub-section-group").data(a);b.enter().append("li").style("opacity",0).attr("class","d2b-sub-section-group"),b.transition().duration(g).style("opacity",1),b.text(function(a){return a.name}).each(C),b.exit().transition().duration(g).style("opacity",0).remove()},C=function(a){if(a.sections&&!(a.sections.length<1)){var b=d3.select(this);b.selectAll("*").remove();var c=b.append("ul").datum(a).attr("class","d2b-sub-section-group-sections"),d=c.selectAll("li.d2b-sub-section-group-section").data(function(a){return a.sections});d.enter().append("li").attr("class","d2b-sub-section-group-section"),d.on("click.d2b-click",D),d.text(function(a){return a.name})}},D=function(a){x(),o.section=a,o.section.sections||(o.section.sections=[]),o.section.sectionGroups||(o.section.sectionGroups=[]),o.section.categories||(o.section.categories=[]);var b=a.categories.filter(function(a){return a.name==o.category.name});return E(b.length>0?b[0]:a.categories[0])},E=function(a){return o.category=a,n.pushNew(o),h.animateFrom("right").data({data:o.category}),F.update()},F={};return F.select=function(a){return f=d3.select(a),e=!0,F},F.selection=function(a){return arguments.length?(f=a,e=!0,F):f},F.width=function(b){return arguments.length?(a=b,d=a-210,h.width(d),i.width(d),p=!0,F):a},F.margin=function(a){return arguments.length?(a.left&&(b.left=a.left),a.right&&(b.right=a.right),a.top&&(b.top=a.top),a.bottom&&(b.bottom=a.bottom),F):b},F.palette=function(a){return arguments.length?(r=a,F):r},F.animationDuration=function(a){return arguments.length?(g=a,h.animationDuration(g),F):g},F.data=function(a,b){return arguments.length?(b&&(e=!0,q={}),q=a,w(q),F):g},F.generate=function(a){return e=!1,f.selectAll("*").remove(),f.container=f.append("div").attr("class","d2b-dashboard d2b-container"),f.container.header=f.container.append("div").attr("class","d2b-header"),f.container.header.navigation=f.container.header.append("div").attr("class","d2b-navigation"),f.container.header.navigation.home=f.container.header.navigation.append("div").attr("class","d2b-navigation-home"),f.container.header.navigation.home.append("i").attr("class","fa fa-home"),f.container.header.navigation.arrows=f.container.header.navigation.append("div").attr("class","d2b-navigation-arrows"),f.container.header.navigation.arrows.left=f.container.header.navigation.arrows.append("div").attr("id","d2b-left-arrow"),f.container.header.navigation.arrows.right=f.container.header.navigation.arrows.append("div").attr("id","d2b-right-arrow"),f.container.header.navigation.arrows.left.append("i").attr("class","fa fa-chevron-left"),f.container.header.navigation.arrows.right.append("i").attr("class","fa fa-chevron-right"),f.container.header.navigation.categoryTabs=f.container.header.navigation.append("ul").attr("class","d2b-category-tabs"),f.container.header.navigation.logo=f.container.header.navigation.append("img").attr("class","d2b-dashboard-logo"),f.container.header.breadcrumbs=f.container.header.append("div").attr("class","d2b-dashboard-breadcrumbs"),f.container.header.breadcrumbs.svg=f.container.header.breadcrumbs.append("svg").attr("class","d2b-dashboard-breadcrumbs-svg"),f.container.sidebar=f.container.append("div").attr("class","d2b-dashboard-sidebar"),f.container.sidebar.sectionNav=f.container.sidebar.append("div").attr("class","d2b-sidebar-section-nav d2b-sidebar-container"),f.container.sidebar.sectionsHeader=f.container.sidebar.sectionNav.append("div").attr("class","d2b-sidebar-header").text("Go To"),f.container.sidebar.subSections=f.container.sidebar.sectionNav.append("ul").attr("class","d2b-sub-sections"),f.container.sidebar.subSectionGroups=f.container.sidebar.sectionNav.append("ul").attr("class","d2b-sub-section-groups"),f.container.sidebar.filters=f.container.sidebar.append("div").attr("class","d2b-sidebar-filters d2b-sidebar-container"),f.container.sidebar.filtersHeader=f.container.sidebar.filters.append("div").attr("class","d2b-sidebar-header").text("Filter By"),j.selection(f.container.sidebar.filters).on("change",function(){F.update()}),f.container.content=f.container.append("div").attr("class","d2b-dashboard-content"),f.container.content.dashboardCategory=f.container.content.append("div").attr("class","d2b-dashboard-category"),h.selection(f.container.content.dashboardCategory).on("pageChange.d2b-page-change",function(a,b,c){var d=l;a.controls||(a.controls=[]),a.controls.length>0?(l=!1,f.container.sidebar.filters.style("display","block")):(l=!0,f.container.sidebar.filters.style("display","none")),j.data(a).update(function(){});var e=null;c>b?e="right":b>c&&(e="left"),i.selection(h.chartPageSelection()).data(a).animateFrom(e).update(function(){d!=l&&F.update()}).animateFrom(null)}),D(q.dashboard.topSection),F.update(a),F},F.update=function(b){return e?F.generate(b):(o.section==q.dashboard.topSection?f.container.header.navigation.home.classed("d2b-innactive",!0).on("click.d2b-click",null):f.container.header.navigation.home.classed("d2b-innactive",!1).on("click.d2b-click",function(){D(q.dashboard.topSection)}),n.position+1==n.array.length?f.container.header.navigation.arrows.right.classed("d2b-innactive",!0).on("click.d2b-click",null):f.container.header.navigation.arrows.right.classed("d2b-innactive",!1).on("click.d2b-click",function(){n.position++,o={category:n.array[n.position].category,section:n.array[n.position].section},x(),h.animateFrom("right").data({data:o.category}),F.update()}),0==n.position?f.container.header.navigation.arrows.left.classed("d2b-innactive",!0).on("click.d2b-click",null):f.container.header.navigation.arrows.left.classed("d2b-innactive",!1).on("click.d2b-click",function(){n.position--,o={category:n.array[n.position].category,section:n.array[n.position].section},x(),h.animateFrom("left").data({data:o.category}),F.update()}),f.container.transition().delay(g).duration(g).style("width",a+"px"),z(),y(),0==o.section.sections.length&&0==o.section.sectionGroups.length?(m=!0,f.container.sidebar.sectionNav.style("display","none")):(m=!1,f.container.sidebar.sectionNav.style("display","block")),A(),B(),c=l&&m?10:210,d=a-c,f.container.content.style("width",d+"px"),f.container.content.transition().duration(g).style("margin-left",c-10+"px"),h.width(d).update().animateFrom(null),i.width(d).update(),d3.timer.flush(),b&&b(),F)},F},d3.sankey=function(){function a(){n.forEach(function(a){a.sourceLinks=[],a.targetLinks=[]}),o.forEach(function(a){var b=a.source,c=a.target;"number"==typeof b&&(b=a.source=n[a.source]),"number"==typeof c&&(c=a.target=n[a.target]),b.sourceLinks.push(a),c.targetLinks.push(a)})}function b(){n.forEach(function(a){a.value=Math.max(d3.sum(a.sourceLinks,i),d3.sum(a.targetLinks,i))})}function c(){for(var a,b=n,c=0;b.length;)a=[],b.forEach(function(b){b.x=c,b.dx=k,b.sourceLinks.forEach(function(b){a.indexOf(b.target)<0&&a.push(b.target)})}),b=a,++c;d(c),e((m[0]-k)/(c-1))}function d(a){n.forEach(function(b){b.sourceLinks.length||(b.x=a-1)})}function e(a){n.forEach(function(b){b.x*=a})}function f(a){function b(){var a=d3.min(g,function(a){return(m[1]-(a.length-1)*l)/d3.sum(a,i)});g.forEach(function(b){b.forEach(function(b,c){b.y=c,b.dy=b.value*a})}),o.forEach(function(b){b.dy=b.value*a})}function c(a){function b(a){return h(a.source)*a.value}g.forEach(function(c){c.forEach(function(c){if(c.targetLinks.length){var d=d3.sum(c.targetLinks,b)/d3.sum(c.targetLinks,i);c.y+=(d-h(c))*a}})})}function d(a){function b(a){return h(a.target)*a.value}g.slice().reverse().forEach(function(c){c.forEach(function(c){if(c.sourceLinks.length){var d=d3.sum(c.sourceLinks,b)/d3.sum(c.sourceLinks,i);c.y+=(d-h(c))*a}})})}function e(){g.forEach(function(a){var b,c,d,e=0,g=a.length;for(a.sort(f),d=0;g>d;++d)b=a[d],c=e-b.y,c>0&&(b.y+=c),e=b.y+b.dy+l;if(c=e-l-m[1],c>0)for(e=b.y-=c,d=g-2;d>=0;--d)b=a[d],c=b.y+b.dy+l-e,c>0&&(b.y-=c),e=b.y})}function f(a,b){return a.y-b.y}var g=d3.nest().key(function(a){return a.x}).sortKeys(d3.ascending).entries(n).map(function(a){return a.values});b(),e();for(var j=1;a>0;--a)d(j*=.99),e(),c(j),e()}function g(){function a(a,b){return a.source.y-b.source.y}function b(a,b){return a.target.y-b.target.y}n.forEach(function(c){c.sourceLinks.sort(b),c.targetLinks.sort(a)}),n.forEach(function(a){var b=0,c=0;a.sourceLinks.forEach(function(a){a.sy=b,b+=a.dy}),a.targetLinks.forEach(function(a){a.ty=c,c+=a.dy})})}function h(a){return a.y+a.dy/2}function i(a){return a.value}var j={},k=24,l=8,m=[1,1],n=[],o=[];return j.nodeWidth=function(a){return arguments.length?(k=+a,j):k},j.nodePadding=function(a){return arguments.length?(l=+a,j):l},j.nodes=function(a){return arguments.length?(n=a,j):n},j.links=function(a){return arguments.length?(o=a,j):o},j.size=function(a){return arguments.length?(m=a,j):m},j.layout=function(d){return a(),b(),c(),f(d),g(),j},j.relayout=function(){return g(),j},j.link=function(){function a(a){var c=a.source.x+a.source.dx,d=a.target.x,e=d3.interpolateNumber(c,d),f=e(b),g=e(1-b),h=a.source.y+a.sy+a.dy/2,i=a.target.y+a.ty+a.dy/2;return"M"+c+","+h+"C"+f+","+h+" "+g+","+i+" "+d+","+i}var b=.5;return a.curvature=function(c){return arguments.length?(b=+c,a):b},a},j};var colorbrewer={YlGn:{3:["#f7fcb9","#addd8e","#31a354"],4:["#ffffcc","#c2e699","#78c679","#238443"],5:["#ffffcc","#c2e699","#78c679","#31a354","#006837"],6:["#ffffcc","#d9f0a3","#addd8e","#78c679","#31a354","#006837"],7:["#ffffcc","#d9f0a3","#addd8e","#78c679","#41ab5d","#238443","#005a32"],8:["#ffffe5","#f7fcb9","#d9f0a3","#addd8e","#78c679","#41ab5d","#238443","#005a32"],9:["#ffffe5","#f7fcb9","#d9f0a3","#addd8e","#78c679","#41ab5d","#238443","#006837","#004529"]},YlGnBu:{3:["#edf8b1","#7fcdbb","#2c7fb8"],4:["#ffffcc","#a1dab4","#41b6c4","#225ea8"],5:["#ffffcc","#a1dab4","#41b6c4","#2c7fb8","#253494"],6:["#ffffcc","#c7e9b4","#7fcdbb","#41b6c4","#2c7fb8","#253494"],7:["#ffffcc","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#0c2c84"],8:["#ffffd9","#edf8b1","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#0c2c84"],9:["#ffffd9","#edf8b1","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#253494","#081d58"]},GnBu:{3:["#e0f3db","#a8ddb5","#43a2ca"],4:["#f0f9e8","#bae4bc","#7bccc4","#2b8cbe"],5:["#f0f9e8","#bae4bc","#7bccc4","#43a2ca","#0868ac"],6:["#f0f9e8","#ccebc5","#a8ddb5","#7bccc4","#43a2ca","#0868ac"],7:["#f0f9e8","#ccebc5","#a8ddb5","#7bccc4","#4eb3d3","#2b8cbe","#08589e"],8:["#f7fcf0","#e0f3db","#ccebc5","#a8ddb5","#7bccc4","#4eb3d3","#2b8cbe","#08589e"],9:["#f7fcf0","#e0f3db","#ccebc5","#a8ddb5","#7bccc4","#4eb3d3","#2b8cbe","#0868ac","#084081"]},BuGn:{3:["#e5f5f9","#99d8c9","#2ca25f"],4:["#edf8fb","#b2e2e2","#66c2a4","#238b45"],5:["#edf8fb","#b2e2e2","#66c2a4","#2ca25f","#006d2c"],6:["#edf8fb","#ccece6","#99d8c9","#66c2a4","#2ca25f","#006d2c"],7:["#edf8fb","#ccece6","#99d8c9","#66c2a4","#41ae76","#238b45","#005824"],8:["#f7fcfd","#e5f5f9","#ccece6","#99d8c9","#66c2a4","#41ae76","#238b45","#005824"],9:["#f7fcfd","#e5f5f9","#ccece6","#99d8c9","#66c2a4","#41ae76","#238b45","#006d2c","#00441b"]},PuBuGn:{3:["#ece2f0","#a6bddb","#1c9099"],4:["#f6eff7","#bdc9e1","#67a9cf","#02818a"],5:["#f6eff7","#bdc9e1","#67a9cf","#1c9099","#016c59"],6:["#f6eff7","#d0d1e6","#a6bddb","#67a9cf","#1c9099","#016c59"],7:["#f6eff7","#d0d1e6","#a6bddb","#67a9cf","#3690c0","#02818a","#016450"],8:["#fff7fb","#ece2f0","#d0d1e6","#a6bddb","#67a9cf","#3690c0","#02818a","#016450"],9:["#fff7fb","#ece2f0","#d0d1e6","#a6bddb","#67a9cf","#3690c0","#02818a","#016c59","#014636"]},PuBu:{3:["#ece7f2","#a6bddb","#2b8cbe"],4:["#f1eef6","#bdc9e1","#74a9cf","#0570b0"],5:["#f1eef6","#bdc9e1","#74a9cf","#2b8cbe","#045a8d"],6:["#f1eef6","#d0d1e6","#a6bddb","#74a9cf","#2b8cbe","#045a8d"],7:["#f1eef6","#d0d1e6","#a6bddb","#74a9cf","#3690c0","#0570b0","#034e7b"],8:["#fff7fb","#ece7f2","#d0d1e6","#a6bddb","#74a9cf","#3690c0","#0570b0","#034e7b"],9:["#fff7fb","#ece7f2","#d0d1e6","#a6bddb","#74a9cf","#3690c0","#0570b0","#045a8d","#023858"]},BuPu:{3:["#e0ecf4","#9ebcda","#8856a7"],4:["#edf8fb","#b3cde3","#8c96c6","#88419d"],5:["#edf8fb","#b3cde3","#8c96c6","#8856a7","#810f7c"],6:["#edf8fb","#bfd3e6","#9ebcda","#8c96c6","#8856a7","#810f7c"],7:["#edf8fb","#bfd3e6","#9ebcda","#8c96c6","#8c6bb1","#88419d","#6e016b"],8:["#f7fcfd","#e0ecf4","#bfd3e6","#9ebcda","#8c96c6","#8c6bb1","#88419d","#6e016b"],9:["#f7fcfd","#e0ecf4","#bfd3e6","#9ebcda","#8c96c6","#8c6bb1","#88419d","#810f7c","#4d004b"]},RdPu:{3:["#fde0dd","#fa9fb5","#c51b8a"],4:["#feebe2","#fbb4b9","#f768a1","#ae017e"],5:["#feebe2","#fbb4b9","#f768a1","#c51b8a","#7a0177"],6:["#feebe2","#fcc5c0","#fa9fb5","#f768a1","#c51b8a","#7a0177"],7:["#feebe2","#fcc5c0","#fa9fb5","#f768a1","#dd3497","#ae017e","#7a0177"],8:["#fff7f3","#fde0dd","#fcc5c0","#fa9fb5","#f768a1","#dd3497","#ae017e","#7a0177"],9:["#fff7f3","#fde0dd","#fcc5c0","#fa9fb5","#f768a1","#dd3497","#ae017e","#7a0177","#49006a"]},PuRd:{3:["#e7e1ef","#c994c7","#dd1c77"],4:["#f1eef6","#d7b5d8","#df65b0","#ce1256"],5:["#f1eef6","#d7b5d8","#df65b0","#dd1c77","#980043"],6:["#f1eef6","#d4b9da","#c994c7","#df65b0","#dd1c77","#980043"],7:["#f1eef6","#d4b9da","#c994c7","#df65b0","#e7298a","#ce1256","#91003f"],8:["#f7f4f9","#e7e1ef","#d4b9da","#c994c7","#df65b0","#e7298a","#ce1256","#91003f"],9:["#f7f4f9","#e7e1ef","#d4b9da","#c994c7","#df65b0","#e7298a","#ce1256","#980043","#67001f"]},OrRd:{3:["#fee8c8","#fdbb84","#e34a33"],4:["#fef0d9","#fdcc8a","#fc8d59","#d7301f"],5:["#fef0d9","#fdcc8a","#fc8d59","#e34a33","#b30000"],6:["#fef0d9","#fdd49e","#fdbb84","#fc8d59","#e34a33","#b30000"],7:["#fef0d9","#fdd49e","#fdbb84","#fc8d59","#ef6548","#d7301f","#990000"],8:["#fff7ec","#fee8c8","#fdd49e","#fdbb84","#fc8d59","#ef6548","#d7301f","#990000"],9:["#fff7ec","#fee8c8","#fdd49e","#fdbb84","#fc8d59","#ef6548","#d7301f","#b30000","#7f0000"]},YlOrRd:{3:["#ffeda0","#feb24c","#f03b20"],4:["#ffffb2","#fecc5c","#fd8d3c","#e31a1c"],5:["#ffffb2","#fecc5c","#fd8d3c","#f03b20","#bd0026"],6:["#ffffb2","#fed976","#feb24c","#fd8d3c","#f03b20","#bd0026"],7:["#ffffb2","#fed976","#feb24c","#fd8d3c","#fc4e2a","#e31a1c","#b10026"],8:["#ffffcc","#ffeda0","#fed976","#feb24c","#fd8d3c","#fc4e2a","#e31a1c","#b10026"],9:["#ffffcc","#ffeda0","#fed976","#feb24c","#fd8d3c","#fc4e2a","#e31a1c","#bd0026","#800026"]},YlOrBr:{3:["#fff7bc","#fec44f","#d95f0e"],4:["#ffffd4","#fed98e","#fe9929","#cc4c02"],5:["#ffffd4","#fed98e","#fe9929","#d95f0e","#993404"],6:["#ffffd4","#fee391","#fec44f","#fe9929","#d95f0e","#993404"],7:["#ffffd4","#fee391","#fec44f","#fe9929","#ec7014","#cc4c02","#8c2d04"],8:["#ffffe5","#fff7bc","#fee391","#fec44f","#fe9929","#ec7014","#cc4c02","#8c2d04"],9:["#ffffe5","#fff7bc","#fee391","#fec44f","#fe9929","#ec7014","#cc4c02","#993404","#662506"]},Purples:{3:["#efedf5","#bcbddc","#756bb1"],4:["#f2f0f7","#cbc9e2","#9e9ac8","#6a51a3"],5:["#f2f0f7","#cbc9e2","#9e9ac8","#756bb1","#54278f"],6:["#f2f0f7","#dadaeb","#bcbddc","#9e9ac8","#756bb1","#54278f"],7:["#f2f0f7","#dadaeb","#bcbddc","#9e9ac8","#807dba","#6a51a3","#4a1486"],8:["#fcfbfd","#efedf5","#dadaeb","#bcbddc","#9e9ac8","#807dba","#6a51a3","#4a1486"],9:["#fcfbfd","#efedf5","#dadaeb","#bcbddc","#9e9ac8","#807dba","#6a51a3","#54278f","#3f007d"]},Blues:{3:["#deebf7","#9ecae1","#3182bd"],4:["#eff3ff","#bdd7e7","#6baed6","#2171b5"],5:["#eff3ff","#bdd7e7","#6baed6","#3182bd","#08519c"],6:["#eff3ff","#c6dbef","#9ecae1","#6baed6","#3182bd","#08519c"],7:["#eff3ff","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#084594"],8:["#f7fbff","#deebf7","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#084594"],9:["#f7fbff","#deebf7","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#08519c","#08306b"]},Greens:{3:["#e5f5e0","#a1d99b","#31a354"],4:["#edf8e9","#bae4b3","#74c476","#238b45"],5:["#edf8e9","#bae4b3","#74c476","#31a354","#006d2c"],6:["#edf8e9","#c7e9c0","#a1d99b","#74c476","#31a354","#006d2c"],7:["#edf8e9","#c7e9c0","#a1d99b","#74c476","#41ab5d","#238b45","#005a32"],8:["#f7fcf5","#e5f5e0","#c7e9c0","#a1d99b","#74c476","#41ab5d","#238b45","#005a32"],9:["#f7fcf5","#e5f5e0","#c7e9c0","#a1d99b","#74c476","#41ab5d","#238b45","#006d2c","#00441b"]},Oranges:{3:["#fee6ce","#fdae6b","#e6550d"],4:["#feedde","#fdbe85","#fd8d3c","#d94701"],5:["#feedde","#fdbe85","#fd8d3c","#e6550d","#a63603"],6:["#feedde","#fdd0a2","#fdae6b","#fd8d3c","#e6550d","#a63603"],7:["#feedde","#fdd0a2","#fdae6b","#fd8d3c","#f16913","#d94801","#8c2d04"],8:["#fff5eb","#fee6ce","#fdd0a2","#fdae6b","#fd8d3c","#f16913","#d94801","#8c2d04"],9:["#fff5eb","#fee6ce","#fdd0a2","#fdae6b","#fd8d3c","#f16913","#d94801","#a63603","#7f2704"]},Reds:{3:["#fee0d2","#fc9272","#de2d26"],4:["#fee5d9","#fcae91","#fb6a4a","#cb181d"],5:["#fee5d9","#fcae91","#fb6a4a","#de2d26","#a50f15"],6:["#fee5d9","#fcbba1","#fc9272","#fb6a4a","#de2d26","#a50f15"],7:["#fee5d9","#fcbba1","#fc9272","#fb6a4a","#ef3b2c","#cb181d","#99000d"],8:["#fff5f0","#fee0d2","#fcbba1","#fc9272","#fb6a4a","#ef3b2c","#cb181d","#99000d"],9:["#fff5f0","#fee0d2","#fcbba1","#fc9272","#fb6a4a","#ef3b2c","#cb181d","#a50f15","#67000d"]},Greys:{3:["#f0f0f0","#bdbdbd","#636363"],4:["#f7f7f7","#cccccc","#969696","#525252"],5:["#f7f7f7","#cccccc","#969696","#636363","#252525"],6:["#f7f7f7","#d9d9d9","#bdbdbd","#969696","#636363","#252525"],7:["#f7f7f7","#d9d9d9","#bdbdbd","#969696","#737373","#525252","#252525"],8:["#ffffff","#f0f0f0","#d9d9d9","#bdbdbd","#969696","#737373","#525252","#252525"],9:["#ffffff","#f0f0f0","#d9d9d9","#bdbdbd","#969696","#737373","#525252","#252525","#000000"]},PuOr:{3:["#f1a340","#f7f7f7","#998ec3"],4:["#e66101","#fdb863","#b2abd2","#5e3c99"],5:["#e66101","#fdb863","#f7f7f7","#b2abd2","#5e3c99"],6:["#b35806","#f1a340","#fee0b6","#d8daeb","#998ec3","#542788"],7:["#b35806","#f1a340","#fee0b6","#f7f7f7","#d8daeb","#998ec3","#542788"],8:["#b35806","#e08214","#fdb863","#fee0b6","#d8daeb","#b2abd2","#8073ac","#542788"],9:["#b35806","#e08214","#fdb863","#fee0b6","#f7f7f7","#d8daeb","#b2abd2","#8073ac","#542788"],10:["#7f3b08","#b35806","#e08214","#fdb863","#fee0b6","#d8daeb","#b2abd2","#8073ac","#542788","#2d004b"],11:["#7f3b08","#b35806","#e08214","#fdb863","#fee0b6","#f7f7f7","#d8daeb","#b2abd2","#8073ac","#542788","#2d004b"]},BrBG:{3:["#d8b365","#f5f5f5","#5ab4ac"],4:["#a6611a","#dfc27d","#80cdc1","#018571"],5:["#a6611a","#dfc27d","#f5f5f5","#80cdc1","#018571"],6:["#8c510a","#d8b365","#f6e8c3","#c7eae5","#5ab4ac","#01665e"],7:["#8c510a","#d8b365","#f6e8c3","#f5f5f5","#c7eae5","#5ab4ac","#01665e"],8:["#8c510a","#bf812d","#dfc27d","#f6e8c3","#c7eae5","#80cdc1","#35978f","#01665e"],9:["#8c510a","#bf812d","#dfc27d","#f6e8c3","#f5f5f5","#c7eae5","#80cdc1","#35978f","#01665e"],10:["#543005","#8c510a","#bf812d","#dfc27d","#f6e8c3","#c7eae5","#80cdc1","#35978f","#01665e","#003c30"],11:["#543005","#8c510a","#bf812d","#dfc27d","#f6e8c3","#f5f5f5","#c7eae5","#80cdc1","#35978f","#01665e","#003c30"]},PRGn:{3:["#af8dc3","#f7f7f7","#7fbf7b"],4:["#7b3294","#c2a5cf","#a6dba0","#008837"],5:["#7b3294","#c2a5cf","#f7f7f7","#a6dba0","#008837"],6:["#762a83","#af8dc3","#e7d4e8","#d9f0d3","#7fbf7b","#1b7837"],7:["#762a83","#af8dc3","#e7d4e8","#f7f7f7","#d9f0d3","#7fbf7b","#1b7837"],8:["#762a83","#9970ab","#c2a5cf","#e7d4e8","#d9f0d3","#a6dba0","#5aae61","#1b7837"],9:["#762a83","#9970ab","#c2a5cf","#e7d4e8","#f7f7f7","#d9f0d3","#a6dba0","#5aae61","#1b7837"],10:["#40004b","#762a83","#9970ab","#c2a5cf","#e7d4e8","#d9f0d3","#a6dba0","#5aae61","#1b7837","#00441b"],11:["#40004b","#762a83","#9970ab","#c2a5cf","#e7d4e8","#f7f7f7","#d9f0d3","#a6dba0","#5aae61","#1b7837","#00441b"]},PiYG:{3:["#e9a3c9","#f7f7f7","#a1d76a"],4:["#d01c8b","#f1b6da","#b8e186","#4dac26"],5:["#d01c8b","#f1b6da","#f7f7f7","#b8e186","#4dac26"],6:["#c51b7d","#e9a3c9","#fde0ef","#e6f5d0","#a1d76a","#4d9221"],7:["#c51b7d","#e9a3c9","#fde0ef","#f7f7f7","#e6f5d0","#a1d76a","#4d9221"],8:["#c51b7d","#de77ae","#f1b6da","#fde0ef","#e6f5d0","#b8e186","#7fbc41","#4d9221"],9:["#c51b7d","#de77ae","#f1b6da","#fde0ef","#f7f7f7","#e6f5d0","#b8e186","#7fbc41","#4d9221"],10:["#8e0152","#c51b7d","#de77ae","#f1b6da","#fde0ef","#e6f5d0","#b8e186","#7fbc41","#4d9221","#276419"],11:["#8e0152","#c51b7d","#de77ae","#f1b6da","#fde0ef","#f7f7f7","#e6f5d0","#b8e186","#7fbc41","#4d9221","#276419"]},RdBu:{3:["#ef8a62","#f7f7f7","#67a9cf"],4:["#ca0020","#f4a582","#92c5de","#0571b0"],5:["#ca0020","#f4a582","#f7f7f7","#92c5de","#0571b0"],6:["#b2182b","#ef8a62","#fddbc7","#d1e5f0","#67a9cf","#2166ac"],7:["#b2182b","#ef8a62","#fddbc7","#f7f7f7","#d1e5f0","#67a9cf","#2166ac"],8:["#b2182b","#d6604d","#f4a582","#fddbc7","#d1e5f0","#92c5de","#4393c3","#2166ac"],9:["#b2182b","#d6604d","#f4a582","#fddbc7","#f7f7f7","#d1e5f0","#92c5de","#4393c3","#2166ac"],10:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#d1e5f0","#92c5de","#4393c3","#2166ac","#053061"],11:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#f7f7f7","#d1e5f0","#92c5de","#4393c3","#2166ac","#053061"]},RdGy:{3:["#ef8a62","#ffffff","#999999"],4:["#ca0020","#f4a582","#bababa","#404040"],5:["#ca0020","#f4a582","#ffffff","#bababa","#404040"],6:["#b2182b","#ef8a62","#fddbc7","#e0e0e0","#999999","#4d4d4d"],7:["#b2182b","#ef8a62","#fddbc7","#ffffff","#e0e0e0","#999999","#4d4d4d"],8:["#b2182b","#d6604d","#f4a582","#fddbc7","#e0e0e0","#bababa","#878787","#4d4d4d"],9:["#b2182b","#d6604d","#f4a582","#fddbc7","#ffffff","#e0e0e0","#bababa","#878787","#4d4d4d"],10:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#e0e0e0","#bababa","#878787","#4d4d4d","#1a1a1a"],11:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#ffffff","#e0e0e0","#bababa","#878787","#4d4d4d","#1a1a1a"]},RdYlBu:{3:["#fc8d59","#ffffbf","#91bfdb"],4:["#d7191c","#fdae61","#abd9e9","#2c7bb6"],5:["#d7191c","#fdae61","#ffffbf","#abd9e9","#2c7bb6"],6:["#d73027","#fc8d59","#fee090","#e0f3f8","#91bfdb","#4575b4"],7:["#d73027","#fc8d59","#fee090","#ffffbf","#e0f3f8","#91bfdb","#4575b4"],8:["#d73027","#f46d43","#fdae61","#fee090","#e0f3f8","#abd9e9","#74add1","#4575b4"],9:["#d73027","#f46d43","#fdae61","#fee090","#ffffbf","#e0f3f8","#abd9e9","#74add1","#4575b4"],10:["#a50026","#d73027","#f46d43","#fdae61","#fee090","#e0f3f8","#abd9e9","#74add1","#4575b4","#313695"],11:["#a50026","#d73027","#f46d43","#fdae61","#fee090","#ffffbf","#e0f3f8","#abd9e9","#74add1","#4575b4","#313695"]},Spectral:{3:["#fc8d59","#ffffbf","#99d594"],4:["#d7191c","#fdae61","#abdda4","#2b83ba"],5:["#d7191c","#fdae61","#ffffbf","#abdda4","#2b83ba"],6:["#d53e4f","#fc8d59","#fee08b","#e6f598","#99d594","#3288bd"],7:["#d53e4f","#fc8d59","#fee08b","#ffffbf","#e6f598","#99d594","#3288bd"],8:["#d53e4f","#f46d43","#fdae61","#fee08b","#e6f598","#abdda4","#66c2a5","#3288bd"],9:["#d53e4f","#f46d43","#fdae61","#fee08b","#ffffbf","#e6f598","#abdda4","#66c2a5","#3288bd"],10:["#9e0142","#d53e4f","#f46d43","#fdae61","#fee08b","#e6f598","#abdda4","#66c2a5","#3288bd","#5e4fa2"],11:["#9e0142","#d53e4f","#f46d43","#fdae61","#fee08b","#ffffbf","#e6f598","#abdda4","#66c2a5","#3288bd","#5e4fa2"]},RdYlGn:{3:["#fc8d59","#ffffbf","#91cf60"],4:["#d7191c","#fdae61","#a6d96a","#1a9641"],5:["#d7191c","#fdae61","#ffffbf","#a6d96a","#1a9641"],6:["#d73027","#fc8d59","#fee08b","#d9ef8b","#91cf60","#1a9850"],7:["#d73027","#fc8d59","#fee08b","#ffffbf","#d9ef8b","#91cf60","#1a9850"],8:["#d73027","#f46d43","#fdae61","#fee08b","#d9ef8b","#a6d96a","#66bd63","#1a9850"],9:["#d73027","#f46d43","#fdae61","#fee08b","#ffffbf","#d9ef8b","#a6d96a","#66bd63","#1a9850"],10:["#a50026","#d73027","#f46d43","#fdae61","#fee08b","#d9ef8b","#a6d96a","#66bd63","#1a9850","#006837"],11:["#a50026","#d73027","#f46d43","#fdae61","#fee08b","#ffffbf","#d9ef8b","#a6d96a","#66bd63","#1a9850","#006837"]},RdGn:{7:["#e71007","#c71007","#a71007","#871007","#888","#1a8850","#1aa850","#1ac850","#1ae850"]},Accent:{3:["#7fc97f","#beaed4","#fdc086"],4:["#7fc97f","#beaed4","#fdc086","#ffff99"],5:["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0"],6:["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0","#f0027f"],7:["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0","#f0027f","#bf5b17"],8:["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0","#f0027f","#bf5b17","#666666"]},Dark2:{3:["#1b9e77","#d95f02","#7570b3"],4:["#1b9e77","#d95f02","#7570b3","#e7298a"],5:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e"],6:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e","#e6ab02"],7:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e","#e6ab02","#a6761d"],8:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e","#e6ab02","#a6761d","#666666"]},Paired:{3:["#a6cee3","#1f78b4","#b2df8a"],4:["#a6cee3","#1f78b4","#b2df8a","#33a02c"],5:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99"],6:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c"],7:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f"],8:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00"],9:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6"],10:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a"],11:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a","#ffff99"],12:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a","#ffff99","#b15928"]},Pastel1:{3:["#fbb4ae","#b3cde3","#ccebc5"],4:["#fbb4ae","#b3cde3","#ccebc5","#decbe4"],5:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6"],6:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc"],7:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc","#e5d8bd"],8:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc","#e5d8bd","#fddaec"],9:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc","#e5d8bd","#fddaec","#f2f2f2"]},Pastel2:{3:["#b3e2cd","#fdcdac","#cbd5e8"],4:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4"],5:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9"],6:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9","#fff2ae"],7:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9","#fff2ae","#f1e2cc"],8:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9","#fff2ae","#f1e2cc","#cccccc"]},Set1:{3:["#e41a1c","#377eb8","#4daf4a"],4:["#e41a1c","#377eb8","#4daf4a","#984ea3"],5:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00"],6:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33"],7:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628"],8:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628","#f781bf"],9:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628","#f781bf","#999999"]},Set2:{3:["#66c2a5","#fc8d62","#8da0cb"],4:["#66c2a5","#fc8d62","#8da0cb","#e78ac3"],5:["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854"],6:["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f"],7:["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f","#e5c494"],8:["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f","#e5c494","#b3b3b3"]},Set3:{3:["#8dd3c7","#ffffb3","#bebada"],4:["#8dd3c7","#ffffb3","#bebada","#fb8072"],5:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3"],6:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462"],7:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69"],8:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5"],9:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9"],10:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9","#bc80bd"],11:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9","#bc80bd","#ccebc5"],12:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9","#bc80bd","#ccebc5","#ffed6f"]}};
