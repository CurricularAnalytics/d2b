<!DOCTYPE html>
<html>
<script src="https://d3js.org/d3.v4.0.0-alpha.29.min.js"></script>

<link rel="stylesheet" type="text/css" href="../../build/d2b.css" />
<script src="../../build/d2b.js"></script>

<body>

<svg></svg>

<script>
  var width = 960, height = 500;

	var pie = d2b.svgPie();

  pie.arc().innerRadius(22).outerRadius(30);

  var layout = d3.pie()
    .value(function (d) { return d.value; })
    .sort(null);

  var arcData = function () {
    var count = Math.round(Math.random() * 5) + 5;
    var data = [];
    for (var i = 0; i < count; i++) data.push({label: 'arc '+i, value: Math.random()});
    return data;
  }

  var pieData = function () {
    var count = Math.round(Math.random() * 9) + 1;
    var data = [];
    for (var i = 0; i < count; i++) data.push(layout(arcData()));
    return data;
  };

  var svg = d3.select('svg')
      .attr('width', width)
      .attr('height', height);

  var update = function () {
    var pieSVG = svg.selectAll('.pie').data(pieData());

    pieSVG.exit().transition().style('opacity', 0).remove();

    pieSVG
        .merge(pieSVG.enter().append('g').attr('class', 'pie').style('opacity', 0))
        .attr('transform', function (d, i) {return 'translate('+(i+1) * 70+', '+70+')'})
      .transition()
        .style('opacity', 1)
        .call(pie);
  }

  update();
  setInterval(update, 2000);

</script>

</body>
</html>
