<!DOCTYPE html>
<html>
<script src="https://d3js.org/d3.v4.0.0-alpha.29.min.js"></script>

<link rel="stylesheet" type="text/css" href="../../../build/d2b.css" />
<script src="../../../build/d2b.js"></script>

<body>

<svg></svg>

<script>
  var width = 960, height = 500;

  var x = d3.scaleLinear().domain([0, 7]).range([0, 960]);
  var y = d3.scaleLinear().domain([130, -60]).range([0, 500]);
  var xAxis = d3.axisBottom().scale(x);
  var yAxis = d3.axisRight().scale(y);

	var bar = d2b.svgBar()
    .x(x)
    .y(y)
    // .x(y)
    // .y(x)
    // .px(d => d.y)
    // .py(d => d.x)
    // .orient('horizontal')
    .pkey(d => d.x)
    // .stack(d3.stack().order(d3.stackOrderDescending))
    .padding(0.25)
    // .offset(x.rangeBand()/2)
    // .bandwidth(x.rangeBand())
    .stackBy(d => d.stack);

  var dataOne = [
    {
      label: 'bar 1',
      stack: 1,
      values: [
        {x: 1, y: 23},
        {x: 2, y: -31},
        {x: 3, y: 66},
        {x: 4, y: 8}
      ]
    },
    {
      label: 'bar 2',
      stack: 1,
      values: [
        {x: 1, y: 53},
        {x: 2, y: 21},
        {x: 3, y: 60},
        {x: 4, y: 56},
        {x: 5, y: 86},
        {x: 6, y: 14}
      ]
    },
    {
      label: 'bar 3',
      stack: 2,
      values: [
        {x: 1, y: 53},
        {x: 2, y: -21},
        {x: 3, y: 60},
        {x: 4, y: 56},
        {x: 5, y: 86},
        {x: 6, y: 14}
      ]
    }
  ];

  var dataTwo = [
    {
      label: 'bar 1',
      values: [
        {x: 1, y: 25},
        {x: 2, y: 38},
        {x: 3, y: 24},
        {x: 4, y: 60},
        {x: 5, y: 22}
      ]
    },
    {
      label: 'bar 2',
      values: [
        {x: 3, y: 45},
        {x: 5, y: 31},
      ]
    }
  ];

	var svg = d3.select('svg')
      .attr('width', width)
      .attr('height', height)
    .append('g');

  var barSvg = svg.append('g').attr('class', 'bar');
  svg.append('g').call(xAxis);
  svg.append('g').call(yAxis);

  update(dataOne)

  function update (data) {
    barSvg.datum(data).transition().call(bar);
  }

  setTimeout( function () { update(dataTwo) }, 2000);

</script>

</body>
</html>
